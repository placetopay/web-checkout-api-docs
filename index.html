
<!doctype html>
<html>
  <head>
    <link href="images/favicon.ico" rel="icon" type="image/ico" />
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;csharp&quot;,&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="csharp">csharp</a>
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#webcheckout" class="toc-h1 toc-link" data-title="WebCheckOut">WebCheckOut</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#flujo-de-integracion" class="toc-h2 toc-link" data-title="Flujo de integración">Flujo de integración</a>
                   

                  </li>
                  <li>
                    <a href="#librerias" class="toc-h2 toc-link" data-title="Librerías">Librerías</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#instalacion-para-c-sharp" class="toc-h3 toc-link" data-title="Instalación para C Sharp">Instalación para C Sharp</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#donde-obtener-la-libreria" class="toc-h4 toc-link" data-title="¿Dónde obtener la librería?">¿Dónde obtener la librería?</a>
                                      </li>
                                      <li>
                                        <a href="#que-versiones-soporta" class="toc-h4 toc-link" data-title="¿Qué versiones soporta?">¿Qué versiones soporta?</a>
                                      </li>
                                      <li>
                                        <a href="#que-datos-debo-tener-antes-de-iniciar-la-instalacion" class="toc-h4 toc-link" data-title="¿Qué datos debo tener antes de iniciar la instalación?">¿Qué datos debo tener antes de iniciar la instalación?</a>
                                      </li>
                                      <li>
                                        <a href="#agregar-dependencia-en-visual-studio" class="toc-h4 toc-link" data-title="Agregar dependencia en Visual Studio">Agregar dependencia en Visual Studio</a>
                                      </li>
                                      <li>
                                        <a href="#como-usar-la-clase" class="toc-h4 toc-link" data-title="¿Cómo usar la clase?">¿Cómo usar la clase?</a>
                                      </li>
                                      <li>
                                        <a href="#crear-una-nueva-sesion-de-pago-createrequest" class="toc-h4 toc-link" data-title="Crear una nueva sesión de pago <code>CreateRequest</code>">Crear una nueva sesión de pago <code>CreateRequest</code></a>
                                      </li>
                                      <li>
                                        <a href="#obtenga-informacion-sobre-una-sesion-getrequestinformation" class="toc-h4 toc-link" data-title="Obtenga información sobre una sesión <code>(getRequestInformation)</code>">Obtenga información sobre una sesión <code>(getRequestInformation)</code></a>
                                      </li>
                                      <li>
                                        <a href="#cobro-sin-intervencion-del-usuario-collect" class="toc-h4 toc-link" data-title="Cobro sin intervención del usuario (Collect)">Cobro sin intervención del usuario (Collect)</a>
                                      </li>
                                      <li>
                                        <a href="#revertir-un-pago-reversepayment" class="toc-h4 toc-link" data-title="Revertir un pago <code>(reversePayment)</code>">Revertir un pago <code>(reversePayment)</code></a>
                                      </li>
                                      <li>
                                        <a href="#leer-respuesta-enviada-a-la-url-de-notificacion-readnotification" class="toc-h4 toc-link" data-title="Leer respuesta enviada a la url de notificación <code>(ReadNotification)</code>">Leer respuesta enviada a la url de notificación <code>(ReadNotification)</code></a>
                                      </li>
                                      <li>
                                        <a href="#posibles-errores" class="toc-h4 toc-link" data-title="Posibles errores">Posibles errores</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#instalacion-librerias-para-java" class="toc-h3 toc-link" data-title="Instalación librerÍas para JAVA">Instalación librerÍas para JAVA</a>

                                


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#autenticacion" class="toc-h2 toc-link" data-title="Autenticación">Autenticación</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#ejemplos-de-autenticacion" class="toc-h3 toc-link" data-title="Ejemplos de autenticación">Ejemplos de autenticación</a>

                                


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#errores" class="toc-h2 toc-link" data-title="Errores">Errores</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#errores-frecuentes" class="toc-h3 toc-link" data-title="Errores frecuentes">Errores frecuentes</a>

                                


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#metodos-de-interfaz-de-web-checkout" class="toc-h2 toc-link" data-title="Métodos de Interfaz de Web CheckOut">Métodos de Interfaz de Web CheckOut</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#createrequest" class="toc-h3 toc-link" data-title="CreateRequest">CreateRequest</a>

                                


                            </li>
                            <li>
                              <a href="#getrequestinformation" class="toc-h3 toc-link" data-title="GetRequestInformation">GetRequestInformation</a>

                                


                            </li>
                            <li>
                              <a href="#reversepayment" class="toc-h3 toc-link" data-title="ReversePayment">ReversePayment</a>

                                


                            </li>
                            <li>
                              <a href="#collect" class="toc-h3 toc-link" data-title="Collect">Collect</a>

                                


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#estructuras-de-informacion" class="toc-h2 toc-link" data-title="Estructuras de información">Estructuras de información</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#redirectrequest" class="toc-h3 toc-link" data-title="RedirectRequest">RedirectRequest</a>

                                


                            </li>
                            <li>
                              <a href="#redirectresponse" class="toc-h3 toc-link" data-title="RedirectResponse">RedirectResponse</a>

                                


                            </li>
                            <li>
                              <a href="#redirectinformation" class="toc-h3 toc-link" data-title="RedirectInformation">RedirectInformation</a>

                                


                            </li>
                            <li>
                              <a href="#reverseresponse" class="toc-h3 toc-link" data-title="ReverseResponse">ReverseResponse</a>

                                


                            </li>
                            <li>
                              <a href="#person" class="toc-h3 toc-link" data-title="Person">Person</a>

                                


                            </li>
                            <li>
                              <a href="#paymentrequest" class="toc-h3 toc-link" data-title="PaymentRequest">PaymentRequest</a>

                                


                            </li>
                            <li>
                              <a href="#subscriptionrequest" class="toc-h3 toc-link" data-title="SubscriptionRequest">SubscriptionRequest</a>

                                


                            </li>
                            <li>
                              <a href="#subscriptionresponse" class="toc-h3 toc-link" data-title="SubscriptionResponse">SubscriptionResponse</a>

                                


                            </li>
                            <li>
                              <a href="#namevaluepair" class="toc-h3 toc-link" data-title="NameValuePair">NameValuePair</a>

                                


                            </li>
                            <li>
                              <a href="#status" class="toc-h3 toc-link" data-title="Status">Status</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#estado-de-una-peticion-o-pago" class="toc-h4 toc-link" data-title="Estado de una petición o pago">Estado de una petición o pago</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#transaction" class="toc-h3 toc-link" data-title="Transaction">Transaction</a>

                                


                            </li>
                            <li>
                              <a href="#token" class="toc-h3 toc-link" data-title="Token">Token</a>

                                


                            </li>
                            <li>
                              <a href="#documenttype" class="toc-h3 toc-link" data-title="DocumentType">DocumentType</a>

                                


                            </li>
                            <li>
                              <a href="#address" class="toc-h3 toc-link" data-title="Address">Address</a>

                                


                            </li>
                            <li>
                              <a href="#phonenumbertype" class="toc-h3 toc-link" data-title="PhoneNumberType">PhoneNumberType</a>

                                


                            </li>
                            <li>
                              <a href="#amount" class="toc-h3 toc-link" data-title="Amount">Amount</a>

                                


                            </li>
                            <li>
                              <a href="#taxdetail" class="toc-h3 toc-link" data-title="TaxDetail">TaxDetail</a>

                                


                            </li>
                            <li>
                              <a href="#amountdetail" class="toc-h3 toc-link" data-title="AmountDetail">AmountDetail</a>

                                


                            </li>
                            <li>
                              <a href="#amounttype" class="toc-h3 toc-link" data-title="AmountType">AmountType</a>

                                


                            </li>
                            <li>
                              <a href="#recurring" class="toc-h3 toc-link" data-title="Recurring">Recurring</a>

                                


                            </li>
                            <li>
                              <a href="#amountconversion" class="toc-h3 toc-link" data-title="AmountConversion">AmountConversion</a>

                                


                            </li>
                            <li>
                              <a href="#amountbase" class="toc-h3 toc-link" data-title="AmountBase">AmountBase</a>

                                


                            </li>
                            <li>
                              <a href="#collectrequest" class="toc-h3 toc-link" data-title="CollectRequest">CollectRequest</a>

                                


                            </li>
                            <li>
                              <a href="#items" class="toc-h3 toc-link" data-title="Items">Items</a>

                                


                            </li>
                            <li>
                              <a href="#item" class="toc-h3 toc-link" data-title="Item">Item</a>

                                


                            </li>
                            <li>
                              <a href="#instrument" class="toc-h3 toc-link" data-title="Instrument">Instrument</a>

                                


                            </li>
                            <li>
                              <a href="#simpletoken" class="toc-h3 toc-link" data-title="SimpleToken">SimpleToken</a>

                                


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#pagos" class="toc-h2 toc-link" data-title="Pagos">Pagos</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#pago-mixto" class="toc-h3 toc-link" data-title="Pago mixto">Pago mixto</a>

                                


                            </li>
                            <li>
                              <a href="#pago-recurrente" class="toc-h3 toc-link" data-title="Pago Recurrente">Pago Recurrente</a>

                                


                            </li>
                            <li>
                              <a href="#suscripcion" class="toc-h3 toc-link" data-title="Suscripción">Suscripción</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#recaudar-usando-suscripcion" class="toc-h4 toc-link" data-title="Recaudar usando suscripción">Recaudar usando suscripción</a>
                                      </li>
                                      <li>
                                        <a href="#pago-recurrente-vs-suscripcion" class="toc-h4 toc-link" data-title="Pago recurrente vs Suscripción">Pago recurrente vs Suscripción</a>
                                      </li>
                                  </ul>


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#notificacion" class="toc-h2 toc-link" data-title="Notificación">Notificación</a>
                   

                  </li>
                  <li>
                    <a href="#consulta" class="toc-h2 toc-link" data-title="Consulta">Consulta</a>
                   

                  </li>
                  <li>
                    <a href="#informacion-adicional" class="toc-h2 toc-link" data-title="Información adicional">Información adicional</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#campos-usados-por-tipo-de-operacion" class="toc-h3 toc-link" data-title="Campos usados por tipo de operación">Campos usados por tipo de operación</a>

                                


                            </li>
                            <li>
                              <a href="#tarjeta-de-pruebas" class="toc-h3 toc-link" data-title="Tarjeta de pruebas">Tarjeta de pruebas</a>

                                


                            </li>
                            <li>
                              <a href="#metodos-de-pago-codigos" class="toc-h3 toc-link" data-title="Métodos de Pago Códigos.">Métodos de Pago Códigos.</a>

                                


                            </li>
                            <li>
                              <a href="#tipos-de-documento" class="toc-h3 toc-link" data-title="Tipos de documento">Tipos de documento</a>

                                


                            </li>
                        </ul>

                  </li>
              </ul>
          </li>
          <li>
            <a href="#conexion-medios-de-pago-api" class="toc-h1 toc-link" data-title="Conexión medios de pago API">Conexión medios de pago API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#authentication" class="toc-h2 toc-link" data-title="Authentication">Authentication</a>
                   

                  </li>
                  <li>
                    <a href="#webservice-credito-colombia" class="toc-h2 toc-link" data-title="Webservice Credito Colombia">Webservice Credito Colombia</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#descripcion-del-metodo" class="toc-h3 toc-link" data-title="Descripción del método">Descripción del método</a>

                                


                            </li>
                            <li>
                              <a href="#flujo-de-integracion-aim" class="toc-h3 toc-link" data-title="Flujo de integración AIM">Flujo de integración AIM</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#en-que-casos-es-mejor-usar-este-tipo-de-integracion" class="toc-h4 toc-link" data-title="¿En qué casos es mejor usar este tipo de integración?">¿En qué casos es mejor usar este tipo de integración?</a>
                                      </li>
                                      <li>
                                        <a href="#que-obligaciones-tengo-al-usar-esta-integracion" class="toc-h4 toc-link" data-title="¿Qué obligaciones tengo al usar esta integración?">¿Qué obligaciones tengo al usar esta integración?</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#metodos-de-interfaz-credito-colombia" class="toc-h3 toc-link" data-title="Metodos de interfaz credito Colombia">Metodos de interfaz credito Colombia</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#solicitud-de-autorizacion" class="toc-h4 toc-link" data-title="Solicitud de autorización">Solicitud de autorización</a>
                                      </li>
                                      <li>
                                        <a href="#solicitud-de-captura" class="toc-h4 toc-link" data-title="Solicitud de captura">Solicitud de captura</a>
                                      </li>
                                      <li>
                                        <a href="#solicitud-de-asiento-o-anulacion-de-captura" class="toc-h4 toc-link" data-title="Solicitud de asiento o anulación de captura">Solicitud de asiento o anulación de captura</a>
                                      </li>
                                      <li>
                                        <a href="#solicitud-de-reversa" class="toc-h4 toc-link" data-title="Solicitud de reversa">Solicitud de reversa</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#estructura-de-datos-credito" class="toc-h3 toc-link" data-title="Estructura de datos credito">Estructura de datos credito</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#datos-de-la-especificacion" class="toc-h4 toc-link" data-title="Datos de la especificación">Datos de la especificación</a>
                                      </li>
                                      <li>
                                        <a href="#datos-del-comercio-y-operacion" class="toc-h4 toc-link" data-title="Datos del comercio y operación">Datos del comercio y operación</a>
                                      </li>
                                      <li>
                                        <a href="#datos-del-cobro" class="toc-h4 toc-link" data-title="Datos del cobro">Datos del cobro</a>
                                      </li>
                                      <li>
                                        <a href="#datos-para-cobros-recurrentes" class="toc-h4 toc-link" data-title="Datos para cobros recurrentes">Datos para cobros recurrentes</a>
                                      </li>
                                      <li>
                                        <a href="#datos-para-cobros-con-split" class="toc-h4 toc-link" data-title="Datos para cobros con Split">Datos para cobros con Split</a>
                                      </li>
                                      <li>
                                        <a href="#datos-del-pagador" class="toc-h4 toc-link" data-title="Datos del pagador">Datos del pagador</a>
                                      </li>
                                      <li>
                                        <a href="#datos-del-comprador-o-beneficiario-receptor-del-bien-o-servicio" class="toc-h4 toc-link" data-title="Datos del comprador o beneficiario receptor del bien o servicio">Datos del comprador o beneficiario receptor del bien o servicio</a>
                                      </li>
                                      <li>
                                        <a href="#datos-para-operaciones-sobre-transacciones" class="toc-h4 toc-link" data-title="Datos para operaciones sobre transacciones">Datos para operaciones sobre transacciones</a>
                                      </li>
                                      <li>
                                        <a href="#datos-adicionales-para-almacenar-con-la-transaccion" class="toc-h4 toc-link" data-title="Datos adicionales para almacenar con la transacción">Datos adicionales para almacenar con la transacción</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#informacion-adicional-credito-colombia" class="toc-h3 toc-link" data-title="Información adicional Credito Colombia">Información adicional Credito Colombia</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#campos-por-tipo-de-operacion" class="toc-h4 toc-link" data-title="Campos por tipo de operación">Campos por tipo de operación</a>
                                      </li>
                                      <li>
                                        <a href="#trama-de-respuesta" class="toc-h4 toc-link" data-title="Trama de respuesta">Trama de respuesta</a>
                                      </li>
                                      <li>
                                        <a href="#envio-de-transacciones-de-prueba" class="toc-h4 toc-link" data-title="Envío de transacciones de prueba">Envío de transacciones de prueba</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#consumo-del-webservice-de-sonda" class="toc-h3 toc-link" data-title="Consumo del Webservice de sonda">Consumo del Webservice de sonda</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#querytransaction" class="toc-h4 toc-link" data-title="QueryTransaction">QueryTransaction</a>
                                      </li>
                                      <li>
                                        <a href="#queryrequest" class="toc-h4 toc-link" data-title="QueryRequest">QueryRequest</a>
                                      </li>
                                      <li>
                                        <a href="#transaction-credito" class="toc-h4 toc-link" data-title="Transaction (Credito)">Transaction (Credito)</a>
                                      </li>
                                  </ul>


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#webservice-efectivo" class="toc-h2 toc-link" data-title="Webservice efectivo">Webservice efectivo</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#flujo-de-integracion-efectivo" class="toc-h3 toc-link" data-title="Flujo de integración efectivo">Flujo de integración efectivo</a>

                                


                            </li>
                            <li>
                              <a href="#metodos-de-interfaz-efectivo" class="toc-h3 toc-link" data-title="Métodos de interfaz efectivo">Métodos de interfaz efectivo</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#addorder" class="toc-h4 toc-link" data-title="addOrder">addOrder</a>
                                      </li>
                                      <li>
                                        <a href="#getorder" class="toc-h4 toc-link" data-title="getOrder">getOrder</a>
                                      </li>
                                      <li>
                                        <a href="#deleteorder" class="toc-h4 toc-link" data-title="deleteOrder">deleteOrder</a>
                                      </li>
                                      <li>
                                        <a href="#flushorders" class="toc-h4 toc-link" data-title="flushOrders">flushOrders</a>
                                      </li>
                                      <li>
                                        <a href="#getorderpdf" class="toc-h4 toc-link" data-title="getOrderPDF">getOrderPDF</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#estructuras-de-informacion-efectivo" class="toc-h3 toc-link" data-title="Estructuras de información efectivo">Estructuras de información efectivo</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#attribute" class="toc-h4 toc-link" data-title="Attribute">Attribute</a>
                                      </li>
                                      <li>
                                        <a href="#persona" class="toc-h4 toc-link" data-title="Persona">Persona</a>
                                      </li>
                                      <li>
                                        <a href="#cashorder" class="toc-h4 toc-link" data-title="CashOrder">CashOrder</a>
                                      </li>
                                      <li>
                                        <a href="#transaction" class="toc-h4 toc-link" data-title="Transaction">Transaction</a>
                                      </li>
                                      <li>
                                        <a href="#cashorderinfo" class="toc-h4 toc-link" data-title="CashOrderInfo">CashOrderInfo</a>
                                      </li>
                                  </ul>


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#webservice-pse" class="toc-h2 toc-link" data-title="Webservice PSE">Webservice PSE</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#flujo-de-integracion-pse" class="toc-h3 toc-link" data-title="Flujo de integración PSE">Flujo de integración PSE</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#despliegue-de-bancos-disponibles" class="toc-h4 toc-link" data-title="Despliegue de bancos disponibles">Despliegue de bancos disponibles</a>
                                      </li>
                                      <li>
                                        <a href="#confirmacion-y-redireccion-al-banco" class="toc-h4 toc-link" data-title="Confirmación y redirección al banco">Confirmación y redirección al banco</a>
                                      </li>
                                      <li>
                                        <a href="#reingreso-del-cliente" class="toc-h4 toc-link" data-title="Reingreso del cliente">Reingreso del cliente</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#metodos-de-interfaz-pse" class="toc-h3 toc-link" data-title="Métodos de interfaz PSE">Métodos de interfaz PSE</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#getbanklist" class="toc-h4 toc-link" data-title="getBankList">getBankList</a>
                                      </li>
                                      <li>
                                        <a href="#createtransaction" class="toc-h4 toc-link" data-title="createTransaction">createTransaction</a>
                                      </li>
                                      <li>
                                        <a href="#createtransactionmulticredit" class="toc-h4 toc-link" data-title="createTransactionMultiCredit">createTransactionMultiCredit</a>
                                      </li>
                                      <li>
                                        <a href="#gettransactioninformation" class="toc-h4 toc-link" data-title="getTransactionInformation">getTransactionInformation</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#estructuras-de-datos-pse" class="toc-h3 toc-link" data-title="Estructuras de datos PSE">Estructuras de datos PSE</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#attribute" class="toc-h4 toc-link" data-title="Attribute">Attribute</a>
                                      </li>
                                      <li>
                                        <a href="#persona" class="toc-h4 toc-link" data-title="Persona">Persona</a>
                                      </li>
                                      <li>
                                        <a href="#bank" class="toc-h4 toc-link" data-title="Bank">Bank</a>
                                      </li>
                                      <li>
                                        <a href="#creditconcept" class="toc-h4 toc-link" data-title="CreditConcept">CreditConcept</a>
                                      </li>
                                      <li>
                                        <a href="#psetransactionrequest" class="toc-h4 toc-link" data-title="PSETransactionRequest">PSETransactionRequest</a>
                                      </li>
                                      <li>
                                        <a href="#psetransactionmulticreditrequest" class="toc-h4 toc-link" data-title="PSETransactionMultiCreditRequest">PSETransactionMultiCreditRequest</a>
                                      </li>
                                      <li>
                                        <a href="#psetransactionresponse" class="toc-h4 toc-link" data-title="PSETransactionResponse">PSETransactionResponse</a>
                                      </li>
                                      <li>
                                        <a href="#transactioninformation" class="toc-h4 toc-link" data-title="TransactionInformation">TransactionInformation</a>
                                      </li>
                                  </ul>


                            </li>
                        </ul>

                  </li>
                  <li>
                    <a href="#webservice-tuya" class="toc-h2 toc-link" data-title="Webservice Tuya">Webservice Tuya</a>
                   
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#flujo-de-integracion-tuya" class="toc-h3 toc-link" data-title="Flujo de integración Tuya">Flujo de integración Tuya</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#confirmacion-y-redireccion-a-banco" class="toc-h4 toc-link" data-title="Confirmación y redirección a banco">Confirmación y redirección a banco</a>
                                      </li>
                                      <li>
                                        <a href="#reingreso-cliente" class="toc-h4 toc-link" data-title="Reingreso cliente">Reingreso cliente</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#metodos-de-interfaz-tuya" class="toc-h3 toc-link" data-title="Métodos de interfaz Tuya">Métodos de interfaz Tuya</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#createtransaction" class="toc-h4 toc-link" data-title="createTransaction">createTransaction</a>
                                      </li>
                                      <li>
                                        <a href="#gettransactioninformation" class="toc-h4 toc-link" data-title="getTransactionInformation">getTransactionInformation</a>
                                      </li>
                                  </ul>


                            </li>
                            <li>
                              <a href="#estructuras-de-datos-tuya" class="toc-h3 toc-link" data-title="Estructuras de datos Tuya">Estructuras de datos Tuya</a>

                                
                                  <ul class="toc-list-h4">
                                      <li>
                                        <a href="#attribute" class="toc-h4 toc-link" data-title="Attribute">Attribute</a>
                                      </li>
                                      <li>
                                        <a href="#persona" class="toc-h4 toc-link" data-title="Persona">Persona</a>
                                      </li>
                                      <li>
                                        <a href="#tuyatransactionrequest" class="toc-h4 toc-link" data-title="TuyaTransactionRequest">TuyaTransactionRequest</a>
                                      </li>
                                      <li>
                                        <a href="#tuyatransactionresponse" class="toc-h4 toc-link" data-title="TuyaTransactionResponse">TuyaTransactionResponse</a>
                                      </li>
                                      <li>
                                        <a href="#transactioninformation" class="toc-h4 toc-link" data-title="TransactionInformation">TransactionInformation</a>
                                      </li>
                                  </ul>


                            </li>
                        </ul>

                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://www.placetopay.com'>www.placetopay.com</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='webcheckout'>WebCheckOut</h1>
<p>Con WebCheckOut tu sitio obtiene una URL a la cual será redireccionado tu usuario para realizar el proceso transaccional. De esta manera, evitas capturar información sensible y la definición para una interfaz de un proceso de pago.</p>

<p>El API de WebCheckOut está basado en REST, retorna respuestas con codificación JSON. Para hacer uso de este servicio es necesario que tu sitio  se conecte usando la versión 1.2 de TLS.</p>

<p>Puede usar la API WebCheckOut en modo de prueba, que no interactúa con las redes bancarias. Dependiendo del endpoint usado en la solicitud determina si la misma es en modo productivo o en modo de prueba.</p>

<p><strong>Modo pruebas:</strong> <code>https://test.placetopay.com/redirection/api/session/</code></p>

<p><strong>Modo producción:</strong> <code>https://checkout.placetopay.com</code></p>

<p><strong>Consideraciones:</strong></p>

<ul>
<li><p>Se necesita la URL donde se van a enviar los datos mediante el uso del método POST (Endpoint).</p></li>
<li><p>Se debe usar JSON para el envío de los parámetros de autenticación, información del pago y datos de control.</p></li>
<li><p>El tiempo de expiración <code>expiration</code> debe ser una fecha válida en formato <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>, indica el tiempo
límite que tiene el usuario para realizar el pago y debe ser de al menos 5 minutos superior a la fecha actual.</p></li>
</ul>

<p><strong>Importante:</strong> El <code>expiration</code> es el tiempo máximo que se da para la sesión, si un usuario no realiza la operación la sesión queda pendiente hasta expirar. </p>

<ul>
<li><p>La url de retorno (returnUrl) es utilizada para redirigir al usuario una vez terminada la operación. Se recomienda enviar en la URL un dato con el cual el sitio pueda identificar el registro por ejemplo: <code>https://mysite.com/response/{reference}</code>.</p></li>
<li><p>Configura en tu servidor una URL de notificación usando los puertos 80 ó 443 y en caso de que el pago se decline o apruebe, reciba una notificación mediante POST de forma asíncrona.</p></li>
</ul>

<p><strong>Importante:</strong> Esta URL de notificación debe ser suministrada a PlacetoPay para su configuración.</p>
<h2 id='flujo-de-integracion'>Flujo de integración</h2>
<p><img src="images/Warehouse@2x.png" alt="Warehouse@2x" /></p>

<ol>
<li>Al momento del usuario proceder con la operación en tu sitio, debes consumir el método <a href="#createrequest">createRequest</a>.</li>
<li>Si la solicitud es procesada correctamente, el servicio crea una sesión y retorna en la respuesta: <br>

<ul>
<li>Identificador <code>requestID</code></li>
<li>URL de procesamiento <code>processUrl</code>.</li>
</ul></li>
<li>Crea un registro en tu sistema, relaciona ese registro al <code>requestID</code> y déjalo en estado pendiente.</li>
<li>Redirecciona al usuario al <code>processURL</code> obtenido en el punto 2.</li>
<li>En la interfaz de Web Checkout el usuario realizará el proceso de pago o suscripción.</li>
<li>Una vez el usuario realiza el proceso y hace clic en “Regresar al comercio”, éste es enviado a la URL de retorno <code>returnUrl</code> (Atributo especificado al crear la operación).</li>
<li>Al llegar a tu sitio, con el <code>requestID</code> del registro debes consultar a PlacetoPay el estado de la sesión usando el método <a href="#getrequestinformation">getRequestInformation</a>.</li>
<li>Ejecuta tu regla de negocio según el estado obtenido.</li>
<li>De manera asincrónica, PlacetoPay realiza una notificación, del estado final de una sesión, a tu sitio.</li>
<li>Recomendamos implementar un proceso sonda para resolver aquellas transacciones que no  se resolvieron en los punto 7 y 9.</li>
</ol>
<h2 id='librerias'>Librerías</h2><h3 id='instalacion-para-c-sharp'>Instalación para C Sharp</h3><h4 id='donde-obtener-la-libreria'>¿Dónde obtener la librería?</h4>
<p>Repositorio: SDK .NET Framework 4.5.0 de Web Checkout.</p>

<p><strong>DLL y dependencias:</strong> <br></p>

<p><a href="https://drive.google.com/open?id=1UMy7SibuN3aVlRd4B8oLifCVQwxURzzv">https://drive.google.com/open?id=1UMy7SibuN3aVlRd4B8oLifCVQwxURzzv</a></p>
<h4 id='que-versiones-soporta'>¿Qué versiones soporta?</h4>
<p>La versión es estable para la versión 4.5.0</p>
<h4 id='que-datos-debo-tener-antes-de-iniciar-la-instalacion'>¿Qué datos debo tener antes de iniciar la instalación?</h4>
<p>PlacetoPay suministra <code>login</code> y <code>trankey</code>, datos que serán usados para la autenticación y relacionar las transacciones al sitio correspondiente.</p>
<h4 id='agregar-dependencia-en-visual-studio'>Agregar dependencia en Visual Studio</h4>
<p>Ir al explorador de soluciones, desplegar las opciones del proyecto y luego: <br>
 Dependencias -&gt; agregar referencia -&gt; examinar -&gt; examinar  -&gt; seleccionar dll -&gt; Aceptar</p>
<h4 id='como-usar-la-clase'>¿Cómo usar la clase?</h4>
<p>Configurar instancia PlacetoPay necesaria para autenticarse ante los servicios web de PlacetoPay.</p>
<pre class="highlight csharp tab-csharp"><code>    <span class="k">using</span> <span class="nn">P2P</span> <span class="p">=</span> <span class="n">PlacetoPay</span><span class="p">.</span><span class="n">Integrations</span><span class="p">.</span><span class="n">Library</span><span class="p">.</span><span class="n">CSharp</span><span class="p">.</span><span class="n">PlacetoPay</span><span class="p">;</span>
    <span class="n">Gateway</span> <span class="n">gateway</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">P2P</span><span class="p">(</span><span class="n">YOUR_LOGIN</span><span class="p">,</span>
                              <span class="n">YOUR_TRANKEY</span><span class="p">,</span>
                              <span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"URL_INTEGRATION"</span><span class="p">),</span>
                              <span class="n">Gateway</span><span class="p">.</span><span class="n">TP_SOAP</span> <span class="n">or</span> <span class="n">Gateway</span><span class="p">.</span><span class="n">TP_REST</span><span class="p">);</span>
</code></pre>
<p>El parámetro <code>&quot;URL_INTEGRATION&quot;</code> hace referencia al endpoint a usar, los cuales son: <br>
<strong>Pruebas:</strong> https://test.placetopay.com/redirection/ <br>
<strong>Producción:</strong> https://secure.placetopay.com/redirection/ <br></p>
<h4 id='crear-una-nueva-sesion-de-pago-createrequest'>Crear una nueva sesión de pago <code>CreateRequest</code></h4>
<p>Solicita la creación de la sesión (petición de cobro o suscripción) y retorna el identificador y la URL de procesamiento. <br></p>

<blockquote>
<p>Ejemplo de llamada:</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code>    <span class="n">Amount</span> <span class="n">amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Amount</span><span class="p">(</span><span class="err">'</span><span class="n">PAYMENT_AMOUNT</span><span class="err">'</span><span class="p">);</span>
    <span class="n">Payment</span> <span class="n">payment</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Payment</span><span class="p">(</span><span class="s">"REFERENCE"</span><span class="p">,</span> <span class="s">"DESCRIPTION"</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
    <span class="n">RedirectRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RedirectRequest</span><span class="p">(</span><span class="n">payment</span><span class="p">,</span>
        <span class="n">RETURN_URL</span><span class="p">,</span>
        <span class="n">IP_ADDRESS</span><span class="p">,</span>
        <span class="n">USER_AGENT</span><span class="p">,</span>
        <span class="n">EXPIRATION</span><span class="p">);</span>

    <span class="n">RedirectResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="n">gateway</span><span class="p">.</span><span class="nf">Request</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</code></pre>
<p><strong>Retorno:</strong> <br>
    Servicio responde una instancia de la clase <code/>RedirectResponse.</code> Verificando el status de la respuesta se puede determinar si se creó la session de pago. <br></p>

<p>Success Response: si el status es igual a <strong>“OK”</strong> <br></p>

<p>Verificar: <code>response.IsSuccessful() // return boolean</code> <br></p>

<p>Error Response: si el status es igual a <strong>“ERROR”</strong> <br></p>

<p>Verificar motivo del error: <code>response.Status.Message // return string</code></p>
<h4 id='obtenga-informacion-sobre-una-sesion-getrequestinformation'>Obtenga información sobre una sesión <code>(getRequestInformation)</code></h4>
<p>Obtiene la información de la sesión y transacciones realizadas.</p>

<blockquote>
<p>Ejemplo de llamada:</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code>    <span class="n">RedirectInformation</span> <span class="n">response</span> <span class="p">=</span> <span class="n">gateway</span><span class="p">.</span><span class="nf">Query</span><span class="p">(</span><span class="n">requestId</span><span class="p">);</span>
</code></pre>
<p><strong>Retorno:</strong> <br></p>

<p>Servicio responde una instancia de la clase <code>RedirectInformation</code>. Se puede verificar el status de la sesión a través: <br></p>

<p><code>response.IsSuccessful() // return boolean</code> <br>
<code>response.IsRejected() // return boolean</code> <br>
<code>response.IsApproved() // return boolean</code> <br>
<code>response.Status.status // return boolean</code> <br></p>
<h4 id='cobro-sin-intervencion-del-usuario-collect'>Cobro sin intervención del usuario (Collect)</h4>
<p>Permite realizar cobros sin la intervención del usuario usando medios de pago previamente suscritos.</p>

<blockquote>
<p>Ejemplo de llamada:</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code>    <span class="n">Token</span> <span class="n">token</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Token</span><span class="p">(</span><span class="err">“</span><span class="n">YOUR_TOKEN</span><span class="err">”</span><span class="p">);</span>
    <span class="n">Instrument</span> <span class="n">instrument</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Instrument</span><span class="p">(</span><span class="n">token</span><span class="p">);</span>
    <span class="n">Person</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Surname</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
    <span class="n">Amount</span> <span class="n">amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Amount</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>
    <span class="n">Payment</span> <span class="n">payment</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Payment</span><span class="p">(</span><span class="s">"123456789"</span><span class="p">,</span> <span class="s">"TEST"</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
    <span class="n">CollectRequest</span> <span class="n">collectRequest</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CollectRequest</span><span class="p">(</span><span class="n">person</span><span class="p">,</span>
                                            <span class="n">payment</span><span class="p">,</span><span class="n">instrument</span><span class="p">);</span>
    <span class="n">RedirectInformation</span> <span class="n">collect</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">gateway</span><span class="p">.</span><span class="nf">Collect</span><span class="p">(</span><span class="n">collectRequest</span><span class="p">);</span>
</code></pre>
<p><strong>Retorno:</strong> <br>
Servicio responde una instancia de la clase <code>RedirectInformation</code>. Se puede verificar el status de la sesión a través:<br></p>

<p><code>response.IsSuccessful() // return boolean</code> <br>
<code>response.IsRejected() // return boolean</code> <br>
<code>response.IsApproved() // return boolean</code> <br>
<code>response.Status.status // return boolean</code> <br></p>
<h4 id='revertir-un-pago-reversepayment'>Revertir un pago <code>(reversePayment)</code></h4>
<p>Permite revertir un pago aprobado con el código de referencia interna.</p>

<blockquote>
<p>Ejemplo de llamada:</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code>    <span class="n">ReverseResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">gateway</span><span class="p">.</span><span class="nf">Reverse</span><span class="p">(</span><span class="n">requestId</span><span class="p">);</span>
</code></pre>
<p><strong>Retorno:</strong><br>
  Servicio responde una instancia de la clase <code>ReverseResponse</code>. Se puede verificar el status de la sesión a través:<br></p>

<p><code>response.IsSuccessful() // return boolean</code><br>
   <code>response.Status.status // return boolean</code></p>

<h4 id='leer-respuesta-enviada-a-la-url-de-notificacion-readnotification'>Leer respuesta enviada a la url de notificación <code>(ReadNotification)</code></h4>
<p>Permite leer la respuesta enviada por parte de PlacetoPay a la Url de notificación del comercio. <br></p>

<blockquote>
<p>Ejemplo de llamada:</p>

<p>// La notificación enviado por parte de PlacetoPay tiene la siguiente forma.</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code><span class="p">{</span>
   <span class="s">"status"</span><span class="p">:{</span>
      <span class="s">"status"</span><span class="p">:</span><span class="s">"APPROVED"</span><span class="p">,</span>
      <span class="s">"reason"</span><span class="p">:</span><span class="s">"00"</span><span class="p">,</span>
      <span class="s">"message"</span><span class="p">:</span><span class="s">"Se ha aprobado su pago"</span><span class="p">,</span>
      <span class="s">"date"</span><span class="p">:</span><span class="s">"2016-10-10T16:39:57-05:00"</span>
   <span class="p">},</span>
   <span class="s">"requestId"</span><span class="p">:</span><span class="m">83</span><span class="p">,</span>
   <span class="s">"reference"</span><span class="p">:</span><span class="s">"TEST_20161010_213937"</span><span class="p">,</span>
   <span class="s">"signature"</span><span class="p">:</span><span class="s">"8fb4beea130ab3e75a1de956bd0213892e0f6839"</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>// La variable “data” debe ser un json con la estructura mencionada arriba en formato string.</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code><span class="n">Notification</span> <span class="n">notification</span> <span class="p">=</span> <span class="n">_gateway</span><span class="p">.</span><span class="nf">ReadNotification</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

   <span class="c1">// Verificar si la notificación es válida</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">notification</span><span class="p">.</span><span class="nf">isValidNotification</span><span class="p">())</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">notification</span><span class="p">.</span><span class="nf">isApproved</span><span class="p">())</span> <span class="p">{</span>
           <span class="c1">// Liberar el producto</span>
       <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
           <span class="c1">// Rechazar la orden</span>
       <span class="p">}</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="c1">// There was some error or invalid structure</span>
   <span class="p">}</span>
</code></pre><h4 id='posibles-errores'>Posibles errores</h4>
<p>Para cado uno de los objetos de respuesta, al momento de presentarse alguna excepción o problema de conexión se informa en la propiedad  status.</p>
<h3 id='instalacion-librerias-para-java'>Instalación librerÍas para JAVA</h3>
<p>Para conectarse con PlacetoPay por medio del servicio de web checkout utilizando java, ingrese al siguiente enlace: <br></p>

<p><a href="https://github.com/placetopay/java-placetopay">https://github.com/placetopay/java-placetopay</a></p>
<h2 id='autenticacion'>Autenticación</h2><pre class="highlight shell tab-shell"><code>
Ejemplo:
    Información proporcionada:
    login <span class="o">=</span> usuarioprueba
    secretKey <span class="o">=</span> ABCD1234

    Datos generados por el usuario:
    nonce <span class="o">=</span> c9085e82debb82b0955579098be3d7ca //Nonce original
    seed <span class="o">=</span> 2019-04-25T18:17:23-04:00

    Datos a enviar:
    tranKey <span class="o">=</span> i/RFwSHAh8d7YgtO3HME5kCnYy8<span class="o">=</span>
    nonce <span class="o">=</span> <span class="nv">YzkwODVlODJkZWJiODJiMDk1NTU3OTA5OGJlM2Q3Y2E</span><span class="o">=</span> //Nonce en base64
</code></pre><pre class="highlight shell tab-shell"><code>
Ejemplo:
POST /api/session

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"T0O+x3gNlQUf0iBxEuenPvBPlWs="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"YzkwODVlODJkZWJiODJiMDk1NTU3OTA5OGJlM2Q3Y2E="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>,
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>La autenticación al servicio debe ser enviada sobre el objeto <code>auth</code>, el cual debe contener los siguientes atributos:</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>login</td>
<td>Identificador del sitio.</td>
</tr>
<tr>
<td>tranKey</td>
<td>Llave transaccional, que está formada por la siguiente operación: <code>Base64(SHA-1(nonce + seed + secretkey))</code>. El nonce dentro de la operación es el original, es decir, el que no está en Base64.</td>
</tr>
<tr>
<td>nonce</td>
<td>Valor aleatorio para cada solicitud codificado en Base64.</td>
</tr>
<tr>
<td>seed</td>
<td>Fecha actual, la cual se genera en formato <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</td>
</tr>
</tbody></table>

<aside class="notice">
El login y el secretKey son suministrados por PlacetoPay
</aside>

<aside class="notice">
Esta estructura debe de ser enviada en cada petición realizada al servicio
</aside>

<aside class="warning">
El <code>seed</code> no puede tener diferencia de más de 5 minutos.
</aside>
<h3 id='ejemplos-de-autenticacion'>Ejemplos de autenticación</h3>
<p><a href="https://github.com/dnetix/redirection" target="_blank" style="text-decoration: none;">
 <img src="images/php.png" class="logo-lenguaje" alt="PHP">
</a>
<a href="https://gist.github.com/dnetix/f37de7864b4efb8249d30e476e379f0a" target="_blank" style="text-decoration: none;">
<img src="images/java.png" class="logo-lenguaje" alt="JAVA">
</a>
<a href="https://gist.github.com/dnetix/c18cc44861c5702d2b8ff2327b031c3e" target="_blank" style="text-decoration: none;">
<img src="images/c.png" class="logo-lenguaje" alt="C#">
</a>
<a href="https://gist.github.com/dnetix/fea3868afe915229c7d140967e4d8519" target="_blank" style="text-decoration: none;">
<img src="images/node.png" class="logo-lenguaje" alt="NodeJS">
</a></p>

<p>Todas las solicitudes al web deben ser autenticadas con <a href="https://www.oasis-open.org/committees/download.php/13392/wss-v1.1-spec-pr-UsernameTokenProfile-01.htm">WS Security UsernameToken Profile 1.1</a></p>

<p>Usando <code>PasswordDigest (PasswordDigest = Base64 ( SHA-1 ( nonce + created + tranKey ) ))</code></p>
<h2 id='errores'>Errores</h2>
<blockquote>
<p>Ejemplo autenticación fallida:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"FAILED"</span>,
        <span class="s2">"reason"</span>: 401,
        <span class="s2">"message"</span>: <span class="s2">"Authentication Failed 103"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-03-06T17:08:36-05:00"</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>El servicio de Web CheckOut retorna los códigos de respuesta para la autenticación fallida en el atributo <code>message</code> del objeto <code>status</code>.</p>

<table><thead>
<tr>
<th>Código</th>
<th>Causa</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>UsernameToken no proporcionado (Encabezado de la autorización malformado).</td>
</tr>
<tr>
<td>101</td>
<td>Identificador de sitio no existe ( Login incorrecto o no se encuentra en el ambiente).</td>
</tr>
<tr>
<td>102</td>
<td>El hash de TranKey no coincide (Trankey incorrecto o mal formado).</td>
</tr>
<tr>
<td>103</td>
<td>Fecha de la semilla mayor de 5 minutos.</td>
</tr>
<tr>
<td>104</td>
<td>Sitio inactivo.</td>
</tr>
<tr>
<td>105</td>
<td>Sitio expirado.</td>
</tr>
<tr>
<td>106</td>
<td>Credenciales expiradas.</td>
</tr>
<tr>
<td>107</td>
<td>Mala definición del UsernameToken (No cumple con el encabezado WSSE).</td>
</tr>
<tr>
<td>200</td>
<td>Saltar el encabezado de autenticación SOAP.</td>
</tr>
<tr>
<td>10001</td>
<td>Contacte a Soporte.</td>
</tr>
</tbody></table>

<p><aside class="warning">
Si el error retornado no corresponde a ninguna anteriormente descrito, por favor revise el endpoint de consumo usado.
</aside>.</p>
<h3 id='errores-frecuentes'>Errores frecuentes</h3>
<ul>
<li><p><strong>Mensaje de error “Autenticación mal formada”</strong> <br><br>
Se presenta cuando el sistema no detecta que se esté enviando login, tranKey, seed o nonce en la estructura auth enviada, también puede presentarse si se envían estos datos pero de manera incorrecta, es decir sin el parámetro content-type “application/json” de manera que el servidor interpreta la petición como texto en vez de un arreglo de datos.
Puedes validar esto haciendo la petición a la URL <a href="https://dnetix.co/p2p/client">https://dnetix.co/p2p/client</a> y capturando la respuesta, es una especie de espejo de la petición que te permitirá comprobar los parámetros y el body del mensaje.</p></li>
<li><p><strong>Error conectando al servicio con el mensaje</strong> <code>ERROR: javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake</code> <br><br>
Tus servidores requieren TLSv1.2 para recibir la solicitud, debido a la norma PCI. Por favor, revisa el cifrado y el protocolo utilizado para conectar al servidor. Si usas Java, ten presente que solo las versiones después de la 8 tienen soporte completo.</p></li>
<li><p><strong>SoapFault responde con el mensaje &quot;Authentication Failed 103&quot;</strong> <br><br> 
En el proceso de autenticación nosotros revisamos el campo <code>Created</code>, este campo debe estar en el tiempo GMT o el tiempo local usando el tiempo de zona. Si obtienes esta respuesta, se debe a que tu tiempo no es preciso con el tiempo real. Nosotros solo permitimos 5 minutos de diferencia entre los tiempos.
Puedes usar NTP para mantener la precisión del reloj. </p></li>
<li><p><strong>Dando los mismos valores EXACTOS que en los ejemplos anteriores a la <code>BASE64(SHA1($Nonce + $Created . $tranKey))</code> estoy obteniendo un <code>password digest</code> diferente.</strong> <br><br> 
Mantén en mente que BASE64 debería ser para el raw output  de la SHA1 y de acuerdo con todos los lenguajes de programación este puede ser requerido para configurar esta opción, por ejemplo.
En PHP base64_encode(sha1( … , true)) este parametro retornaria el <code>raw output</code> para el <code>sHA1 algorithm</code></p></li>
</ul>
<h2 id='metodos-de-interfaz-de-web-checkout'>Métodos de Interfaz de Web CheckOut</h2>
<p>El web service contiene diferentes métodos donde se ejecutan operaciones de tipo solicitud - respuesta, estas requieren para cada una, parámetros de ingreso que son usados por las estructuras de datos con las que se procesan información para posteriormente retornar una respuesta.</p>

<p>Si deseas ejecutar un método rápidamente puedes usar: <a href="https://dnetix.co/p2p/client">https://dnetix.co/p2p/client</a></p>
<h3 id='createrequest'>CreateRequest</h3>
<blockquote>
<p>Ejemplo para la petición de un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/session

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"jsHJzM3+XG754wXh+aBvi70D9/4="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"TTJSa05UVmtNR000TlRrM1pqQTRNV1EREprWkRVMU9EZz0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
  <span class="o">}</span>,
    <span class="s2">"locale"</span>: <span class="s2">"en_CO"</span>,
    <span class="s2">"buyer"</span>: <span class="o">{</span>
      <span class="s2">"name"</span>: <span class="s2">"Deion"</span>,
      <span class="s2">"surname"</span>: <span class="s2">"Ondricka"</span>,
      <span class="s2">"email"</span>: <span class="s2">"dnetix@yopmail.com"</span>,
      <span class="s2">"document"</span>: <span class="s2">"1040035000"</span>,
      <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
      <span class="s2">"mobile"</span>: 3006108300
  <span class="o">}</span>,

    <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago básico de prueba 04032019"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>,
      <span class="s2">"allowPartial"</span>:false
      <span class="o">}</span>,

    <span class="s2">"expiration"</span>: <span class="s2">"2019-03-05T00:00:00-05:00"</span>,
    <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3210"</span>,
    <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
    <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>
<span class="o">}</span>
</code></pre>
<p>Solicita la creación de la sesión (petición de cobro o suscripción) y retorna el identificador y la URL de procesamiento. <br> <br></p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>payload <code>Opcional</code></td>
<td><a href="#redirectrequest">RedirectRequest</a></td>
<td>Información sobre el pago requerido</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
   <strong><a href="#redirectresponse">RedirectResponse</a>:</strong> Es un objeto con la información de redirección.</p>
<h3 id='getrequestinformation'>GetRequestInformation</h3>
<blockquote>
<p>Ejemplo para obtener información de una petición:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/session/REQUEST_ID
Remplace el REQUEST_ID con el valor devuelto en la respuesta de la petición de pago.

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"T0O+x3gNlQUf0iBxEuenPvBPlWs="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"YzkwODVlODJkZWJiODJiMDk1NTU3OTA5OGJlM2Q3Y2E="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>,
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>Obtiene la información de la sesión y transacciones realizadas. <br> <br> </p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>requestId <code>Requerido</code></td>
<td>int</td>
<td>Identificador de la sesión a consultar.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
  <strong><a href="#redirectinformation">RedirectInformation</a>:</strong> Información del estado de la transacción</p>
<h3 id='reversepayment'>ReversePayment</h3>
<blockquote>
<p>Ejemplo para revertir un pago aprobado:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/reverse
<span class="o">{</span>
    <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"jsHJzM3+XG754wXh+aBvi70D9/4="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"TTJSa05UVmtNR000TlRrM1pqQTRNV1EREprWkRVMU9EZz0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
    <span class="o">}</span>,
    <span class="s2">"internalReference"</span>: <span class="s2">"1468647381"</span>
<span class="o">}</span>
</code></pre>
<p>Permite revertir un pago aprobado con el código de referencia interna. <br> <br></p>

<p>PARÁMETROS </p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>internalReference <code>Requerido</code></td>
<td>int</td>
<td>Referencia interna de la transacción a reversar que se encuentra en el listado de transacciones del getRequestInformation (payment).</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#reverseresponse">ReverseResponse</a>:</strong> Información de estado de la operación.</p>
<h3 id='collect'>Collect</h3>
<p>Permite realizar cobros sin la intervención del usuario usando medios de pago previamente suscritos.<br><br></p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>payload <code>Requerido</code></td>
<td><a href="#collectrequest">CollectRequest</a></td>
<td>Datos del pago, pagador y medio de pago a implementar como se describe en la estructura <code>CollectRequest</code>.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#redirectinformation">RedirectInformation</a>:</strong> Información de estado de la operación.</p>
<h2 id='estructuras-de-informacion'>Estructuras de información</h2>
<p>Esta sección describe cada una de las estructuras de datos usada por los métodos de web service.</p>
<h3 id='redirectrequest'>RedirectRequest</h3>
<blockquote>
<p>Ejemplo de una estructura RedirectRequest para la solicitud de un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>    ...
       <span class="o">{</span>
        <span class="s2">"locale"</span>: <span class="s2">"es_CO"</span>,
        <span class="s2">"buyer"</span>: <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"Prof. General Hoppe"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"Kuhic"</span>,
            <span class="s2">"email"</span>: <span class="s2">"ejohns@yahoo.com"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
            <span class="s2">"document"</span>: <span class="s2">"4216523744"</span>,
            <span class="s2">"mobile"</span>: <span class="s2">"3006108300"</span>,
            <span class="s2">"address"</span>: <span class="o">{</span>
                <span class="s2">"street"</span>: <span class="s2">"27791 Kyle Vista"</span>,
                <span class="s2">"city"</span>: <span class="s2">"Metzton"</span>,
                <span class="s2">"state"</span>: <span class="s2">"Antioquia"</span>,
                <span class="s2">"postalCode"</span>: <span class="s2">"46366-1132"</span>,
                <span class="s2">"country"</span>: <span class="s2">"US"</span>,
                <span class="s2">"phone"</span>: <span class="s2">"438-475-0498 x513"</span>
            <span class="o">}</span>
        <span class="o">}</span>,
        <span class="s2">"payment"</span>: <span class="o">{</span>
            <span class="s2">"reference"</span>: <span class="s2">"TEST_20190517_161956"</span>,
            <span class="s2">"description"</span>: <span class="s2">"Et alias quia nisi sequi."</span>,
            <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"taxes"</span>: <span class="o">[</span>
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"ice"</span>,
                <span class="s2">"amount"</span>: 2.76,
                <span class="s2">"base"</span>: 23
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"valueAddedTax"</span>,
                <span class="s2">"amount"</span>: 4.37,
                <span class="s2">"base"</span>: 23
                <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"details"</span>: <span class="o">[</span>
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"shipping"</span>,
                <span class="s2">"amount"</span>: 1.15
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"tip"</span>,
                <span class="s2">"amount"</span>: 1.15
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"subtotal"</span>,
                <span class="s2">"amount"</span>: 23
                <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"currency"</span>: <span class="s2">"USD"</span>,
            <span class="s2">"total"</span>: 32.43
            <span class="o">}</span>,
            <span class="s2">"items"</span>: <span class="o">[</span>
            <span class="o">{</span>
                <span class="s2">"sku"</span>: 62762,
                <span class="s2">"name"</span>: <span class="s2">"Placeat consequuntur."</span>,
                <span class="s2">"category"</span>: <span class="s2">"physical"</span>,
                <span class="s2">"qty"</span>: 1,
                <span class="s2">"price"</span>: 23,
                <span class="s2">"tax"</span>: 4.37
            <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"recurring_remove"</span>: <span class="o">{</span>
            <span class="s2">"periodicity"</span>: <span class="s2">"D"</span>,
            <span class="s2">"interval"</span>: 7,
            <span class="s2">"nextPayment"</span>: <span class="s2">"2019-05-19"</span>,
            <span class="s2">"maxPeriods"</span>: 4,
            <span class="s2">"notificationUrl"</span>: <span class="s2">"https://dnetix.co/ping/recurring_notification"</span>
            <span class="o">}</span>,
            <span class="s2">"shipping"</span>: <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"Prof. General Hoppe"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"Kuhic"</span>,
            <span class="s2">"email"</span>: <span class="s2">"ejohns@yahoo.com"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
            <span class="s2">"document"</span>: <span class="s2">"4216523744"</span>,
            <span class="s2">"mobile"</span>: <span class="s2">"3006108300"</span>,
            <span class="s2">"address"</span>: <span class="o">{</span>
                <span class="s2">"street"</span>: <span class="s2">"27791 Kyle Vista"</span>,
                <span class="s2">"city"</span>: <span class="s2">"Metzton"</span>,
                <span class="s2">"state"</span>: <span class="s2">"Antioquia"</span>,
                <span class="s2">"postalCode"</span>: <span class="s2">"46366-1132"</span>,
                <span class="s2">"country"</span>: <span class="s2">"US"</span>,
                <span class="s2">"phone"</span>: <span class="s2">"438-475-0498 x513"</span>
            <span class="o">}</span>
            <span class="o">}</span>,
            <span class="s2">"allowPartial"</span>: <span class="nb">false</span>
        <span class="o">}</span>,
        <span class="s2">"expiration"</span>: <span class="s2">"2019-05-18T16:19:56-05:00"</span>,
        <span class="s2">"ipAddress"</span>: <span class="s2">"190.85.82.130"</span>,
        <span class="s2">"userAgent"</span>: <span class="s2">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36"</span>,
        <span class="s2">"returnUrl"</span>: <span class="s2">"https://dnetix.co/p2p/client"</span>,
        <span class="s2">"cancelUrl"</span>: <span class="s2">"https://dnetix.co"</span>,
        <span class="s2">"skipResult"</span>: <span class="nb">false</span>,
        <span class="s2">"noBuyerFill"</span>: <span class="nb">false</span>,
        <span class="s2">"captureAddress"</span>: <span class="nb">false</span>,
        <span class="s2">"paymentMethod"</span>: null,
        <span class="s2">"fields"</span>: <span class="o">[</span>
            <span class="o">{</span>
            <span class="s2">"keyword"</span>: <span class="s2">"Redeem Code"</span>,
            <span class="s2">"value"</span>: 226931,
            <span class="s2">"displayOn"</span>: <span class="s2">"payment"</span>
            <span class="o">}</span>
        <span class="o">]</span>,
    ...    
</code></pre>
<p>Estructura que contiene toda la información acerca de la transacción para ser procesada. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>locale <code>Opcional</code></td>
<td>string</td>
<td>Definido con los códigos <a href="https://es.wikipedia.org/wiki/ISO_639-1">ISO 631-1</a> (language) y <a href="https://es.wikipedia.org/wiki/ISO_3166-1">ISO 3166-1</a> alpha-2 (2-letras del país). <code>ej. en_US, es_CO</code></td>
</tr>
<tr>
<td>payer <code>Opcional</code></td>
<td><a href="#person">Person</a></td>
<td>Información del ordenante, si establece este objeto, los datos del pagador utilizarán esta información.</td>
</tr>
<tr>
<td>buyer <code>Opcional</code></td>
<td><a href="#person">Person</a></td>
<td>Información del comprador en la transacción.</td>
</tr>
<tr>
<td>payment <code>Opcional</code></td>
<td><a href="#paymentrequest">PaymentRequest</a></td>
<td>Objeto de pago cuando necesite solicitar un cobro.</td>
</tr>
<tr>
<td>subscription <code>Opcional</code></td>
<td><a href="#subscriptionrequest">SubscriptionRequest</a></td>
<td>Objeto de suscripción utilizado cuando se necesita un token.</td>
</tr>
<tr>
<td>fields <code>Opcional</code></td>
<td><a href="#namevaluepair">NameValuePair[]</a></td>
<td>Información adicional relacionada con la solicitud que el comercio requiere para guardar con la transacción.</td>
</tr>
<tr>
<td>paymentMethod <code>Opcional</code></td>
<td>string</td>
<td>Forzar el medio de pago en la interfaz de redirección, los códigos aceptados son los de la lista. Si necesita más de uno separarlos con coma. <code>ej. <em>ATH</em>,<em>PSE</em>,CR_VS</code></td>
</tr>
<tr>
<td>expiration <code>Requerido</code></td>
<td>dateTime</td>
<td>Fecha de expiración de una solicitud, el usuario debe terminar el proceso antes de esta fecha. i.e. 2019-03-05T00:00:00-05:00.</td>
</tr>
<tr>
<td>returnUrl <code>Requerido</code></td>
<td>string</td>
<td>URL de retorno es utilizada para redirigir al usuario una vez termina la operación de pago.</td>
</tr>
<tr>
<td>cancelUrl</td>
<td>string</td>
<td>URL para retornar cuando el cliente aborte la operación.</td>
</tr>
<tr>
<td>ipAddress <code>Requerido</code></td>
<td>string</td>
<td>Dirección IP del usuario.</td>
</tr>
<tr>
<td>userAgent <code>Requerido</code></td>
<td>string</td>
<td>Agente de usuario informado por el usuario.</td>
</tr>
<tr>
<td>skipResult <code>Opcional</code></td>
<td>bool</td>
<td>Si se envía el parámetro como true se omite la pantalla del resultado en redirección y una vez aprobado el pago regresa al comercio automaticamente.</td>
</tr>
<tr>
<td>noBuyerFill <code>Opcional</code></td>
<td>bool</td>
<td>Por defecto se llenan los datos que se piden en redirección con los del comprador (buyer) enviados, si se envía como true se omite este autocompletado automático.</td>
</tr>
</tbody></table>

<p><strong>Retorna:</strong> <a href="#redirectresponse">RedirectResponse</a></p>
<h3 id='redirectresponse'>RedirectResponse</h3>
<blockquote>
<p>Ejemplo de una estructura RedirectResponse con respuesta aprobada en una solicitud de pago con autenticación:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"OK"</span>,
        <span class="s2">"reason"</span>: <span class="s2">"PC"</span>,
        <span class="s2">"message"</span>: <span class="s2">"La petición se ha procesado correctamente"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-03-04T16:50:02-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"requestId"</span>: 181348,
    <span class="s2">"processUrl"</span>: <span class="s2">"https://test.placetopay.com/redirection/session/181348/43d83d36aa46de5f993aafb9b3e0be48"</span>
<span class="o">}</span>
</code></pre>
<p>Estructura que contiene la respuesta inicial desde el método <a href="#createrequest">createRequest</a>. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td><a href="#status">Status</a></td>
<td>Estructura que contiene el estado de la solicitud de pago.</td>
</tr>
<tr>
<td>requestId <code>Opcional</code></td>
<td>Int</td>
<td>Referencia única de la sesión de pago.</td>
</tr>
<tr>
<td>processUrl <code>Opcional</code></td>
<td>String</td>
<td>URL donde se redirecciona al usuario para completar el proceso de pago.</td>
</tr>
</tbody></table>
<h3 id='redirectinformation'>RedirectInformation</h3>
<p>Estructura de respuesta a una solicitud para una información de transacción. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td><a href="#status">Status</a></td>
<td>Estado de esta solicitud, debe observar el estado interno de cada objeto.</td>
</tr>
<tr>
<td>request <code>Opcional</code></td>
<td><a href="#redirectrequest">RedirectRequest</a></td>
<td>Información con la solicitud original.</td>
</tr>
<tr>
<td>payment <code>Opcional</code></td>
<td><a href="#transaction">Transaction[]</a></td>
<td>Información relacionada con el pago si este fue solicitado.</td>
</tr>
<tr>
<td>subscription <code>Opcional</code></td>
<td><a href="#subscriptionresponse">SubscriptionResponse</a></td>
<td>Información relacionado con la suscripción si esta fue solicitada.</td>
</tr>
</tbody></table>
<h3 id='reverseresponse'>ReverseResponse</h3>
<p>Estructura de respuesta a una solicitud de pago reversado. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td><a href="#status">Status</a></td>
<td>Estado de la solicitud será APROBADO si se ha realizado el reverso de lo contrario puede ser RECHAZADA.</td>
</tr>
<tr>
<td>payment <code>Opcional</code></td>
<td><a href="#transaction">Transaction</a></td>
<td>Si el reverso fue exitoso, se almacena como una nueva transacción.</td>
</tr>
</tbody></table>
<h3 id='person'>Person</h3>
<p>Estructura que refleja la información de una persona involucrada en una transacción. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>documentType <code>Opcional</code></td>
<td><a href="#tipos-de-documento">DocumentType</a></td>
<td>Tipo de identificación del usuario pagador.</td>
</tr>
<tr>
<td>document</td>
<td>String</td>
<td>Identificación.</td>
</tr>
<tr>
<td>name <code>Requerido</code></td>
<td>String</td>
<td>Nombres de la persona.</td>
</tr>
<tr>
<td>surname <code>Opcional</code></td>
<td>String</td>
<td>Apellidos de la persona.</td>
</tr>
<tr>
<td>company <code>Opcional</code></td>
<td>String</td>
<td>Nombre de la empresa en la que trabaja o representa.</td>
</tr>
<tr>
<td>email <code>Requerido</code></td>
<td>String</td>
<td>Correo electrónico de la persona.</td>
</tr>
<tr>
<td>address <code>Opcional</code></td>
<td><a href="#address">Address</a></td>
<td>Información completa de la dirección.</td>
</tr>
<tr>
<td>mobile <code>Opcional</code></td>
<td><a href="#phonenumbertype">PhoneNumberType</a></td>
<td>Número celular, el <code>PhoneNumberType</code> restringe la longitud del número de teléfono de la cadena a 30 caracteres.</td>
</tr>
</tbody></table>
<h3 id='paymentrequest'>PaymentRequest</h3>
<blockquote>
<p>Ejemplo de una estructura payment para la solicitud de un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>   ...
    <span class="s2">"payment"</span>: <span class="o">{</span>
            <span class="s2">"reference"</span>: <span class="s2">"TEST_20190517_135449"</span>,
            <span class="s2">"description"</span>: <span class="s2">"Et est suscipit fugit possimus."</span>,
            <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"taxes"</span>: <span class="o">[</span>
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"ice"</span>,
                <span class="s2">"amount"</span>: 1.56,
                <span class="s2">"base"</span>: 13
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"valueAddedTax"</span>,
                <span class="s2">"amount"</span>: 2.47,
                <span class="s2">"base"</span>: 13
                <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"details"</span>: <span class="o">[</span>
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"shipping"</span>,
                <span class="s2">"amount"</span>: 0.65
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"tip"</span>,
                <span class="s2">"amount"</span>: 0.65
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"subtotal"</span>,
                <span class="s2">"amount"</span>: 13
                <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"currency"</span>: <span class="s2">"USD"</span>,
            <span class="s2">"total"</span>: 18.33
            <span class="o">}</span>,
            <span class="s2">"items"</span>: <span class="o">[</span>
            <span class="o">{</span>
                <span class="s2">"sku"</span>: 73131,
                <span class="s2">"name"</span>: <span class="s2">"Veniam quia."</span>,
                <span class="s2">"category"</span>: <span class="s2">"physical"</span>,
                <span class="s2">"qty"</span>: 1,
                <span class="s2">"price"</span>: 13,
                <span class="s2">"tax"</span>: 2.47
            <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"recurring_remove"</span>: <span class="o">{</span>
            <span class="s2">"periodicity"</span>: <span class="s2">"D"</span>,
            <span class="s2">"interval"</span>: 7,
            <span class="s2">"nextPayment"</span>: <span class="s2">"2019-05-19"</span>,
            <span class="s2">"maxPeriods"</span>: 4,
            <span class="s2">"notificationUrl"</span>: <span class="s2">"https://dnetix.co/ping/recurring_notification"</span>
            <span class="o">}</span>,
            <span class="s2">"shipping"</span>: <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"Miss Fanny Jacobson"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"Turcotte"</span>,
            <span class="s2">"email"</span>: <span class="s2">"lisandro69@yahoo.com"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
            <span class="s2">"document"</span>: <span class="s2">"8792527177"</span>,
            <span class="s2">"mobile"</span>: <span class="s2">"3006108300"</span>,
            <span class="s2">"address"</span>: <span class="o">{</span>
                <span class="s2">"street"</span>: <span class="s2">"44669 Lowe Lakes Apt. 468"</span>,
                <span class="s2">"city"</span>: <span class="s2">"Port Emileview"</span>,
                <span class="s2">"state"</span>: <span class="s2">"Antioquia"</span>,
                <span class="s2">"postalCode"</span>: <span class="s2">"00555"</span>,
                <span class="s2">"country"</span>: <span class="s2">"US"</span>,
                <span class="s2">"phone"</span>: <span class="s2">"1-868-319-9048"</span>
            <span class="o">}</span>
            <span class="o">}</span>,
            <span class="s2">"allowPartial"</span>: <span class="nb">false</span>
        <span class="o">}</span>,
        <span class="s2">"expiration"</span>: <span class="s2">"2019-05-18T13:54:49-05:00"</span>,
        <span class="s2">"ipAddress"</span>: <span class="s2">"190.85.82.130"</span>,
        <span class="s2">"userAgent"</span>: <span class="s2">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 
                      (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36"</span>,
        <span class="s2">"returnUrl"</span>: <span class="s2">"https://dnetix.co/p2p/client"</span>,
        <span class="s2">"cancelUrl"</span>: <span class="s2">"https://dnetix.co"</span>,
        <span class="s2">"skipResult"</span>: <span class="nb">false</span>,
        <span class="s2">"noBuyerFill"</span>: <span class="nb">false</span>,
        <span class="s2">"captureAddress"</span>: <span class="nb">false</span>,
        <span class="s2">"paymentMethod"</span>: null,
        <span class="s2">"fields"</span>: <span class="o">[</span>
            <span class="o">{</span>
            <span class="s2">"keyword"</span>: <span class="s2">"Redeem Code"</span>,
            <span class="s2">"value"</span>: 754100,
            <span class="s2">"displayOn"</span>: <span class="s2">"payment"</span>
            <span class="o">}</span>
        <span class="o">]</span>,
    ...
</code></pre>
<p>Estructura que contiene la información acerca del pago de la transacción requerida al servicio web. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>reference <code>Requerido</code></td>
<td>string(32)</td>
<td>Única referencia para la solicitud de pago.</td>
</tr>
<tr>
<td>description <code>Opcional</code></td>
<td>string</td>
<td>Descripción de la cuenta.</td>
</tr>
<tr>
<td>amount <code>Requerido</code></td>
<td><a href="#amount">Amount</a></td>
<td>Objeto que contiene el monto a ser cobrado.</td>
</tr>
<tr>
<td>allowPartial <code>Requerido</code></td>
<td>bool</td>
<td>Define si el monto a ser cobrado puede ser parcial.</td>
</tr>
<tr>
<td>shipping <code>Opcional</code></td>
<td><a href="#person">Person</a></td>
<td>Información de la persona quien recibe el producto o servicio en la transacción.</td>
</tr>
<tr>
<td>items <code>Opcional</code></td>
<td><a href="#items">Items</a></td>
<td>Productos relacionados con esta solicitud de pago.</td>
</tr>
<tr>
<td>fields <code>Opcional</code></td>
<td><a href="#namevaluepair">NameValuePair[]</a></td>
<td>Información adicional relacionada con la solicitud de pago que el comercio requiere guardar con la transacción.</td>
</tr>
<tr>
<td>recurring <code>Opcional</code></td>
<td><a href="#recurring">Recurring</a></td>
<td>Información recurrente cuando PlacetoPay procesa un pago recurrente.</td>
</tr>
<tr>
<td>subscribe <code>Opcional</code></td>
<td>bool</td>
<td>Permite solicitar un proceso de cobro y suscripción en la misma sesión.</td>
</tr>
</tbody></table>
<h3 id='subscriptionrequest'>SubscriptionRequest</h3>
<p>Estructura que contiene la información relacionada con una solicitud de suscripción para obtener un Token. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>reference <code>Requerido</code></td>
<td>string</td>
<td>Referencia única para la solicitud de suscripción</td>
</tr>
<tr>
<td>description <code>Opcional</code></td>
<td>string</td>
<td>Descripción de la suscripción.</td>
</tr>
<tr>
<td>fields <code>Opcional</code></td>
<td><a href="#namevaluepair">NameValuePair[]</a></td>
<td>Información adicional relacionada con la suscripción.</td>
</tr>
</tbody></table>

<p><strong>Retorna:</strong> <a href="#subscriptionresponse">SubscriptionResponse</a></p>
<h3 id='subscriptionresponse'>SubscriptionResponse</h3>
<blockquote>
<p>Ejemplo que contiene la estructura SubscriptionResponse:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>  <span class="o">{</span>
     ...
        <span class="s2">"subscription"</span>: <span class="o">{</span>
                <span class="s2">"type"</span>: <span class="s2">"token"</span>,
                <span class="s2">"status"</span>: <span class="o">{</span>
                    <span class="s2">"status"</span>: <span class="s2">"OK"</span>,
                    <span class="s2">"reason"</span>: <span class="s2">"00"</span>,
                    <span class="s2">"message"</span>: <span class="s2">"Token generado exitosamente"</span>,
                    <span class="s2">"date"</span>: <span class="s2">"2019-03-08T10:31:54-05:00"</span>
                <span class="o">}</span>,
                <span class="s2">"instrument"</span>: <span class="o">[</span>
                    <span class="o">{</span>
                        <span class="s2">"keyword"</span>: <span class="s2">"token"</span>,
                        <span class="s2">"value"</span>: <span class="s2">"1b394089c97bc5f155b684c068806d858d9e4180c8643b5b29cf216c4b656d3e"</span>,
                        <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                    <span class="o">}</span>,
     ...               
 <span class="o">}</span>
</code></pre>
<p>Estructura que contiene información para el método de pago suscripción. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td><a href="#status">Status</a></td>
<td>Estado de la suscripción.</td>
</tr>
<tr>
<td>type <code>Opcional</code></td>
<td>String</td>
<td>Esta cadena dicta el tipo de suscripción que se devuelve, puede ser [token, cuenta]</td>
</tr>
<tr>
<td>instrument <code>Opcional</code></td>
<td><a href="#namevaluepair">NameValuePair[]</a></td>
<td>Acorde con el tipo de suscripción los valore retornados puede cambiar y serán devueltos en la estructura de NameValuePair.<br><strong>token:</strong><code>[token, subtoken, franchise, <br>franchiseName, lastDigits, <br> validUntil]</code><br><strong>account:</strong> <code>[bankCode, bankName, accountType, <br>accountNumber]</code></td>
</tr>
</tbody></table>
<h3 id='namevaluepair'>NameValuePair</h3>
<blockquote>
<p>Ejemplo que contiene la estructura namevaluepair:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>     ...
            <span class="s2">"processorFields"</span>: <span class="o">[</span>
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"merchantCode"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"011271442"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"terminalNumber"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"00057742"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"lastDigits"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"1111"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"id"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"42337fd0ed2b037667ccabce3427f042"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"bin"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"411111"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"installments"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"1"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"expiration"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"0320"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"cardType"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"C"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>
            <span class="o">]</span>
    ...       
</code></pre>
<p>Se utiliza para definir un tipo de par <code>clave-valor</code> <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>keyword <code>Opcional</code></td>
<td>string</td>
<td>Clave para el par de valores del dato.</td>
</tr>
<tr>
<td>value <code>Opcional</code></td>
<td>string</td>
<td>Valor para el par de datos.</td>
</tr>
<tr>
<td>displayOn <code>Opcional</code></td>
<td>string</td>
<td>Bajo qué circunstancias el campo debe ser mostrado en la interfaz de redirección. [none, payment, receipt, both, approved]</td>
</tr>
</tbody></table>
<h3 id='status'>Status</h3>
<blockquote>
<p>Ejemplo de una estructura status con respuesta fallida en una petición de autenticación:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"FAILED"</span>,
        <span class="s2">"reason"</span>: 401,
        <span class="s2">"message"</span>: <span class="s2">"Authentication Failed 103"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-03-05T10:22:11-05:00"</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>Estructura que contiene la información de la respuesta sobre una solicitud o pago, e informa el estado actual de la misma. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td>String(32)</td>
<td><a href="#estado-de-una-peticion-o-pago">Estado de una petición o pago</a></td>
</tr>
<tr>
<td>reason <code>Requerido</code></td>
<td>String</td>
<td>Código del motivo proporcionado.</td>
</tr>
<tr>
<td>message <code>Requerido</code></td>
<td>String</td>
<td>Descripción del código de razón.</td>
</tr>
<tr>
<td>date <code>Requerido</code></td>
<td>DateTime</td>
<td>Fecha y hora en que se genera el estado de pago.</td>
</tr>
</tbody></table>
<h4 id='estado-de-una-peticion-o-pago'>Estado de una petición o pago</h4>
<blockquote>
<p>Ejemplo de un estado de una petición o pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"REJECTED"</span>,
        <span class="s2">"message"</span>: <span class="s2">""</span>,
        <span class="s2">"reason"</span>: <span class="s2">""</span>,
        <span class="s2">"date"</span>: <span class="s2">"2016-09-15T13:49:01-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"requestId"</span>: 58,
    <span class="s2">"reference"</span>: <span class="s2">"ORDER-1000"</span>,
    <span class="s2">"signature"</span>: <span class="s2">"feb3e7cc76939c346f9640573a208662f30704ab"</span>
<span class="o">}</span>
</code></pre>
<table><thead>
<tr>
<th>Estado</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td><code>OK</code></td>
<td>Petición de autenticación procesada correctamente.</td>
</tr>
<tr>
<td><code>FAILED</code></td>
<td>Fallo en una petición de autenticación.</td>
</tr>
<tr>
<td><code>APPROVED</code></td>
<td>Petición de pago o suscripción terminada</td>
</tr>
<tr>
<td><code>APPROVED_PARTIAL</code></td>
<td>Si se permite parcialmente, se ha aprobado una transacción, pero aún queda un monto.</td>
</tr>
<tr>
<td><code>PARTIAL_EXPIRED</code></td>
<td>Cuando hay un pago parcial aprobado, pero la sesión ha caducado.</td>
</tr>
<tr>
<td><code>REJECTED</code></td>
<td>Se ha declinado la transacción.</td>
</tr>
<tr>
<td><code>PENDING</code></td>
<td>Transacción pendiente para la sesión, debe estar bloqueada hasta la resolución.</td>
</tr>
<tr>
<td><code>PENDING_VALIDATION</code></td>
<td>La sesión está pendiente de validación de identidad del usuario.</td>
</tr>
<tr>
<td><code>REFUNDED</code></td>
<td>Reintegro de una transacción por solicitud de un tarjetahabiente al comercio.</td>
</tr>
</tbody></table>
<h3 id='transaction'>Transaction</h3>
<p>Estructura que contiene información sobre el proceso de pago de la transacción en PlacetoPay. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td><a href="#status">Status</a></td>
<td>Estado de la transacción.</td>
</tr>
<tr>
<td>internalReference <code>Opcional</code></td>
<td>int</td>
<td>Referencia interna en PlacetoPay.</td>
</tr>
<tr>
<td>reference <code>Opcional</code></td>
<td>string</td>
<td>Referencia enviada por el comercio para la transacción.</td>
</tr>
<tr>
<td>paymentMethod <code>Opcional</code></td>
<td>string</td>
<td>Código del método de pago utilizado.</td>
</tr>
<tr>
<td>paymentMethodName <code>Opcional</code></td>
<td>string</td>
<td>Nombre del método de pago utilizado.</td>
</tr>
<tr>
<td>issuerName <code>Opcional</code></td>
<td>string</td>
<td>Nombre del emisor o del procesador.</td>
</tr>
<tr>
<td>amount <code>Opcional</code></td>
<td><a href="#amountconversion">AmountConversion</a></td>
<td>Valor procesado.</td>
</tr>
<tr>
<td>receipt <code>Opcional</code></td>
<td>string</td>
<td>Numero de recibo de la transacción.</td>
</tr>
<tr>
<td>franchise <code>Opcional</code></td>
<td>string</td>
<td>Franquicia de la tarjeta utilizada.</td>
</tr>
<tr>
<td>refunded <code>Opcional</code></td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>authorization <code>Opcional</code></td>
<td>string</td>
<td>Código de autorización.</td>
</tr>
<tr>
<td>processorFields <code>Opcional</code></td>
<td><a href="#namevaluepair">NameValuePair[]</a></td>
<td>Campos adicionales del procesador.</td>
</tr>
</tbody></table>
<h3 id='token'>Token</h3>
<p>Estructura que contiene información acerca de un token usado para cobros de un cliente suscrito. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status <code>Requerido</code></td>
<td><a href="#status">Status</a></td>
<td>Estado del proceso de tokenización.</td>
</tr>
<tr>
<td>token <code>Opcional</code></td>
<td>string</td>
<td>Token completo para tarjeta de crédito, debe ser usada para solicitar cualquier transacción a PlacetoPay.</td>
</tr>
<tr>
<td>subtoken <code>Opcional</code></td>
<td>string</td>
<td>Representación numérica del token para casos donde es requerido un número adicional que parece como una tarjeta de crédito, los últimos 4 dígitos son iguales a los últimos 4 dígitos de la tarjeta de crédito.</td>
</tr>
<tr>
<td>franchiseName <code>Opcional</code></td>
<td>string</td>
<td>Franquicia de la tarjeta tokenizada.</td>
</tr>
<tr>
<td>issuerName <code>Opcional</code></td>
<td>string</td>
<td>Nombre del banco emisor.</td>
</tr>
<tr>
<td>lastDigits <code>Opcional</code></td>
<td>string</td>
<td>Últimos 4 dígitos de la tarjeta de crédito.</td>
</tr>
<tr>
<td>validUntil <code>Opcional</code></td>
<td>date</td>
<td>Fecha hasta la cual el token es válido, puede  ser determinada por la  fecha de expiración.</td>
</tr>
</tbody></table>
<h3 id='documenttype'>DocumentType</h3>
<p>Contiene los diferentes tipos de documento, cadena (string) (ver listado)</p>
<h3 id='address'>Address</h3>
<p>Estructura que contiene la información sobre una dirección física. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>street <code>Requerido</code></td>
<td>string</td>
<td>Dirección física completa.</td>
</tr>
<tr>
<td>city <code>Requerido</code></td>
<td>string</td>
<td>Nombre de la ciudad.</td>
</tr>
<tr>
<td>state <code>Opcional</code></td>
<td>string</td>
<td>Nombre del estado coincidente con la dirección.</td>
</tr>
<tr>
<td>postalCode <code>Opcional</code></td>
<td>string</td>
<td>Código postal o equivalente se requiere generalmente para los países que tienen.</td>
</tr>
<tr>
<td>country <code>Opcional</code></td>
<td>string</td>
<td>Código internacional del país que se aplica a la dirección física según  <a href="https://es.wikipedia.org/wiki/ISO_3166-1">ISO 3166-1</a> ALPHA-2.</td>
</tr>
<tr>
<td>phone <code>Opcional</code></td>
<td><a href="#phonenumbertype">PhoneNumberType</a></td>
<td>Número telefónico.</td>
</tr>
</tbody></table>
<h3 id='phonenumbertype'>PhoneNumberType</h3>
<p>Restringe la longitud del número de teléfono de la cadena a 30 caracteres.</p>
<h3 id='amount'>Amount</h3>
<blockquote>
<p>Ejemplo de una estructura amount para un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  ...
         <span class="s2">"amount"</span>: <span class="o">{</span>
           <span class="s2">"taxes"</span>: <span class="o">[</span>
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"ice"</span>,
                <span class="s2">"amount"</span>: 1.56,
                <span class="s2">"base"</span>: 13
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"valueAddedTax"</span>,
                <span class="s2">"amount"</span>: 2.47,
                <span class="s2">"base"</span>: 13
                <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"details"</span>: <span class="o">[</span>
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"shipping"</span>,
                <span class="s2">"amount"</span>: 0.65
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"tip"</span>,
                <span class="s2">"amount"</span>: 0.65
                <span class="o">}</span>,
                <span class="o">{</span>
                <span class="s2">"kind"</span>: <span class="s2">"subtotal"</span>,
                <span class="s2">"amount"</span>: 13
                <span class="o">}</span>
            <span class="o">]</span>,
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>
  ...     
<span class="o">}</span>
</code></pre>
<p>Extiende de AmountBase y describe el contenido del valor total, incluyendo impuestos y detalles. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>currency <code>Requerido</code></td>
<td>String</td>
<td>De amountBase. Permite identificar la moneda en que se va realizar un pago, acorde al <a href="https://www.currency-iso.org/dam/downloads/lists/list_one.xml">ISO 4217</a> (Alphabetic).</td>
</tr>
<tr>
<td>total <code>Requerido</code></td>
<td>Decimal</td>
<td>De amountBase. Permite identificar el monto total que se va a pagar.</td>
</tr>
<tr>
<td>taxes <code>Opcional</code></td>
<td><a href="#taxdetail">TaxDetail[]</a></td>
<td>Descripción de los impuestos.</td>
</tr>
<tr>
<td>details <code>Opcional</code></td>
<td><a href="#amountdetail">AmountDetail[]</a></td>
<td>Descripción del importe total.</td>
</tr>
</tbody></table>
<h3 id='taxdetail'>TaxDetail</h3>
<p>Estructura para almacenar información sobre un impuesto. <br><br></p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>kind <code>Requerido</code></td>
<td>string</td>
<td>Valor de clasificación, puede ser <code>[valueAddedTax, exciseDuty]</code>.</td>
</tr>
<tr>
<td>amount <code>Requerido</code></td>
<td><a href="#amounttype">AmountType</a></td>
<td>Valor discriminado.</td>
</tr>
</tbody></table>
<h3 id='amountdetail'>AmountDetail</h3>
<p>Estructura para almacenar información sobre el valor. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>kind <code>Requerido</code></td>
<td>string</td>
<td>Valor de clasificación, puede ser <code>[discount, additional, <br> vatDevolutionBase, shipping, <br> handlingFee, insurance, <br> giftWrap, subtotal, fee, tip]</code>.</td>
</tr>
<tr>
<td>amount <code>Requerido</code></td>
<td><a href="#amounttype">AmountType</a></td>
<td>Valor discriminado.</td>
</tr>
</tbody></table>
<h3 id='amounttype'>AmountType</h3>
<p>Representación decimal del valor.</p>
<h3 id='recurring'>Recurring</h3>
<p>Estructura que contiene la información requerida para una solicitud de pago recurrente. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>periodicity <code>Requerido</code></td>
<td>string</td>
<td>Periodicidad de la factura <code>[D, M, Y]</code></td>
</tr>
<tr>
<td>interval <code>Requerido</code></td>
<td>int</td>
<td>Intervalo asociado a la periodicidad.</td>
</tr>
<tr>
<td>nextPayment <code>Requerido</code></td>
<td>date</td>
<td>Fecha del próximo pago.</td>
</tr>
<tr>
<td>maxPeriods <code>Requerido</code></td>
<td>int</td>
<td>Número máximo de periodo (-1 en caso de que no haya  restricción.)</td>
</tr>
<tr>
<td>dueDate <code>Opcional</code></td>
<td>date</td>
<td>Fecha para finalizar el pago.</td>
</tr>
<tr>
<td>notificationUrl <code>Opcional</code></td>
<td>string</td>
<td>URL en el que el servicio notificará cada vez que se haga un pago recurrente.</td>
</tr>
</tbody></table>
<h3 id='amountconversion'>AmountConversion</h3>
<p>Estructura para definir el factor de conversión y los valores. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>from <code>Requerido</code></td>
<td><a href="#amountbase">AmountBase</a></td>
<td>Monto solicitado.</td>
</tr>
<tr>
<td>to <code>Requerido</code></td>
<td><a href="#amountbase">AmountBase</a></td>
<td>Monto procesado por la entidad.</td>
</tr>
<tr>
<td>factor <code>Requerido</code></td>
<td>double</td>
<td>Factor de conversión.</td>
</tr>
</tbody></table>
<h3 id='amountbase'>AmountBase</h3>
<p>Estructura que representa una cantidad que define la moneda y el total. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>currency <code>Requerido</code></td>
<td>string</td>
<td>Moneda acorde al <a href="https://www.currency-iso.org/dam/downloads/lists/list_one.xml">ISO 4217</a> <code>(alphabetic code)</code>.</td>
</tr>
<tr>
<td>total <code>Requerido</code></td>
<td>decimal</td>
<td>Valor total.</td>
</tr>
</tbody></table>
<h3 id='collectrequest'>CollectRequest</h3>
<blockquote>
<p>Ejemplo para recaudar un pago utilizando la estructura CollecRequest</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/collect
<span class="o">{</span>
    <span class="s2">"auth"</span>: <span class="o">{</span>
        <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
        <span class="s2">"tranKey"</span>: <span class="s2">"YhmdBEZKTMAFsxkI1SrgS4SdBfE="</span>,
        <span class="s2">"nonce"</span>: <span class="s2">"TlRoaE0yWTROMk0wWVRFellXUTVNVFUwWVRZNVpHRXpZbU16TWpJM01UWT0="</span>,
        <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
  <span class="o">}</span>,
    <span class="s2">"instrument"</span>: <span class="o">{</span>
        <span class="s2">"token"</span>: <span class="o">{</span>
            <span class="s2">"token"</span>: <span class="s2">"1b394089c97bc5f155b684c068806d858d9e4180c8643b5b29cf216c4b656d3e"</span>
        <span class="o">}</span>
    <span class="o">}</span>,
    <span class="s2">"payer"</span>: <span class="o">{</span>
            <span class="s2">"document"</span>: <span class="s2">"911111111"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
            <span class="s2">"name"</span>: <span class="s2">"Prueba aliado"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"JA"</span>,
            <span class="s2">"email"</span>: <span class="s2">"juan.jimenez@placetopay.com"</span>
    <span class="o">}</span>,
    <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3110"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago con suscripción 3110"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>:10000
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>Permite realizar cobros sin la intervención del usuario usando medios de pago previamente suscritos. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>payer <code>Requerido</code></td>
<td><a href="#person">Person</a></td>
<td>Datos del titular del medio de pago almacenado.</td>
</tr>
<tr>
<td>payment <code>Requerido</code></td>
<td><a href="#paymentrequest">PaymentRequest</a></td>
<td>Objeto de pago cuando necesite solicitar un cobro.</td>
</tr>
<tr>
<td>instrument <code>Requerido</code></td>
<td><a href="#instrument">Instrument</a></td>
<td>Datos asociados al medio de pago suscrito.</td>
</tr>
</tbody></table>
<h3 id='items'>Items</h3>
<p>Posee una colección de estructuras de elementos. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>item <code>Opcional</code></td>
<td><a href="#item">Item[]</a></td>
<td>Arreglo de un elemento incluido.</td>
</tr>
</tbody></table>
<h3 id='item'>Item</h3>
<p>Estructura que contiene los detalles del elemento. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>sku <code>Requerido</code></td>
<td>string</td>
<td>Unidad en stock correspondiente (SKU) al artículo.</td>
</tr>
<tr>
<td>name <code>Opcional</code></td>
<td>string</td>
<td>Nombre del artículo.</td>
</tr>
<tr>
<td>category <code>Opcional</code></td>
<td>string</td>
<td>Puede ser [digital, physical].</td>
</tr>
<tr>
<td>qty <code>Opcional</code></td>
<td>string</td>
<td>Número de un artículo en particular.</td>
</tr>
<tr>
<td>price <code>Opcional</code></td>
<td>decimal</td>
<td>Costo del artículo.</td>
</tr>
<tr>
<td>tax <code>Opcional</code></td>
<td>decimal</td>
<td>Impuesto del artículo.</td>
</tr>
</tbody></table>
<h3 id='instrument'>Instrument</h3>
<blockquote>
<p>Ejemplo que contiene una estructura instrument:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>   <span class="o">{</span>
     ...
        <span class="s2">"instrument"</span>: <span class="o">{</span>
           <span class="s2">"token"</span>: <span class="o">{</span>
               <span class="s2">"token"</span>: <span class="s2">"1b394089c97bc5f155b684c068806d858d9e4180c8643b5b29cf216c4b656d3e"</span>
            <span class="o">}</span>
       <span class="o">}</span>,
     ...               
    <span class="o">}</span>
</code></pre>
<p>Estructura que contiene los detalles de un medio de pago suscrito. <br><br></p>

<p>ATRIBUTO</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>token <code>Requerido</code></td>
<td><a href="#simpletoken">SimpleToken</a></td>
<td>Datos asociados a una tarjeta de crédito tokenizada.</td>
</tr>
</tbody></table>
<h3 id='simpletoken'>SimpleToken</h3>
<p>Estructura que contiene los detalles de un token previamente obtenido mediante un proceso de suscripción, se debe enviar el token o el subtoken en los casos que se habilite, no es necesario enviar ambos. <br><br></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>token <code>Opcional</code></td>
<td>string</td>
<td>Token completo para tarjeta de crédito, debe ser usada para solicitar cualquier transacción a PlacetoPay.</td>
</tr>
<tr>
<td>subtoken <code>Opcional</code></td>
<td>string</td>
<td>Representación numérica del Token para casos donde es requerido un número adicional que parece como una tarjeta de crédito, los últimos 4 dígitos son iguales a los últimos 4 dígitos de la tarjeta de crédito.</td>
</tr>
<tr>
<td>installments <code>Opcional</code></td>
<td>int</td>
<td>Número de cuotas en las cuales se solicita el cobro (opcional).</td>
</tr>
<tr>
<td>cvv <code>Opcional</code></td>
<td>string</td>
<td>Dígitos del código de seguridad de la tarjeta a usar en los casos en los que sea necesario, generalmente se deja en blanco si se tiene una terminal sin validación de CVV.</td>
</tr>
</tbody></table>
<h2 id='pagos'>Pagos</h2>
<blockquote>
<p>Ejemplo para la petición de un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/session

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"jsHJzM3+XG754wXh+aBvi70D9/4="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"TTJSa05UVmtNR000TlRrM1pqQTRNV1EREprWkRVMU9EZz0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
  <span class="o">}</span>,

    <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago de prueba 04032019"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>
      <span class="o">}</span>,

    <span class="s2">"expiration"</span>: <span class="s2">"2019-03-05T00:00:00-05:00"</span>,
    <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3210"</span>,
    <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
    <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>
<span class="o">}</span>
</code></pre>
<p>Cuando el usuario selecciona pagar en tu sitio, inicia el flujo del servicio Web Checkout, donde su sitio envía al EndPoint de procesamiento mediante el método POST los parámetros necesarios para crear la sesión de pago.</p>

<p>En la estructura se deben tener en cuenta algunos parámetros para consumir el método <a href="#createrequest">CreateRequest</a> los cuales están contenidos en la estructura de <a href="#autenticacion">Autenticación</a> y la estructura <a href="#redirectrequest">RedirectRequest</a>.</p>

<blockquote>
<p>Ejemplo de una estructura payment para un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
...
    <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago de prueba 04032019"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>
      <span class="o">}</span>,
...
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Ejemplo de una estructura amount para un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  ...
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>
  ...     
<span class="o">}</span>
</code></pre>
<aside class="notice">
En el returnUrl se recomienda enviar en la URL un dato con el cual el sitio pueda identificar el registro por ejemplo: <code>https://mysite.com/response/{reference}</code>.
</aside>

<ul>
<li>Al recibir la respuesta del <a href="#redirectresponse">redirectResponse</a>, esta debe ser almacenada en su sistema. La operación debe quedar marcada como pendiente. <br></li>
<li>Luego de almacenar la respuesta de la operación, el sitio debe redireccionar al usuario sobre la misma pestaña a la interfaz de la sesión en Web Checkout (processUrl) donde debe ingresar la información para procesar el pago:</li>
<li>Posteriormente el usuario debe seleccionar el medio de pago con el que va realizar la compra.</li>
<li>Finalmente el usuario ingresa los datos del medio de pago:</li>
<li>El servicio Web Checkout procesa la operación y retorna a su sistema <code>(returnUrl)</code>. </li>
<li>Su sistema <a href="#consulta">consulta</a> la información de la sesión.</li>
<li>Su sistema almacena los datos necesarios obtenidos en la respuesta de la sesión.</li>
<li>Su sistema presenta al usuario la información de la operación.</li>
</ul>

<aside class="notice">
En caso que la operación quede pendiente, el servicio notificará de forma asíncrona a la URL de notificación una vez sea resuelta (Apruebe o decline)
</aside>
<h3 id='pago-mixto'>Pago mixto</h3>
<blockquote>
<p>Ejemplo de una petición para un pago mixto.</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/session

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"jsHJzM3+XG754wXh+aBvi70D9/4="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"TTJSa05UVmtNR000TlRrM1pqQTRNV1EREprWkRVMU9EZz0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
  <span class="o">}</span>,

   <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago mixto de prueba"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>,
        <span class="s2">"allowPartial"</span>: <span class="nb">true</span>
    <span class="o">}</span>,

    <span class="s2">"expiration"</span>: <span class="s2">"2019-03-05T00:00:00-05:00"</span>,
    <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3210"</span>,
    <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
    <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Ejemplo aprobación  de una transacción para un pago mixto:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    ...
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"APPROVED"</span>,
        <span class="s2">"reason"</span>: <span class="s2">"P0"</span>,
        <span class="s2">"message"</span>: <span class="s2">"La petición está parcialmente aprobada"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-04-01T11:13:27-05:00"</span>
    <span class="o">}</span>,
    ...
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Ejemplo aprobación parcial de una transacción para un pago mixto:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    ...
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"APPROVED_PARTIAL"</span>,
        <span class="s2">"reason"</span>: <span class="s2">"P0"</span>,
        <span class="s2">"message"</span>: <span class="s2">"La petición está parcialmente aprobada"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-04-01T11:13:27-05:00"</span>
    <span class="o">}</span>,
    ...
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Ejemplo de un pago mixto con saldo pendiente y el tiempo de expiración finalizado:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    ...
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"PARTIAL_EXPIRED"</span>,
        <span class="s2">"reason"</span>: <span class="s2">"PX"</span>,
        <span class="s2">"message"</span>: <span class="s2">"La petición está expirada o cancelada y se han realizado pagos"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-04-01T11:15:38-05:00"</span>
    <span class="o">}</span>,
    ...
<span class="o">}</span>
</code></pre>
<p>El pago mixto permite utilizar varios medios de pago al momento de pagar para una misma sesión.</p>

<p>Para hacer uso de esta funcionalidad, en la estructura <code><a href="#paymentrequest">payment</a></code> del <a href="#pagos">Pago</a> es necesario 
enviar el atributo <code>allowPartial</code> como: <code>TRUE</code>.</p>

<p><strong>Estados adicionales de una sesión de pago mixto</strong></p>

<p>Al obtener el resultado de la operación, debe tener muy presente los siguiente dos estados:</p>

<ul>
<li><code>APPROVED_PARTIAL:</code> Indica que se realiza al menos un pago aprobado pero no se realizado el pago total de la sesión.</li>
<li><code>PARTIAL_EXPIRED:</code> Indica que se realiza al menos un pago aprobado pero no se completó el pago total de la sesión y ésta expiró.</li>
</ul>

<aside class="notice">
 Es importante identificar según la regla de negocio del sitio al obtener alguno de estos dos estados.
</aside>
<h3 id='pago-recurrente'>Pago Recurrente</h3>
<blockquote>
<p>Ejemplo petición para un pago recurrente:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/session

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"jsHJzM3+XG754wXh+aBvi70D9/4="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"TTJSa05UVmtNR000TlRrM1pqQTRNV1EREprWkRVMU9EZz0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
    <span class="o">}</span>,
    <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago recurrente de prueba"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>: <span class="s2">"10000"</span>
        <span class="o">}</span>,
        <span class="s2">"recurring"</span>: <span class="o">{</span>
            <span class="s2">"periodicity"</span>: <span class="s2">"M"</span>,
            <span class="s2">"interval"</span>: <span class="s2">"1"</span>,
            <span class="s2">"nextPayment"</span>: <span class="s2">"2019-04-04"</span>,
            <span class="s2">"maxPeriods"</span>: <span class="s2">"12"</span>
        <span class="o">}</span>
    <span class="o">}</span>,
    <span class="s2">"expiration"</span>: <span class="s2">"2019-03-05T00:00:00-05:00"</span>,
    <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3210"</span>,
    <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
    <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>
<span class="o">}</span>
</code></pre>
<p>Es un cobro periódico realizado por PlacetoPay para un  <strong>mismo valor</strong> con un intervalo (diario, mensual, anual) según la indicación dada en la petición.</p>

<p>Para hacer uso de esta funcionalidad, en la estructura <code><a href="#paymentrequest">payment</a></code> del Pago recurrente es necesario enviar en el objeto <code> <a href="#recurring">recurring</a></code> los datos obligatorios para esta estructura, los cuales puede visualizar en la sesión de <a href="#campos-usados-por-tipo-de-operacion">Campos usados por tipo de operación</a>.</p>

<aside class="notice">
Los cobros recurrentes sólo se realizarán en el caso que  la transacción inicial sea aprobada.
</aside>

<aside class="notice">
En el caso de fallar un cobro recurrente, éste seguirá reintentado cada día durante N días, si luego del número máximo de reintentos no se obtiene una transacción aprobada, la recurrencia se cancela.
</aside>

<aside class="notice">
Las recurrencias sólo pueden ser canceladas en la consola administrativa de PlacetoPay.
</aside>
<h3 id='suscripcion'>Suscripción</h3>
<blockquote>
<p>Ejemplo petición para una suscripción:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
   <span class="s2">"auth"</span>:| <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"jsHJzM3+XG754wXh+aBvi70D9/4="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"TTJSa05UVmtNR000TlRrM1pqQTRNV1EREprWkRVMU9EZz0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
    <span class="o">}</span>,
    <span class="s2">"subscription"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3110"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Una suscripción de prueba"</span>
    <span class="o">}</span>,
    <span class="s2">"expiration"</span>: <span class="s2">"2019-08-02T00:00:00-05:00"</span>,
    <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3210"</span>,
    <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
    <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>
<span class="o">}</span>
</code></pre>
<p>La suscripción permite almacenar de forma segura (tokenizando) el medio de pago de un usuario, para que luego pueda efectuar cobros relacionados a este mismo.</p>

<p>Para hacer uso de esta funcionalidad es necesario enviar en el <a href="#redirectrequest">RedirectRequest</a> la estructura <code>subscription</code>.</p>

<p>Estructura que se utilizan para el método de pago con suscripción.</p>

<ul>
<li><a href="#subscriptionresponse">SubscriptionResponse</a></li>
<li><a href="#collectrequest">CollectRequest</a></li>
<li><a href="#namevaluepair">NameValuePair</a></li>
<li><a href="#token">Token</a></li>
<li><a href="#person">Person</a></li>
<li><a href="#instrument">Instrument</a></li>
</ul>

<aside class="notice">
Se recomienda realizar un cobro por un valor mínimo para identificar que la tarjeta se encuentra activa.
</aside>

<aside class="notice">
La información del token debe ser almacenada en su sitio y relacionada al usuario y/o producto.
Luego de tener el token, puede generar cobros al medio de pago tokenizado usando el servicio <a href="#collect">collect</a>.
</aside>

<p>La estructura de la respuesta contiene toda la información de la petición original y una estructura de suscripción <code>(subscription)</code> con un instrumento <code>(instrument)</code> representado en forma de <strong>token</strong>. <a href="#consulta">Ver Ejemplo de respuesta de una suscripción</a>.</p>
<h4 id='recaudar-usando-suscripcion'>Recaudar usando suscripción</h4>
<blockquote>
<p>Ejemplo para recaudar un pago con suscripción</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/collect
<span class="o">{</span>
    <span class="s2">"auth"</span>: <span class="o">{</span>
        <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
        <span class="s2">"tranKey"</span>: <span class="s2">"YhmdBEZKTMAFsxkI1SrgS4SdBfE="</span>,
        <span class="s2">"nonce"</span>: <span class="s2">"TlRoaE0yWTROMk0wWVRFellXUTVNVFUwWVRZNVpHRXpZbU16TWpJM01UWT0="</span>,
        <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
  <span class="o">}</span>,
    <span class="s2">"instrument"</span>: <span class="o">{</span>
        <span class="s2">"token"</span>: <span class="o">{</span>
            <span class="s2">"token"</span>: <span class="s2">"1b394089c97bc5f155b684c068806d858d9e4180c8643b5b29cf216c4b656d3e"</span>
        <span class="o">}</span>
    <span class="o">}</span>,
    <span class="s2">"payer"</span>: <span class="o">{</span>
            <span class="s2">"document"</span>: <span class="s2">"911111111"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
            <span class="s2">"name"</span>: <span class="s2">"Prueba aliado"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"JA"</span>,
            <span class="s2">"email"</span>: <span class="s2">"juan.jimenez@placetopay.com"</span>
    <span class="o">}</span>,
    <span class="s2">"payment"</span>: <span class="o">{</span>
        <span class="s2">"reference"</span>: <span class="s2">"3110"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Pago con suscripción 3110"</span>,
        <span class="s2">"amount"</span>: <span class="o">{</span>
            <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
            <span class="s2">"total"</span>:10000
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>Para realizar el cobro de una suscripción es necesario usar el método <a href="#collect">Collet</a> enviando el token obtenido en ésta.</p>

<p>Importante: Este proceso no necesita la intervención del usuario.</p>

<aside class="notice">
Los cobros  se deben realizar en los tiempos acordados con el usuario al momento de la suscripción
</aside>
<h4 id='pago-recurrente-vs-suscripcion'>Pago recurrente vs Suscripción</h4>
<p>Las principales diferencias entre estas dos funcionalidades son:</p>

<ul>
<li>El pago es ejecutado por PlacetoPay mientras que la suscripción es ejecutada por su sitio. </li>
<li>En un pago recurrente ya creado no se puede modificar los intervalos de tiempo para el cobro ni el monto, mientras que en suscripción la información puede variar dependiendo de cómo envíe la solicitud en el collect.</li>
<li>Para eliminar la recurrencia de un pago debe hacerse por la consola administrativa de PlacetoPay, mientras que en suscripción debe invalidar o eliminar de sus sistema el token obtenido.</li>
</ul>

<aside class="notice">
Si el usuario retorna al comercio, este debe consultar la información de la transacción usando el identificador único <code>requestId</code> generado.
</aside>
<h2 id='notificacion'>Notificación</h2>
<blockquote>
<p>Ejemplo de notificación para el estado de una sesión:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"APPROVED"</span>,
        <span class="s2">"message"</span>: <span class="s2">""</span>,
        <span class="s2">"reason"</span>: <span class="s2">""</span>,
        <span class="s2">"date"</span>: <span class="s2">"2016-09-15T13:49:01-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"requestId"</span>: 58,
    <span class="s2">"reference"</span>: <span class="s2">"ORDER-1000"</span>,
    <span class="s2">"signature"</span>: <span class="s2">"feb3e7cc76939c346f9640573a208662f30704ab"</span>
<span class="o">}</span>
</code></pre>
<p>Una notificación permite informar al comercio sobre el estado de las sesiones.</p>

<p>Configura en tu servidor una URL de notificación usando los puertos <code>80</code> o <code>443</code> y en caso de que la sesión se cancele o apruebe, reciba una notificación mediante POST.</p>

<table><thead>
<tr>
<th>Parametro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>requestId <code>Requerido</code></td>
<td>Int</td>
<td>Identificador único de la sesión.</td>
</tr>
<tr>
<td>reference <code>Requerido</code></td>
<td>String</td>
<td>Reeferencia que acompañada con el <code>requestId</code> permite identificar la sesión de pago afectada.</td>
</tr>
<tr>
<td>signature <code>Requerido</code></td>
<td>String</td>
<td>Firma que permite validar la petición recibida.</td>
</tr>
</tbody></table>

<p>De manera asincrónica, una notificación del estado de la petición será enviada a una URL definida por configuración del comercio en PlacetoPay.</p>

<p>Al recibir la  notificación su sitio debe:</p>

<p><strong>Identificar operación:</strong> <br>
Con el identificador de la sesión <code>requestId</code> y la referencia <code>reference</code> identifican la sesión notificada.
Para esta sesión debe validar que el estado de la operación notificada están pendientes en su sistema.</p>

<p><strong>Validar autenticidad de la notificación:</strong> <br>
Puedes validar que se trate de una respuesta de PlacetoPay haciendo un SHA-1 con los datos <code>requestId + status + date + secretKey</code>.</p>

<p>Si este valor coincide con el valor proporcionado por el <code>signature</code>, puedes autenticar la respuesta y proceder a asentar en la base de datos.</p>

<aside class="warning">Bajo ninguna circunstancia reveles tu <code>secretKey</code> en ninguna parte accesible a los clientes o usuarios de su aplicación.
</aside>

<aside class="success">Luego de obtener el estado de la sesión, puede continuar con la regla de negocio de su sitio. (ejemplo: si la operación es aprobada, envía un correo electrónico al usuario).
</aside>
<h2 id='consulta'>Consulta</h2>
<blockquote>
<p>Ejemplo de la petición de consulta de la información de una transacción:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>POST /api/session/181348

<span class="o">{</span>
  <span class="s2">"auth"</span>: <span class="o">{</span>
    <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
    <span class="s2">"tranKey"</span>: <span class="s2">"NBV2D/QzFUMQi3G/bvkie/HMjdM="</span>,
    <span class="s2">"nonce"</span>: <span class="s2">"WXpVME1tTXlNR1l3TVRJM01XUTJNREJqWlRGaU9Ua3hPVE0wT1dReU9EQT0="</span>,
    <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Ejemplo respuesta consulta de un pago:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"requestId"</span>: 181348,
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"APPROVED"</span>,
        <span class="s2">"reason"</span>: <span class="s2">"00"</span>,
        <span class="s2">"message"</span>: <span class="s2">"La petición ha sido aprobada exitosamente"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-03-04T17:27:59-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"request"</span>: <span class="o">{</span>
        <span class="s2">"locale"</span>: <span class="s2">"es_CO"</span>,
        <span class="s2">"payer"</span>: <span class="o">{</span>
            <span class="s2">"document"</span>: <span class="s2">"98762729"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CE"</span>,
            <span class="s2">"name"</span>: <span class="s2">"JD"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"JA"</span>,
            <span class="s2">"email"</span>: <span class="s2">"juan.jimenez@placetopay.com"</span>,
            <span class="s2">"mobile"</span>: <span class="s2">"321000000"</span>
        <span class="o">}</span>,
        <span class="s2">"payment"</span>: <span class="o">{</span>
            <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
            <span class="s2">"description"</span>: <span class="s2">"Pago de prueba 04/03/2019"</span>,
            <span class="s2">"amount"</span>: <span class="o">{</span>
                <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
                <span class="s2">"total"</span>: <span class="s2">"10000"</span>
            <span class="o">}</span>,
            <span class="s2">"allowPartial"</span>: <span class="nb">false</span>,
            <span class="s2">"subscribe"</span>: <span class="nb">false</span>
        <span class="o">}</span>,
        <span class="s2">"fields"</span>: <span class="o">[</span>
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"_processUrl_"</span>,
                <span class="s2">"value"</span>: <span class="s2">"https://test.placetopay.com/redirection/session/181348/43d83d36aa46de5f993aafb9b3e0be48"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>
        <span class="o">]</span>,
        <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3210"</span>,
        <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
        <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>,
        <span class="s2">"expiration"</span>: <span class="s2">"2019-03-05T00:00:00-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"payment"</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">"status"</span>: <span class="o">{</span>
                <span class="s2">"status"</span>: <span class="s2">"APPROVED"</span>,
                <span class="s2">"reason"</span>: <span class="s2">"00"</span>,
                <span class="s2">"message"</span>: <span class="s2">"Aprobada"</span>,
                <span class="s2">"date"</span>: <span class="s2">"2019-03-04T17:05:00-05:00"</span>
            <span class="o">}</span>,
            <span class="s2">"internalReference"</span>: 1468647381,
            <span class="s2">"paymentMethod"</span>: <span class="s2">"card"</span>,
            <span class="s2">"paymentMethodName"</span>: <span class="s2">"Visa"</span>,
            <span class="s2">"issuerName"</span>: <span class="s2">"BANCO DE PRUEBAS"</span>,
            <span class="s2">"amount"</span>: <span class="o">{</span>
                <span class="s2">"from"</span>: <span class="o">{</span>
                    <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
                    <span class="s2">"total"</span>: <span class="s2">"10000.00"</span>
                <span class="o">}</span>,
                <span class="s2">"to"</span>: <span class="o">{</span>
                    <span class="s2">"currency"</span>: <span class="s2">"COP"</span>,
                    <span class="s2">"total"</span>: <span class="s2">"9800.00"</span>
                <span class="o">}</span>,
                <span class="s2">"factor"</span>: 1
            <span class="o">}</span>,
            <span class="s2">"authorization"</span>: <span class="s2">"000000"</span>,
            <span class="s2">"reference"</span>: <span class="s2">"3210"</span>,
            <span class="s2">"receipt"</span>: <span class="s2">"1551737100"</span>,
            <span class="s2">"franchise"</span>: <span class="s2">"CR_VS"</span>,
            <span class="s2">"refunded"</span>: <span class="nb">false</span>,
            <span class="s2">"discount"</span>: <span class="o">{</span>
                <span class="s2">"code"</span>: <span class="s2">"DEMO_PROMOVISA"</span>,
                <span class="s2">"type"</span>: <span class="s2">"MERCHANT"</span>,
                <span class="s2">"amount"</span>: <span class="s2">"200"</span>,
                <span class="s2">"base"</span>: <span class="s2">"10000"</span>,
                <span class="s2">"percent"</span>: 2
            <span class="o">}</span>,
            <span class="s2">"processorFields"</span>: <span class="o">[</span>
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"merchantCode"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"011271442"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"terminalNumber"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"00057742"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"lastDigits"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"1111"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"id"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"42337fd0ed2b037667ccabce3427f042"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"installments"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"1"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"expiration"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"0320"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>,
                <span class="o">{</span>
                    <span class="s2">"keyword"</span>: <span class="s2">"cardType"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"C"</span>,
                    <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
                <span class="o">}</span>
            <span class="o">]</span>
        <span class="o">}</span>
    <span class="o">]</span>,
    <span class="s2">"subscription"</span>: null
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Ejemplo de respuesta de una suscripción:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
    <span class="s2">"requestId"</span>: 183064,
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"status"</span>: <span class="s2">"APPROVED"</span>,
        <span class="s2">"reason"</span>: <span class="s2">"00"</span>,
        <span class="s2">"message"</span>: <span class="s2">"La petición ha sido aprobada exitosamente"</span>,
        <span class="s2">"date"</span>: <span class="s2">"2019-03-08T10:33:09-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"request"</span>: <span class="o">{</span>
        <span class="s2">"locale"</span>: <span class="s2">"es_CO"</span>,
        <span class="s2">"payer"</span>: <span class="o">{</span>
            <span class="s2">"document"</span>: <span class="s2">"911111111"</span>,
            <span class="s2">"documentType"</span>: <span class="s2">"CC"</span>,
            <span class="s2">"name"</span>: <span class="s2">"Prueba aliado"</span>,
            <span class="s2">"surname"</span>: <span class="s2">"JA"</span>,
            <span class="s2">"email"</span>: <span class="s2">"juan.jimenez@placetopay.com"</span>,
            <span class="s2">"mobile"</span>: <span class="s2">"321000000"</span>
        <span class="o">}</span>,
        <span class="s2">"subscription"</span>: <span class="o">{</span>
            <span class="s2">"reference"</span>: <span class="s2">"3110"</span>,
            <span class="s2">"description"</span>: <span class="s2">"Una suscripción de prueba"</span>
        <span class="o">}</span>,
        <span class="s2">"returnUrl"</span>: <span class="s2">"https://mysite.com/response/3110"</span>,
        <span class="s2">"ipAddress"</span>: <span class="s2">"127.0.0.1"</span>,
        <span class="s2">"userAgent"</span>: <span class="s2">"PlacetoPay Sandbox"</span>,
        <span class="s2">"expiration"</span>: <span class="s2">"2019-04-09T00:00:00-05:00"</span>
    <span class="o">}</span>,
    <span class="s2">"payment"</span>: null,
    <span class="s2">"subscription"</span>: <span class="o">{</span>
        <span class="s2">"type"</span>: <span class="s2">"token"</span>,
        <span class="s2">"status"</span>: <span class="o">{</span>
            <span class="s2">"status"</span>: <span class="s2">"OK"</span>,
            <span class="s2">"reason"</span>: <span class="s2">"00"</span>,
            <span class="s2">"message"</span>: <span class="s2">"Token generado exitosamente"</span>,
            <span class="s2">"date"</span>: <span class="s2">"2019-03-08T10:31:54-05:00"</span>
        <span class="o">}</span>,
        <span class="s2">"instrument"</span>: <span class="o">[</span>
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"token"</span>,
                <span class="s2">"value"</span>: <span class="s2">"1b394089c97bc5f155b684c068806d858d9e4180c8643b5b29cf216c4b656d3e"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"subtoken"</span>,
                <span class="s2">"value"</span>: <span class="s2">"2364106985941111"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"franchise"</span>,
                <span class="s2">"value"</span>: <span class="s2">"visa"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"franchiseName"</span>,
                <span class="s2">"value"</span>: <span class="s2">"Visa"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"issuerName"</span>,
                <span class="s2">"value"</span>: <span class="s2">"JPMORGAN CHASE BANK, N.A."</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"lastDigits"</span>,
                <span class="s2">"value"</span>: <span class="s2">"1111"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"validUntil"</span>,
                <span class="s2">"value"</span>: <span class="s2">"2021-03-31"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">"keyword"</span>: <span class="s2">"installments"</span>,
                <span class="s2">"value"</span>: <span class="s2">"1"</span>,
                <span class="s2">"displayOn"</span>: <span class="s2">"none"</span>
            <span class="o">}</span>
        <span class="o">]</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>La consulta de información de una transacción se puede dar cuando el usuario es retornado a su sitio ó mediante una tarea programada que diariamente ejecute un script en el cual se consulten todas las operaciones pendientes en su sitio. </p>

<p><strong>Recomendación:</strong> Implementar en su sitio las dos alternativas, pues si algo falla en el proceso de retorno y notificación, la tarea programada puede ser usada como <strong>contingencia</strong>.</p>

<p>Para consultar la sesión debe enviar el identificador único de la sesión de pago <code>requesId</code> usando el método <a href="#getRequestinformation">GetRequestInformation</a>.</p>

<aside class="notice">
Para este consumo también es necesario enviar en la petición la autenticación.
</aside>

<p>La respuesta de la transacción debe contener diferentes objetos: </p>

<ul>
<li><p><a href="#status">status</a></p></li>
<li><p><a href="#redirectrequest">request</a></p></li>
<li><p><a href="#redirectrequest">fields</a><br></p></li>
</ul>

<p>Datos de la transacción:</p>

<table><thead>
<tr>
<th>Parámetro</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>internalReference <code>Opcional</code></td>
<td>Int</td>
<td>Referencia interna en PlacetoPay.</td>
</tr>
<tr>
<td>paymentMethod <code>Opcional</code></td>
<td>String</td>
<td>Código del método de pago utilizado.</td>
</tr>
<tr>
<td>paymentMethodName <code>Opcional</code></td>
<td>String</td>
<td>Nombre del método de pago utilizado.</td>
</tr>
<tr>
<td>issuerName <code>Opcional</code></td>
<td>String</td>
<td>Nombre del emisor o del procesador.</td>
</tr>
</tbody></table>
<h2 id='informacion-adicional'>Información adicional</h2><h3 id='campos-usados-por-tipo-de-operacion'>Campos usados por tipo de operación</h3>
<p>Matriz con los campos disponibles para enviar por operación.
Las convenciones son: <code>R</code> (requerida), <code>O</code> (opcional), <code>A</code> (recomendada), <code>-</code> (no aplica), <code>R*</code> (Es requerido, se debe enviar uno de ellos)</p>

<table><thead>
<tr>
<th></th>
<th>Payment</th>
<th>Subscription</th>
<th>Payment Partial</th>
<th>Reverse Payment</th>
<th>Recurrent payment</th>
<th>Invalidate token</th>
<th>Collect</th>
</tr>
</thead><tbody>
<tr>
<td><strong>locale</strong></td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><strong>payer</strong></td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>documentType</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>document</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>name</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>surname</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>company</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>email</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>address</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>A</td>
</tr>
<tr>
<td>mobile</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>A</td>
</tr>
<tr>
<td><strong>buyer</strong></td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>-</td>
<td>A</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>documentType</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>document</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>name</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>-</td>
<td>A</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>surname</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>company</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>email</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>-</td>
<td>A</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>address</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>mobile</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><strong>payment</strong></td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>reference</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>description</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>amount</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td><code>currency</code></td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td><code>total</code></td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td><code>taxes</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>details</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>allowPartial</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>shipping</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>documentType</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>document</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>name</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>surname</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>company</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>email</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>address</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>mobile</code></td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>items</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>fields</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>recurring</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>periodicity</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>interval</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>nextPayment</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>maxPeriods</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>dueDate</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>notificationUrl</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><strong>subscription</strong></td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>reference</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>description</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>fields</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>fields</strong></td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>keyword</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>value</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td>displayOn</td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><strong>paymentMethod</strong></td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>expiration</strong></td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>returnUrl</strong></td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>cancelUrl</strong></td>
<td>O</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>O</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>ipAddress</strong></td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>userAgent</strong></td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>requestId</strong></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>-</td>
</tr>
<tr>
<td><strong>Instrument</strong></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td>token</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
</tr>
<tr>
<td><code>token</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R*</td>
</tr>
<tr>
<td><code>subtoken</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R*</td>
</tr>
<tr>
<td><code>instalments</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>O</td>
</tr>
<tr>
<td><code>cvv</code></td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>O</td>
</tr>
</tbody></table>
<h3 id='tarjeta-de-pruebas'>Tarjeta de pruebas</h3>
<table><thead>
<tr>
<th>Franchise</th>
<th>Card number</th>
<th>Comportamiento</th>
</tr>
</thead><tbody>
<tr>
<td>Visa</td>
<td>4005580000000040</td>
<td>Rechaza</td>
</tr>
<tr>
<td>Visa</td>
<td>4007000000027</td>
<td>Aprueba</td>
</tr>
<tr>
<td>Visa</td>
<td>4111111111111111</td>
<td>Aprueba</td>
</tr>
<tr>
<td>Visa</td>
<td>4212121212121214</td>
<td>Deja la operación pendiente como modo de captura, la operación debe ser autorizada o cancelada en el panel de Place to Pay  o de otra manera por operaciones de VOID o SETTLE.</td>
</tr>
<tr>
<td>Visa</td>
<td>4666666666666669</td>
<td>Este toma 5 minutos para autorizar. La idea es simular un tiempo de espera en su autorización. Así que el servicio de consumo fallará por el tiempo, lo que obligará al uso del Webservice para verificar cuando la operación completa su proceso. Tenga en cuenta los tiempos de consumo de Webservice.</td>
</tr>
<tr>
<td>Visa</td>
<td>36545407032780</td>
<td>Deja la operación en estado Manual (se debe aprobar o rechazar desde la consola)</td>
</tr>
<tr>
<td>MasterCard</td>
<td>5424000000000015</td>
<td>Aprueba</td>
</tr>
<tr>
<td>MasterCard Credencial (BCO)</td>
<td>540625 10 00 00 00 08</td>
<td>Aprueba</td>
</tr>
<tr>
<td>AmericanExpress</td>
<td>370000000000002</td>
<td>Aprueba</td>
</tr>
<tr>
<td>Diners</td>
<td>36018623456787</td>
<td>Aprueba</td>
</tr>
<tr>
<td>BBVA Club Campestre</td>
<td>8130010000000000</td>
<td>Aprueba</td>
</tr>
<tr>
<td>Visa Electron (Debit card)</td>
<td>4027390000000006</td>
<td>Aprueba</td>
</tr>
<tr>
<td>Visa Electron (Debit card)</td>
<td>4215440000000001</td>
<td>Rechaza</td>
</tr>
<tr>
<td>Codensa</td>
<td>5907120000000009</td>
<td>Rechaza</td>
</tr>
<tr>
<td>Tarjeta RIS</td>
<td>6372000000000007</td>
<td>Rechaza</td>
</tr>
</tbody></table>

<aside class="notice">
Los número de tarjetas solo tienen dicho comportamiento en el ambiente de pruebas.
</aside>
<h3 id='metodos-de-pago-codigos'>Métodos de Pago Códigos.</h3>
<p>Esta es una lista de las franquicias disponibles en redirección.</p>

<table><thead>
<tr>
<th>País</th>
<th>Franquicia</th>
<th>Método de pago</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>Colombia</td>
<td>AC_WU</td>
<td>ath</td>
<td>Wester Union</td>
</tr>
<tr>
<td></td>
<td>AV_AV</td>
<td>ath</td>
<td>Banco AV Villas Recaudos</td>
</tr>
<tr>
<td></td>
<td>AV_BB</td>
<td>ath</td>
<td>Banco de Bogotá Recaudos</td>
</tr>
<tr>
<td></td>
<td>AV_BO</td>
<td>ath</td>
<td>Banco de Occidente Recaudos</td>
</tr>
<tr>
<td></td>
<td>AV_BP</td>
<td>ath</td>
<td>Banco popular Recaudos</td>
</tr>
<tr>
<td></td>
<td>BBVAC</td>
<td>ath</td>
<td></td>
</tr>
<tr>
<td></td>
<td>BP_AM</td>
<td>amex</td>
<td></td>
</tr>
<tr>
<td></td>
<td>BP_DN</td>
<td>diners</td>
<td></td>
</tr>
<tr>
<td></td>
<td>BP_DS</td>
<td>discover</td>
<td></td>
</tr>
<tr>
<td></td>
<td>BP_EL</td>
<td>elo</td>
<td></td>
</tr>
<tr>
<td></td>
<td>BP_MC</td>
<td>master</td>
<td></td>
</tr>
<tr>
<td></td>
<td>BP_VS</td>
<td>visa</td>
<td></td>
</tr>
<tr>
<td></td>
<td>CAFAM</td>
<td>cafam</td>
<td></td>
</tr>
<tr>
<td></td>
<td>CDNSA</td>
<td>codensa</td>
<td>Codensa</td>
</tr>
<tr>
<td></td>
<td>CMRFB</td>
<td>falabella</td>
<td></td>
</tr>
<tr>
<td></td>
<td>CR_AM</td>
<td>amex</td>
<td>American Express</td>
</tr>
<tr>
<td></td>
<td>CR_CR</td>
<td>credencial</td>
<td>Credencial Banco de Occidente</td>
</tr>
<tr>
<td></td>
<td>CR_DN</td>
<td>diners</td>
<td>Diners Club</td>
</tr>
<tr>
<td></td>
<td>CR_VE</td>
<td>visa_electron</td>
<td>Visa Electron</td>
</tr>
<tr>
<td></td>
<td>CR_VS</td>
<td>visa</td>
<td>Visa</td>
</tr>
<tr>
<td></td>
<td>DBTAC</td>
<td>debito</td>
<td>Registro cuentas débito</td>
</tr>
<tr>
<td></td>
<td>DF_DN</td>
<td>diners</td>
<td></td>
</tr>
<tr>
<td></td>
<td>DF_DS</td>
<td>discover</td>
<td></td>
</tr>
<tr>
<td></td>
<td>DF_MC</td>
<td>master</td>
<td></td>
</tr>
<tr>
<td></td>
<td>DF_VS</td>
<td>visa</td>
<td></td>
</tr>
<tr>
<td></td>
<td>DISCO</td>
<td>discover</td>
<td>Disvover</td>
</tr>
<tr>
<td></td>
<td>DVVND</td>
<td>ath</td>
<td></td>
</tr>
<tr>
<td></td>
<td>EFCTY</td>
<td>efecty</td>
<td>Efecty</td>
</tr>
<tr>
<td></td>
<td>ENPCT</td>
<td>cooperativa</td>
<td></td>
</tr>
<tr>
<td></td>
<td>GNOFC</td>
<td>gana</td>
<td></td>
</tr>
<tr>
<td></td>
<td>GNPIN</td>
<td>gana</td>
<td>GanaPIN</td>
</tr>
<tr>
<td></td>
<td>GNRIS</td>
<td>ris</td>
<td>Tarjeta RIS</td>
</tr>
<tr>
<td></td>
<td>ID_DN</td>
<td>diners</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ID_DS</td>
<td>discover</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ID_MC</td>
<td>master</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ID_VS</td>
<td>visa</td>
<td></td>
</tr>
<tr>
<td></td>
<td>MSTRP</td>
<td>masterpass</td>
<td>Masterpass</td>
</tr>
<tr>
<td></td>
<td>PBBVA</td>
<td>ath</td>
<td></td>
</tr>
<tr>
<td></td>
<td>PINVL</td>
<td>Pin Valida</td>
<td></td>
</tr>
<tr>
<td></td>
<td>PYPAL</td>
<td>PayPal</td>
<td>PayPal</td>
</tr>
<tr>
<td></td>
<td>RM_MC</td>
<td>master</td>
<td>MasterCard</td>
</tr>
<tr>
<td></td>
<td>SOMOS</td>
<td>somos</td>
<td></td>
</tr>
<tr>
<td></td>
<td>SB_VS</td>
<td>visa</td>
<td></td>
</tr>
<tr>
<td></td>
<td>SFPAY</td>
<td>safetypay</td>
<td>Safety Pay</td>
</tr>
<tr>
<td></td>
<td>SPGRS</td>
<td>supergiros</td>
<td></td>
</tr>
<tr>
<td></td>
<td>T1_BC</td>
<td>ath</td>
<td>Bancolombia Recaudos</td>
</tr>
<tr>
<td></td>
<td>T1_CV</td>
<td>ath</td>
<td></td>
</tr>
<tr>
<td></td>
<td>TY_AK</td>
<td>Alkosto</td>
<td>Alkosto</td>
</tr>
<tr>
<td></td>
<td>TY_EX</td>
<td>Exito</td>
<td>Tarjeta Éxito</td>
</tr>
<tr>
<td></td>
<td>VISAC</td>
<td>visa_checkout</td>
<td>Visa Checkout</td>
</tr>
<tr>
<td></td>
<td>V_VBV</td>
<td>Verified by visa</td>
<td></td>
</tr>
<tr>
<td></td>
<td><em>ATH</em></td>
<td>ath</td>
<td>Corresponsales bancarios Grupo Aval</td>
</tr>
<tr>
<td></td>
<td><em>PPD</em></td>
<td>ppd</td>
<td>Débito pre-autorizado (PPD)</td>
</tr>
<tr>
<td></td>
<td><em>PSE</em></td>
<td>pse</td>
<td>Débito a cuentas corrientes y ahorros (PSE)</td>
</tr>
<tr>
<td>Ecuador</td>
<td>ID_VS</td>
<td>Visa</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ID_MC</td>
<td>Mastercard</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ID_DN</td>
<td>Diners</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ID_DS</td>
<td>Discover</td>
<td></td>
</tr>
</tbody></table>
<h3 id='tipos-de-documento'>Tipos de documento</h3>
<p>Ésta es una lista de los tipos de documentos aceptados por redirección.</p>

<table><thead>
<tr>
<th>País</th>
<th>Código</th>
<th>Tipo de documento</th>
</tr>
</thead><tbody>
<tr>
<td>Internacional</td>
<td>PPN</td>
<td>Pasaporte</td>
</tr>
<tr>
<td></td>
<td>TAX</td>
<td>TAX</td>
</tr>
<tr>
<td></td>
<td>LIC</td>
<td>Labeler Identification Code</td>
</tr>
<tr>
<td>Colombia</td>
<td>CC</td>
<td>Cédula de ciudadanía</td>
</tr>
<tr>
<td></td>
<td>CE</td>
<td>Cédula de extranjería</td>
</tr>
<tr>
<td></td>
<td>TI</td>
<td>Tarjeta de identidad</td>
</tr>
<tr>
<td></td>
<td>RC</td>
<td>Registro Civil</td>
</tr>
<tr>
<td></td>
<td>NIT</td>
<td>Número de Identificación Tributaria</td>
</tr>
<tr>
<td></td>
<td>RUT</td>
<td>Registro único tributario</td>
</tr>
<tr>
<td>Ecuador</td>
<td>CI</td>
<td>Cédula de identidad</td>
</tr>
<tr>
<td></td>
<td>RUC</td>
<td>Registro Único de Contribuyentes</td>
</tr>
<tr>
<td>Panamá</td>
<td>CIP</td>
<td>Cédula de identidad personal</td>
</tr>
<tr>
<td>Brazil</td>
<td>CPF</td>
<td>Cadastro de Pessoas Físicas</td>
</tr>
<tr>
<td>USA</td>
<td>SSN</td>
<td>Social security number</td>
</tr>
</tbody></table>
<h1 id='conexion-medios-de-pago-api'>Conexión medios de pago API</h1>
<p>Este Webservice y su arquitectura permiten que cualquier aplicativo sin importar el lenguaje de desarrollo, puedan beneficiarse de un conjunto de reglas de negocio y servicios, debido al cumplimiento de estándares SOAP, WSDL y XML.</p>

<p>Para hacer uso de los Webservice, debe contar con un lenguaje de programación que pueda consumirlos, algunos lenguajes tienen mejor soporte que otros desde el punto de vista de facilidad de acceso; sin embargo, si no se cuenta con un lenguaje que encapsule la comunicación, siempre se puede hacer incluso a nivel de sockets usando el protocolo HTTP conjuntamente con la especificación SOAP.</p>

<p>Para aquellos lenguajes que tienen un buen soporte lo más aconsejable es ir a través del WSDL para el Webservice.</p>

<p>La integración directa al medio de pago en general NO es recomendada, pues dificulta otros servicios que pueden estar implementados en la interfaz de Placetopay, al tiempo que hace que cada nuevo medio de pago liberado requiera un nuevo desarrollo por parte del comercio. Así que solo tener en cuenta esta integración si:</p>

<ul>
<li>Completa flujo de transacción no disponible por redirección.</li>
<li>Usa el servicio a modo de marca blanca.</li>
</ul>

<p><strong>¿Qué obligaciones tengo al usar esta integración?</strong></p>

<p>Ten en cuenta que al usar este tipo de integración, se requiere de certificación y los tiempos de implementación pueden ser mucho más altos que cuando se integra por <a href="#webcheckout">WebCheckOut</a>.</p>

<p><strong>Captura de la información</strong></p>

<p>Al consumir el servicio de creación de la transacción, tu aplicación debe proveer información sobre el pagador, el comprador y la transacción. Si corresponden a la misma persona, solamente deberás especificar la información del pagador</p>

<p>Para proveer estos datos, tu aplicación deberá capturarlos directamente en el proceso o de alguna fuente de información previamente habilitada.</p>

<aside class="notice">
Recomendamos tener un certificado digital SSL para tu sitio.
</aside>
<h2 id='authentication'>Authentication</h2>
<blockquote>
<p>Ejemplo generación de fecha en formato <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>:</p>
</blockquote>
<pre class="highlight php tab-php"><code>
<span class="cp">&lt;?php</span>
<span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre><pre class="highlight csharp tab-csharp"><code>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Globalization</span><span class="p">;</span>

<span class="n">String</span> <span class="n">seed</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"s"</span><span class="p">,</span>
    <span class="n">System</span><span class="p">.</span><span class="n">Globalization</span><span class="p">.</span><span class="n">CultureInfo</span><span class="p">.</span><span class="n">InvariantCulture</span><span class="p">);</span>

</code></pre>
<blockquote>
<p>Ejemplo generación Hash:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
    <span class="nv">$hashString</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$seed</span> 
    <span class="o">.</span> <span class="nv">$tranKey</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>

<span class="k">private</span> <span class="kt">string</span> <span class="nf">GetSHA1</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ASCIIEncoding</span> <span class="n">UE</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ASCIIEncoding</span><span class="p">();</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">hashValue</span><span class="p">;</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">message</span> <span class="p">=</span> <span class="n">UE</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
    <span class="n">SHA1</span> <span class="n">hashString</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SHA1CryptoServiceProvider</span><span class="p">();</span>
    <span class="kt">string</span> <span class="n">hex</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">hashValue</span> <span class="p">=</span> <span class="n">hashString</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">byte</span> <span class="n">x</span> <span class="k">in</span> <span class="n">hashValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">hex</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0:x2}"</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">hex</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">string</span> <span class="n">hashString</span> <span class="p">=</span> <span class="nf">GetSHA1</span><span class="p">(</span><span class="n">seed</span>
    <span class="p">+</span> <span class="n">tranKey</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Ejemplo de autenticación con la estructura <code>auth</code>:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
        <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
        <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s1">'024h1IlD'</span><span class="p">;</span>
        <span class="nv">$trankey</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>

        <span class="nv">$servicio</span> <span class="o">=</span> <span class="s1">'https://test.placetopay.com/soap/pse/v11/?wsdl'</span><span class="p">;</span> <span class="c1">//url del servicio
</span>
    <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
        <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
        <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span>
                    <span class="p">);</span>
    <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span> <span class="c1">// En lugar de SoapClient se utiliza nusoap_client
</span><span class="cp">?&gt;</span>
</code></pre><pre class="highlight shell tab-shell"><code>    POST /api/session
    <span class="o">{</span>
    <span class="s2">"auth"</span>: 
    <span class="o">{</span>
        <span class="s2">"login"</span>: <span class="s2">"usuarioprueba"</span>,
        <span class="s2">"tranKey"</span>: <span class="s2">"T0O+x3gNlQUf0iBxEuenPvBPlWs="</span>,
        <span class="s2">"seed"</span>: <span class="s2">"2019-04-25T18:17:23-04:00"</span>,
     <span class="o">}</span>
    <span class="o">}</span>
</code></pre>
<p>La autenticación a los servicios web debe ser enviada sobre la estructura <code>auth</code>, compuesto como se muestra a continuación:</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>login</td>
<td>string</td>
<td>Identificador del sitio.</td>
</tr>
<tr>
<td>tranKey</td>
<td>string</td>
<td>Llave transaccional, para el consumo del API: <code>SHA-1(seed + trankey)</code>.</td>
</tr>
<tr>
<td>seed</td>
<td>string</td>
<td>Fecha actual, la cual se genera en formato <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>. El sistema verificará que la petición no haya expirado, por ello es fundamental una sincronización del reloj del servidor</td>
</tr>
<tr>
<td>additional</td>
<td><a href="#attribute">Attribute</a></td>
<td>Datos adicionales a la estructura de autenticación.</td>
</tr>
</tbody></table>

<aside class="notice">
El login y el trankey son suministrados por Placetopay.
</aside>

<aside class="notice">
El Hash es el que se remite como tranKey en la estructura de autenticación.
</aside>

<aside class="notice">
La estructura de autenticación debe de ser enviada en cada petición realizada al servicio.
</aside>
<h2 id='webservice-credito-colombia'>Webservice Credito Colombia</h2>
<p>Aquí se describe un método de conexión a Placetopay basado en el envío de datos por método POST a la plataforma en una comunicación servidor servidor bajo un esquema REST.</p>

<p>Este mecanismo sólo debe ser usado por aquellos clientes de la plataforma que requieren capturar la información del tarjeta habiente incluyendo los datos sensibles. Este tipo de integración sólo está pensado para soportar la operación de tarjetas no presenciales que no requieran PIN para su operación.</p>
<h3 id='descripcion-del-metodo'>Descripción del método</h3>
<p>El método de integración avanzado o AIM, contempla las operaciones básicas para el procesamiento de tarjetas no presenciales, esto es la autorización, captura, reverso, asiento, anulación. A continuación se describirán cada uno de los usos y los datos requeridos en la trama para cada uno de los casos. La respuesta para cada operación está unificada en un solo tipo de trama resultante.
La implementación de este método se hizo pensando en minimizar el ancho de banda requerido para la comunicación así como la facilidad de implementación en cualquier lenguaje de programación que sea capaz de establecer una comunicación por sockets a través del protocolo HTTPS.</p>
<h3 id='flujo-de-integracion-aim'>Flujo de integración AIM</h3>
<p><em>Cómo funciona la implementación?</em></p>

<ol>
<li>Se hace una compilación de los datos a ser enviados a la plataforma, incluyendo los datos sensibles de la tarjeta (número, expiración, CVV2).</li>
<li>Se prepara la petición POST a nivel de servidor, tenga en cuenta que el servicio espera los datos en codificación <a href="https://es.wikipedia.org/wiki/ISO/IEC_8859-1">ISO-8859-1</a>. Los datos a ser remitidos a Placetopay dependerán de la operación que desea realizar.</li>
<li>Se hace el POST a Placetopay, y se espera por la respuesta. Normalmente los tiempos de respuesta son de 2 a 3 segundos, sin embargo tenga en cuenta que dependiendo de congestión de la red u otros factores, el tiempo puede incrementarse. Verifique que en la implementación su script espera al menos hasta 15 o 20 segundos antes de dar un timeout.</li>
<li>Si obtuvo una respuesta de la plataforma entonces proceda a desglosarla (la respuesta se entrega como una cadena de caracteres separados por coma) y a identificar los datos relevantes para su sistema, normalmente serán el estado de la transacción, el motivo asociado al estado, la franquicia, el banco emisor, la autorización, el recibo y la identificación de la transacción en Placetopay.</li>
<li>Si por el contrario no obtuvo una respuesta válida u obtuvo un timeout deberá seguir el proceso de consulta de la transacción para determinar el estado de la misma.</li>
<li>Presente al usuario el resultado de la transacción y active las otras rutas de flujo en su sistema.</li>
</ol>
<h4 id='en-que-casos-es-mejor-usar-este-tipo-de-integracion'>¿En qué casos es mejor usar este tipo de integración?</h4>
<p>La integración AIM se recomienda únicamente en los casos que no sea factible que el usuario realice la transacción ingresando los datos sensibles en Placetopay o en donde se requiere un control particular de la operación.  Algunos ejemplos son:</p>

<ul>
<li>Cobros recurrentes desde una base de datos propietaria.</li>
<li>Integración con un sistema de audiorespuesta.</li>
<li>Múltiples transacciones a diferentes recaudadores con la misma información del tarjetahabiente.</li>
<li>Interfaz móvil propietaria, no basada en HTML.</li>
<li>Integración con sistemas cuya entrada de los datos sensibles no la realice directamente el tarjetahabiente.</li>
</ul>
<h4 id='que-obligaciones-tengo-al-usar-esta-integracion'>¿Qué obligaciones tengo al usar esta integración?</h4>
<p>Tenga en cuenta que al usar este tipo de integración, usted está suministrando todos los datos del comprador incluyendo los datos sensibles de la tarjeta, este solo hecho requiere que la captura de la información sea por un mecanismo seguro que no ponga en peligro los datos del tarjetahabiente. Si la información la captura por una página Web, el punto donde se capturan estos datos debe estar sobre protocolo seguro HTTPS usando certificados de seguridad expedidos por una entidad certificadora acreditada.</p>

<p>Si la captura la realiza por un Call Center, quien obtiene los datos sensibles debe ser un mecanismo de IVR (Interactive Voice Response) o audiorespuesta; esto implicaría un rompimiento en el proceso entre el proceso que realiza el operador con su CRM y el IVR quien captura los datos sensibles. Finalmente el CRM consolida los dos conjuntos de datos y los remite a Placetopay.</p>

<p>Si la captura proviene de una base de datos de tarjetas previamente inscritas, asegúrese que esta información está encriptada por un mecanismo seguro de encriptación como AES o 3DES, desencripte solo en el momento en que construye la trama a ser enviada a Placetopay.</p>

<aside class="warning">
Placetopay tiene servicios de tokenización que pueden ser usados.
</aside>

<p>Tenga en cuenta que como regla general usted no debe almacenar el número de tarjeta, fecha de vencimiento y CVV2. Estos solo pueden tener persistencia durante la solicitud de la autorización, una vez procesada no deben ser almacenados.</p>

<p>Como cualquier proceso de integración, este requerirá una certificación del personal de soporte de Placetopay para revisar temas de funcionamiento, mejores prácticas y usabilidad.</p>
<h3 id='metodos-de-interfaz-credito-colombia'>Metodos de interfaz credito Colombia</h3>
<p>A continuación se describen las tramas que deben ser enviadas a Placetopay para que la plataforma procese una operación, de igual forma la trama de respuesta entregada por la plataforma.</p>
<h4 id='solicitud-de-autorizacion'>Solicitud de autorización</h4>
<p>Este tipo de solicitud permite realizar un cobro en línea. Esta operación se logra remitiendo el valor <code>AUTH_ONLY</code> en la variable <code>x_type</code>.</p>
<h4 id='solicitud-de-captura'>Solicitud de captura</h4>
<p>Este tipo de operación preprocesa la transacción y la deja en estado pendiente. Posteriormente se deberá realizar una operación de asiento o de anulación. Esta operación se logra remitiendo el valor <code>CAPTURE_ONLY</code> en la variable <code>x_type</code>.</p>
<h4 id='solicitud-de-asiento-o-anulacion-de-captura'>Solicitud de asiento o anulación de captura</h4>
<p>Operación complementaria a la de captura. Tiene como objetivo terminar el cobro de la operación o en su defecto cancelar la solicitud. Esta operación se logra remitiendo los valores de <code>SETTLE o VOID</code> en la variable <code>x_type</code> dependiendo de si se desea asentar o anular.</p>
<h4 id='solicitud-de-reversa'>Solicitud de reversa</h4>
<p>Una operación de reversa tiene sentido sobre una transacción previamente aprobada. Tenga en cuenta que actualmente hay una restricción para la reversa, y esta solo puede solicitarse el mismo día de la transacción aprobada con un límite de las 10:00pm hora colombiana.
Tenga en cuenta que una transacción de reversa puede declinar y que dependerá del banco emisor dar o no la autorización, igual que lo hace con una autorización.</p>
<h3 id='estructura-de-datos-credito'>Estructura de datos credito</h3>
<p>Desde aquí se describen cada uno de los campos que son usados en las diferentes tramas. Se han categorizado acorde al tipo de información que representan; la columna valor posible determina en algunos casos el único valor permitido para el campo.</p>
<h4 id='datos-de-la-especificacion'>Datos de la especificación</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_version</td>
<td>String[3]</td>
<td>2.0</td>
<td>Versión de la trama a ser usada para comunicarse con Placetopay.</td>
</tr>
<tr>
<td>x_delim_data</td>
<td>String[5]</td>
<td>TRUE</td>
<td>Indicador de que los datos de respuesta van delimitados (el delimitador es la coma).</td>
</tr>
<tr>
<td>x_relay_response</td>
<td>String[5]</td>
<td>FALSE</td>
<td>Indicador de si no espera la respuesta.</td>
</tr>
<tr>
<td>x_language</td>
<td>String[2]</td>
<td></td>
<td>Código del idioma acorde a ISO 631-1 en que se dan las notificaciones en la plataforma. Por defecto es ES (español).</td>
</tr>
</tbody></table>
<h4 id='datos-del-comercio-y-operacion'>Datos del comercio y operación</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_login</td>
<td>String[32]</td>
<td></td>
<td>Identificador del sitio del comercio en la Plataforma.</td>
</tr>
<tr>
<td>x_tran_key</td>
<td>String[16]</td>
<td></td>
<td>Clave para poder enviar una transacción.</td>
</tr>
<tr>
<td>x_test_request</td>
<td>String[5]</td>
<td>TRUE / FALSE</td>
<td>Indicador de si la transacción va en modo de prueba o no. Por defecto es FALSE (producción).</td>
</tr>
<tr>
<td>x_type</td>
<td>String[12]</td>
<td>AUTH_ONLY / CAPTURE_ONLY / CREDIT / SETTLE / VOID</td>
<td>Tipo de operación a realizar.</td>
</tr>
<tr>
<td>x_method</td>
<td>String[2]</td>
<td>CC</td>
<td>Método usado para el procesamiento.</td>
</tr>
<tr>
<td>x_email_merchant</td>
<td>String[5]</td>
<td>TRUE / FALSE</td>
<td>Indicador de si debe enviarse un correo electrónico al comercio cuando haya una transacción exitosa.</td>
</tr>
<tr>
<td>x_email_customer</td>
<td>String[5]</td>
<td>TRUE / FALSE</td>
<td>Indicador de si debe enviarse un correo electrónico al pagador cuando haya una transacción exitosa.</td>
</tr>
<tr>
<td>x_customer_ip</td>
<td>String[15]</td>
<td></td>
<td>Dirección IP desde la cual está realizando el pago el usuario pagador.</td>
</tr>
</tbody></table>
<h4 id='datos-del-cobro'>Datos del cobro</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_invoice_num</td>
<td>String[32]</td>
<td></td>
<td>Número de referencia, orden de pedido o factura relacionada.</td>
</tr>
<tr>
<td>x_description</td>
<td>String[255]</td>
<td></td>
<td>Descripción de la compra.</td>
</tr>
<tr>
<td>x_currency_code</td>
<td>String[3]</td>
<td></td>
<td>Código de la moneda acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a> en la cual está expresado el cobro.</td>
</tr>
<tr>
<td>x_amount</td>
<td>Decimal [9.2]</td>
<td></td>
<td>Valor total de la compra incluyendo impuestos.</td>
</tr>
<tr>
<td>x_tax</td>
<td>Decimal [9.2]</td>
<td></td>
<td>Valor total de los impuestos.</td>
</tr>
<tr>
<td>x_amount_base</td>
<td>Decimal [9.2]</td>
<td></td>
<td>Valor base de devolución de impuestos (solo aplica para Colombia en los casos en que el impuesto sea del 16% o 10%). Se define como el valor sobre el cual fue calculado el impuesto. Por lo tanto si no hay impuesto, no hay base de devolución.</td>
</tr>
<tr>
<td>x_token</td>
<td>String[64]</td>
<td></td>
<td>Token a ser usado, en el caso de que haya tokenizado los datos de la tarjeta.</td>
</tr>
<tr>
<td>x_card_num</td>
<td>String[16]</td>
<td></td>
<td>Número de la tarjeta, no requerido si usa token.</td>
</tr>
<tr>
<td>x_card_type</td>
<td>String[1]</td>
<td>C / A / R</td>
<td>Tipo de la tarjeta, no requerido si usa token.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>C = crédito</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>A = débito ahorros</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>R = débito corriente</td>
</tr>
<tr>
<td>x_exp_date</td>
<td>String[12]</td>
<td></td>
<td>Fecha de vencimiento de la tarjeta, no requerido si usa token, se aceptan los siguientes formatos: MMAA, MMAAAA, AAAAMMDD, AAAA/MM/DD, AAAA-MMDD.</td>
</tr>
<tr>
<td>x_card_code</td>
<td>String[4]</td>
<td></td>
<td>Dígitos de verificación de la tarjeta (CVV2).</td>
</tr>
<tr>
<td>x_differed</td>
<td>Integer</td>
<td>1 - 36</td>
<td>Número de cuotas a las cuales difiere el pago. En su ausencia se supone a una cuota.</td>
</tr>
</tbody></table>
<h4 id='datos-para-cobros-recurrentes'>Datos para cobros recurrentes</h4>
<p>Tenga en cuenta que los valores de recurrencia son todos requeridos si el valor del campo <code>x_recurring_bill</code> es <Code>TRUE</code>. Estos datos no tienen sentido en otro caso.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_recurring_bill</td>
<td>String[5]</td>
<td>TRUE / FALSE</td>
<td>Indicador de si la transacción es recurrente. En su ausencia se supone <code>FALSE</code>.</td>
</tr>
<tr>
<td>x_recurring_periodicity</td>
<td>String [1]</td>
<td>Y / M / D</td>
<td>Periodicidad para volver a enviar la transacción.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Y = anual</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>M = mensual</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>D = diaria</td>
</tr>
<tr>
<td>x_recurring_interval</td>
<td>Integer</td>
<td></td>
<td>El intervalo aplicado a la periodicidad, por ejemplo si el intervalo es 3 y la periodicidad es M, entonces se estará haciendo el cobro trimestralmente. En su ausencia se supone uno (1).</td>
</tr>
<tr>
<td>x_recurring_max_periods</td>
<td></td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>x_recurring_due_date</td>
<td>String[10]</td>
<td></td>
<td>Parte del control de número de veces que se realiza el cobro, corresponde a la fecha hasta la cual se sucederá la recurrencia.Debe establecerse como una fecha en formato AAAA-MM-DD. Si no se desea establecer un máximo debe indicarse <code>UNLIMITED</code>. Debe especificarse este parámetro o en su defecto <code>x_recurring_max_periods</code>.</td>
</tr>
</tbody></table>
<h4 id='datos-para-cobros-con-split'>Datos para cobros con Split</h4>
<p>Tenga en cuenta que para pago con dispersión de fondos el comercio debe estar marcado en Placetopay para soportar este tipo de operaciones. De igual forma el <code>x_airline</code> debe llegar en la trama con un código de convenio válido, de lo contrario no hay dispersión y solo se realiza el cobro del valor especificado en <code>x_amount.</code></p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_airline</td>
<td>Int</td>
<td></td>
<td>Código del convenio, cuando se especifica; los valores dados en <code>x_amount</code> serán cobrados a favor de la entidad del convenio. Así mismo se habilita el cobro del valor dado en el <code>x_service_fee</code>.</td>
</tr>
<tr>
<td>x_airport_tax</td>
<td>Decimal [8,2]</td>
<td></td>
<td>Valor de la tasa aeroportuaria, solo aplica cuando el convenio es una aerolínea.</td>
</tr>
<tr>
<td>x_service_fee_code</td>
<td>Int</td>
<td>99</td>
<td>Código de compensación para cuando hay dispersión de fondos. Identifica que el <code>valor del x_service_fee</code> será a favor del establecimiento que solicitó la transacción.</td>
</tr>
<tr>
<td>x_service_fee</td>
<td>Decimal [8,2]</td>
<td></td>
<td>Valor total de la tasa administrativa incluyendo impuestos, este será el valor recaudado a nombre del establecimiento.</td>
</tr>
<tr>
<td>x_service_fee_tax</td>
<td>Decimal [8,2]</td>
<td></td>
<td>Valor total del impuesto de la tasa administrativa.</td>
</tr>
<tr>
<td>x_service_fee_base</td>
<td>Decimal [8,2]</td>
<td></td>
<td>Valor base de devolución de impuestos para la TA (solo aplica para Colombia en los casos en que el impuesto sea del 16% o 10%).</td>
</tr>
</tbody></table>
<h4 id='datos-del-pagador'>Datos del pagador</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_cust_id</td>
<td>String [20]</td>
<td></td>
<td>Identificación del pagador, está conformado por el tipo de documento y el documento, separados entre ellos por un espacio. Los tipos de documento válidos son:</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CC: Cédula de ciudadanía colombiana</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CE: Cédula de extranjería</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>TI: Tarjeta de identidad</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>NIT: Número de identificación tributaria</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>PPN: Pasaporte</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>SSN: Social security number</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Un ejemplo del dato puede ser:</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CC 71000000.</td>
</tr>
<tr>
<td>x_first_name</td>
<td>String[30]</td>
<td></td>
<td>Nombres completos.</td>
</tr>
<tr>
<td>x_last_name</td>
<td>String[30]</td>
<td></td>
<td>Apellidos completos.</td>
</tr>
<tr>
<td>x_company</td>
<td>String[50]</td>
<td></td>
<td></td>
</tr>
<tr>
<td>x_address</td>
<td>String[80]</td>
<td></td>
<td>Dirección de correspondencia.</td>
</tr>
<tr>
<td>x_city</td>
<td>String[30]</td>
<td></td>
<td>Ciudad.</td>
</tr>
<tr>
<td>x_state</td>
<td>String[30]</td>
<td></td>
<td>Estado, departamento o provincia.</td>
</tr>
<tr>
<td>x_zip</td>
<td>String[10]</td>
<td></td>
<td>Código postal.</td>
</tr>
<tr>
<td>x_country</td>
<td>String[2]</td>
<td></td>
<td>Código del país acorde a <a href="http://www.iso.org/iso/english_country_names_and_code_elements">ISO 3166-1</a>.</td>
</tr>
<tr>
<td>x_phone</td>
<td>String[30]</td>
<td></td>
<td>Número de telefonía fija.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Prefereriblemente: +indicativo (zona) teléfono.</td>
</tr>
<tr>
<td>x_fax</td>
<td>String[30]</td>
<td></td>
<td>Número de fax.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Prefereriblemente: +indicativo (zona) teléfono</td>
</tr>
<tr>
<td>x_mobile</td>
<td>String[30]</td>
<td></td>
<td>Número de fax / móvil.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Prefereriblemente: +indicativo (zona) teléfono</td>
</tr>
<tr>
<td>x_email</td>
<td>String[50]</td>
<td></td>
<td>Dirección de correo electrónico.</td>
</tr>
</tbody></table>
<h4 id='datos-del-comprador-o-beneficiario-receptor-del-bien-o-servicio'>Datos del comprador o beneficiario receptor del bien o servicio</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_ship_to_id</td>
<td>String [20]</td>
<td></td>
<td>Identificación del comprador, está conformado por el tipo de documento y el documento, separados entre ellos por un espacio. Los tipos de documento válidos son:</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CC: Cédula de ciudadanía colombiana</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CE: Cédula de extranjería</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>TI: Tarjeta de identidad</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>NIT: Número de identificación tributaria</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>PPN: Pasaporte</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>SSN: Social security number</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>TAX: Numero generico impositivo</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>RC: Registro civil</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Un ejemplo del dato puede ser: CC 71000000.</td>
</tr>
<tr>
<td>x_ship_to_first_name</td>
<td>String[30]</td>
<td></td>
<td>Nombres completos.</td>
</tr>
<tr>
<td>x_ship_to_last_name</td>
<td>String[30]</td>
<td></td>
<td>Apellidos completos.</td>
</tr>
<tr>
<td>x_ship_to_company</td>
<td>String[50]</td>
<td></td>
<td>Compañía para la cual labora.</td>
</tr>
<tr>
<td>x_ship_to_address</td>
<td>String[80]</td>
<td></td>
<td>Dirección de correspondencia.</td>
</tr>
<tr>
<td>x_ship_to_city</td>
<td>String[30]</td>
<td></td>
<td>Ciudad.</td>
</tr>
<tr>
<td>x_ship_to_state</td>
<td>String[30]</td>
<td></td>
<td>Estado, departamento o provincia.</td>
</tr>
<tr>
<td>x_ship_to_zip</td>
<td>String[10]</td>
<td></td>
<td>Código postal.</td>
</tr>
<tr>
<td>x_ship_to_country</td>
<td>String[2]</td>
<td></td>
<td>Código del país acorde a <a href="http://www.iso.org/iso/english_country_names_and_code_elements">ISO 3166-1</a>.</td>
</tr>
<tr>
<td>x_ship_to_phone</td>
<td>String[30]</td>
<td></td>
<td>Número de telefonía fija.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Prefereriblemente: +indicativo (zona) teléfono</td>
</tr>
<tr>
<td>x_ship_to_mobile</td>
<td>String[30]</td>
<td></td>
<td>Número de celular / móvil.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Prefereriblemente: +indicativo (zona) teléfono</td>
</tr>
<tr>
<td>x_ship_to_email</td>
<td>String[50]</td>
<td></td>
<td>Dirección de correo electrónico.</td>
</tr>
</tbody></table>
<h4 id='datos-para-operaciones-sobre-transacciones'>Datos para operaciones sobre transacciones</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_franchise</td>
<td>String[5]</td>
<td></td>
<td>Código de la franquicia con la cual se hizo el pago.</td>
</tr>
<tr>
<td>x_approval_code</td>
<td>String[10]</td>
<td></td>
<td>Código de aprobación entregado por la entidad financiera en la transacción</td>
</tr>
</tbody></table>

<p>original.
| x_transaction_id | String[10] |  | Número único de la transacción proveniente de la transacción original.
| x_parent_session | String[32] |  | Identificador interno de la transacción que se desea asentar o anular, corresponde al <code>x_placetopay_id.</code></p>
<h4 id='datos-adicionales-para-almacenar-con-la-transaccion'>Datos adicionales para almacenar con la transacción</h4>
<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Valor posible</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>x_additional_data</td>
<td>Array</td>
<td></td>
<td>Utilice esta estructura para enviar datos adicionales a Placetopay que desea almacenar conjuntamente con la transacción. Básicamente este campo actua como un diccionario de datos tipo clave =&gt; valor.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>La clave tiene restricciones de forma, no puede iniciar con un número y solo debe contener letras no acentuadas, números, guiones medios o guiones de piso. Tiene una longitud máxima de 30 caracteres. El valor tiene una longitud máxima de 255 caracteres.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Ej:</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><code>x_additional_data[dato1] = “Hola”</code></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><code>x_additional_data[otroDato] = “Mundo”</code></td>
</tr>
</tbody></table>
<h3 id='informacion-adicional-credito-colombia'>Información adicional Credito Colombia</h3>
<p>Estos son datos que se remiten a la plataforma, y no son tomados en cuenta en la transacción.  Pero se retornan en la respuesta.</p>
<h4 id='campos-por-tipo-de-operacion'>Campos por tipo de operación</h4>
<p>Las convenciones para los campos disponibles por tipo de operación son:  <code>R</code> (requerido), <code>O</code> (opcional), <code>C</code> (condicionado a otro campo), <code>-</code> (no aplica). Cuando se especifica condicionado a otro campo por favor vea el detalle de la descripción de campos para entender de cual depende.</p>

<table><thead>
<tr>
<th>CAMPOS/OPERACIÓN</th>
<th>AUTH_ONLY</th>
<th>CAPTURE_ONLY</th>
<th>CREDIT</th>
<th>SETTLE</th>
<th>VOID</th>
</tr>
</thead><tbody>
<tr>
<td>x_version</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_delim_data</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_relay_response</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_language</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_login</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_tran_key</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_test_request</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_type</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_method</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_email_merchant</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_email_customer</td>
<td>R</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_customer_ip</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_invoice_num</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_description</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_currency_code</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_amount</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_tax</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_amount_base</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_token</td>
<td>C</td>
<td>C</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>x_card_num</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_card_type</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_exp_date</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_card_code</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_differed</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_recurring_bill</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_recurring_periodicity</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_recurring_interval</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_recurring_max_periods</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_recurring_due_date</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_airline</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_airport_tax</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_service_fee_code</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_service_fee</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_service_fee_tax</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_service_fee_base</td>
<td>C</td>
<td>C</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_cust_id</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_first_name</td>
<td>R</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_last_name</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_company</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_address</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_city</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_state</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_zip</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_country</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_phone</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>En la medida de lo posible se recomienda enviarlo por control de fraude</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>x_fax</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_mobile</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_email</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_id</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_first_name</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_last_name</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_company</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_address</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_city</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_state</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_zip</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_country</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_phone</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_mobile</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_ship_to_email</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_additional_data</td>
<td>O</td>
<td>O</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_franchise</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
<tr>
<td>x_approval_code</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_transaction_id</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>x_parent_session</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
<td>R</td>
</tr>
</tbody></table>
<h4 id='trama-de-respuesta'>Trama de respuesta</h4>
<p>A continuación se detalla la trama de respuesta para cualquiera de las operaciones definidas por el servicio AIM.</p>

<p>La trama de respuesta consiste en una cadena de caracteres separados por coma en el siguiente orden posicional.</p>

<table><thead>
<tr>
<th>Número</th>
<th>Campo</th>
<th>Tipo</th>
<th>Observaciones</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td>x_response_code</td>
<td>Integer</td>
<td>Respuesta a la transacción solicitada.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>0: Error</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>1: Aprobada</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>2: Declinada</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>3: Pendiente</td>
</tr>
<tr>
<td>2</td>
<td>x_response_subcode</td>
<td>String[5]</td>
<td>Código interno que acompaña la respuesta.</td>
</tr>
<tr>
<td>3</td>
<td>x_response_reason_code</td>
<td>String[3]</td>
<td>Código de la razón que por la cual se dió la respuesta.</td>
</tr>
<tr>
<td>4</td>
<td>x_response_reason_text</td>
<td>String[255]</td>
<td>Mensaje de la razón por la cual se dio la respuesta.</td>
</tr>
<tr>
<td>5</td>
<td>x_approval_code</td>
<td>String[10]</td>
<td>Código de aprobación entregado por la entidad financiera.</td>
</tr>
<tr>
<td>6</td>
<td>x_avs_result_code</td>
<td>String[1]</td>
<td>Resultado de la validación de los datos de dirección del comprador.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Actualmente se retorna</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>S: Servicio no soportado</td>
</tr>
<tr>
<td>7</td>
<td>x_transaction_id</td>
<td>String[10]</td>
<td>Identificador de la transacción establecido por la red.</td>
</tr>
<tr>
<td>8</td>
<td>x_invoice_num</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>9</td>
<td>x_description</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>10</td>
<td>x_amount</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>11</td>
<td>x_method</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>12</td>
<td>x_type</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>13</td>
<td>x_cust_id</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>14</td>
<td>x_first_name</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>15</td>
<td>x_last_name</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>16</td>
<td>x_company</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>17</td>
<td>x_address</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>18</td>
<td>x_city</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>19</td>
<td>x_state</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>20</td>
<td>x_zip</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>21</td>
<td>x_country</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>22</td>
<td>x_phone</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>23</td>
<td>x_fax</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>24</td>
<td>x_email</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>25</td>
<td>x_ship_to_first_name</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>26</td>
<td>x_ship_to_last_name</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>27</td>
<td>x_ship_to_company</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>28</td>
<td>x_ship_to_address</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>29</td>
<td>x_ship_to_city</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>30</td>
<td>x_ship_to_state</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>31</td>
<td>x_ship_to_zip</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>32</td>
<td>x_ship_to_country</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>33</td>
<td>x_tax</td>
<td></td>
<td>Copia del dato recibido</td>
</tr>
<tr>
<td>34</td>
<td>x_duty</td>
<td></td>
<td>Mantenido por compatibilidad</td>
</tr>
<tr>
<td>35</td>
<td>x_freight</td>
<td></td>
<td>Mantenido por compatibilidad</td>
</tr>
<tr>
<td>36</td>
<td>x_tax_exempt</td>
<td></td>
<td>Mantenido por compatibilidad</td>
</tr>
<tr>
<td>37</td>
<td>x_po_num</td>
<td></td>
<td>Mantenido por compatibilidad</td>
</tr>
<tr>
<td>38</td>
<td>x_md5_hash</td>
<td>String[32]</td>
<td>MD5 del valor de <code>md5HashKey</code> + <code>x_login</code> + <code>x_transaction_id</code> + <code>x_amount</code>; el amount va formateado con dos decimales. El hash es un valor establecido en la plataforma. Sirve para comprobar la estabilidad de la trama.</td>
</tr>
<tr>
<td>39</td>
<td>x_CVV2_response</td>
<td>String[1]</td>
<td>Indicador de comprobación del CVV2.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>P: No procesado</td>
</tr>
<tr>
<td>40</td>
<td>x_CAVV_response</td>
<td>String[1]</td>
<td>Indicador de comprobación del CAVV.</td>
</tr>
<tr>
<td>41</td>
<td>x_bank_currency</td>
<td>String[3]</td>
<td>Código de la moneda con la cual se hizo el recaudo.</td>
</tr>
<tr>
<td>42</td>
<td>x_bank_factor</td>
<td>Decimal</td>
<td>Tasa de conversión de la moneda original vs la moneda de recaudo.</td>
</tr>
<tr>
<td>43</td>
<td>x_bank_amount</td>
<td>Decimal</td>
<td>Valor recaudado convertido a la moneda esperada por la entidad financiera.</td>
</tr>
<tr>
<td>44</td>
<td>x_franchise</td>
<td>String[5]</td>
<td>Código de la franquicia con la cual se hizo el pago.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CR_CR =&gt; Credencial</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CR_DN =&gt; Diners</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CR_AM =&gt; AMEX</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CR_VS =&gt; Visa</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>CR_MC =&gt; Mastercard</td>
</tr>
<tr>
<td>45</td>
<td>x_bank_name</td>
<td>String[30]</td>
<td>Nombre del banco que autorizó la transacción (no siempre disponible)</td>
</tr>
<tr>
<td>46</td>
<td>x_placetopay_id</td>
<td>String[32]</td>
<td>Identificador único de la transacción retornado por Placetpay</td>
</tr>
<tr>
<td>47</td>
<td>x_ta_response_code</td>
<td></td>
<td></td>
</tr>
<tr>
<td>48</td>
<td>x_ta_response_reason_code</td>
<td></td>
<td></td>
</tr>
<tr>
<td>49</td>
<td>x_ta_approval_code</td>
<td></td>
<td></td>
</tr>
<tr>
<td>50</td>
<td>x_ta_transaction_id</td>
<td></td>
<td></td>
</tr>
<tr>
<td>51</td>
<td>x_placetopay_internal_reference</td>
<td>Int</td>
<td>Referencia interna en Placetopay enviada a la red como referencia de la transacción</td>
</tr>
<tr>
<td>52</td>
<td>x_response_reason_code_b24</td>
<td>String[3]</td>
<td>Código BASE24 equivalente al código ISO que llega en <code>x_response_reason_code</code></td>
</tr>
<tr>
<td>53</td>
<td>x_truncated_pan</td>
<td>String[16]</td>
<td>Número de tarjeta de crédito truncado admisible para ser visualizado</td>
</tr>
<tr>
<td>54</td>
<td>x_discount_code</td>
<td>String[32]</td>
<td>Código de descuento aplicado.  Un valor en blanco en este campo hace que los datos descuento de los demás campos tampoco deban tenerse en cuenta.</td>
</tr>
<tr>
<td>55</td>
<td>x_discount_type</td>
<td>String[20]</td>
<td>Tipo de descuento aplicado.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>MERCHANT =&gt; Provisto por el comercio</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>FRANCHISE =&gt; Provisto por el medio de pago</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>OTHER =&gt; Provisto por otro actor</td>
</tr>
<tr>
<td>56</td>
<td>x_discount_amount</td>
<td>Decimal</td>
<td>Valor total del descuento en la misma moneda de la solicitud</td>
</tr>
<tr>
<td>57</td>
<td>x_discount_base</td>
<td>Decimal</td>
<td>Valor base sobre el cual fue aplicado el descuento</td>
</tr>
<tr>
<td>58</td>
<td>x_discount_percent</td>
<td>Decimal</td>
<td>Valor porcentual equivalente del descuento</td>
</tr>
<tr>
<td>59</td>
<td></td>
<td></td>
<td>De la posición 59 a 68 se reserva para usos futuros.</td>
</tr>
<tr>
<td>69</td>
<td></td>
<td></td>
<td>A partir de esta posición se retransmiten los datos adicionales recibidos del comercio.</td>
</tr>
</tbody></table>
<h4 id='envio-de-transacciones-de-prueba'>Envío de transacciones de prueba</h4>
<p>En la plataforma, los comercios pueden estar en pruebas o producción. Dependiendo de este modo preconfigurado tiene sentido el parámetro <code>x_test_request</code>; así mismo como las respuestas obtenidas.</p>

<table><thead>
<tr>
<th>Configuración del comercio</th>
<th>Configuración del x_test_request</th>
<th>Modo de transacción</th>
</tr>
</thead><tbody>
<tr>
<td>pruebas</td>
<td>TRUE</td>
<td>pruebas</td>
</tr>
<tr>
<td>pruebas</td>
<td>FALSE</td>
<td>pruebas</td>
</tr>
<tr>
<td>producción</td>
<td>TRUE</td>
<td>pruebas</td>
</tr>
<tr>
<td>producción</td>
<td>FALSE</td>
<td>producción</td>
</tr>
</tbody></table>

<p>En modo de pruebas únicamente son aceptados los siguientes números de tarjetas:</p>

<table><thead>
<tr>
<th>Franquicia</th>
<th>Tarjeta</th>
<th>Comportamiento</th>
</tr>
</thead><tbody>
<tr>
<td>Visa</td>
<td>4005580000000040</td>
<td>Rechaza</td>
</tr>
<tr>
<td>Visa</td>
<td>4007000000027</td>
<td>Autoriza</td>
</tr>
<tr>
<td>Visa</td>
<td>4111111111111111</td>
<td>Autoriza</td>
</tr>
<tr>
<td>Visa</td>
<td>4212121212121214</td>
<td>Deja la operación pendiente como si fuera modo captura, la operación se debe asentar o anular por el panel de Placetopay o en su defecto mediante una operación <strong>SETTLE</strong> o <strong>VOID</strong>.</td>
</tr>
<tr>
<td>Visa</td>
<td>4666666666666669</td>
<td>Se demora en autorizar 3 minutos. La idea es simular un timeout en su autorización.  Así que el consumo del servicio fallará por tiempo, lo cual obligará al consumo de la sonda para verificar cuando la operación culmina su procesamiento.  Tenga en cuenta los tiempos de consumo del webservice.</td>
</tr>
<tr>
<td>MasterCard</td>
<td>5424000000000015</td>
<td>Autoriza</td>
</tr>
<tr>
<td>MasterCard</td>
<td>5406251000000008</td>
<td>Autoriza</td>
</tr>
<tr>
<td>AmericanExpress</td>
<td>370000000000002</td>
<td>Autoriza</td>
</tr>
<tr>
<td>Diners</td>
<td>36018623456787</td>
<td>Autoriza</td>
</tr>
<tr>
<td>BBVA Club Campestre</td>
<td>8130010000000000</td>
<td>Autoriza</td>
</tr>
</tbody></table>
<h3 id='consumo-del-webservice-de-sonda'>Consumo del Webservice de sonda</h3>
<p>Para aquellas transacciones que presentan una falla en los tiempos de respuesta, o que no puede ser verificado el <code>x_md5_hash</code>, se deberá consumir un Webservice para obtener de primera mano la información de la transacción.</p>

<p>En los casos que la transacción tiene respuesta pendiente, la regla general es que debe consumirse el servicio cada 12 minutos para las operaciones que tengan al menos 7 minutos de antigüedad. Esto implica que debe existir un proceso automático solicitando al webservice las operaciones que llevan más de 7 minutos pendientes y que el barrido debe hacerse cada 12 minutos.</p>

<aside class="notice">
Tenga en cuenta que en el proceso de certificación, se hará revisión de los consumos de sonda para que concuerden con los tiempos definidos.
</aside>

<aside class="notice">
El metodo de autenticación para el webservice de sonda se mantiene.
</aside>
<h4 id='querytransaction'>QueryTransaction</h4>
<p>Consulta el estado de una transacción acorde a los parámetros usados, tenga en cuenta que la respuesta es un arreglo de transacciones.</p>

<p>URL del servicio:
Pruebas:    <a href="https://test.placetopay.com/soap/placetopay/v11/">https://test.placetopay.com/soap/placetopay/v11/</a>
Producción:    <a href="https://api.placetopay.com/soap/placetopay/v11/">https://api.placetopay.com/soap/placetopay/v11/</a></p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación.</td>
</tr>
<tr>
<td>request</td>
<td><a href="#queryrequest">QueryRequest</a></td>
<td>Parámetros para buscar la transacción.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong>Transaction[]</strong>. Transacciones que concuerdan con la solicitud.</p>
<h4 id='queryrequest'>QueryRequest</h4>
<p>Estructura para solicitar la búsqueda de una transacción.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>reference</td>
<td>String[32]</td>
<td>Número de referencia, orden de compra o factura relacionada. (<code>x_invoice_num</code> usado).</td>
</tr>
<tr>
<td>currency</td>
<td>String[3]</td>
<td>Moneda utilizada en la solicitud acorde a <a href="https://www.currency-iso.org/dam/downloads/lists/list_one.xml">ISO 4217</a>.</td>
</tr>
<tr>
<td>totalAmount</td>
<td>double</td>
<td>Valor total de la operación, si es de aerolinea con TA debe ser la suma del valor del tiquete, la tasa aeroportuaria y la tarifa administrativa.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>requestDate</td>
<td>String</td>
<td>Fecha de solicitud o creación de la transacción acorde a <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>, se obvia la hora de la solicitud</td>
</tr>
</tbody></table>
<h4 id='transaction-credito'>Transaction (Credito)</h4>
<p>Estructura con la información de una transacción.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>transactionID</td>
<td>int</td>
<td>El ID de referencia pasado al procesador.</td>
</tr>
<tr>
<td>sessionID</td>
<td>string</td>
<td>Identificador único de la sesión en Placetopay.</td>
</tr>
<tr>
<td>reference</td>
<td>string</td>
<td>La referencia de la transacción.</td>
</tr>
<tr>
<td>requestDate</td>
<td>string</td>
<td>Fecha de solicitud o creación de la transacción acorde a <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</td>
</tr>
<tr>
<td>bankProcessDate</td>
<td>string</td>
<td>Fecha de procesamiento de la transacción acorde a <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</td>
</tr>
<tr>
<td>onTest</td>
<td>boolean</td>
<td>Indicador de si la transacción es en modo de pruebas o no.</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>El dato pasado como x_description.</td>
</tr>
<tr>
<td>currency</td>
<td>string</td>
<td>El dato pasado como <code>x_currency</code>.</td>
</tr>
<tr>
<td>totalAmount</td>
<td>double</td>
<td>Valor total de la compra.</td>
</tr>
<tr>
<td>taxAmount</td>
<td>double</td>
<td>Impuesto asociado a la compra.</td>
</tr>
<tr>
<td>devolutionBase</td>
<td>double</td>
<td>Base de devolución del IVA.</td>
</tr>
<tr>
<td>tipAmount</td>
<td>double</td>
<td>El valor de la tasa aeroportuaria: <code>x_airport_tax</code>.</td>
</tr>
<tr>
<td>airline</td>
<td>int</td>
<td>Código de la aerolínea.</td>
</tr>
<tr>
<td>serviceFee</td>
<td>double</td>
<td>Valor total de la tasa administrativa.</td>
</tr>
<tr>
<td>serviceFeeTax</td>
<td>double</td>
<td>Impuesto asociado a la tasa administrativa.</td>
</tr>
<tr>
<td>serviceFeeBase</td>
<td>double</td>
<td>Base de devolución del IVA asociado a la tasa administrativa.</td>
</tr>
<tr>
<td>payer</td>
<td><a href="#person">Person</a></td>
<td>Información del pagador.</td>
</tr>
<tr>
<td>buyer</td>
<td><a href="#person">Person</a></td>
<td>Información del comprador (<code>x_shipping_fields</code>)</td>
</tr>
<tr>
<td>shipping</td>
<td><a href="#person">Person</a></td>
<td>Información del receptor, no usado actualmente.</td>
</tr>
<tr>
<td>ipAddress</td>
<td>string</td>
<td>Dirección IP desde la cual realiza la transacción el pagador.</td>
</tr>
<tr>
<td>userAgent</td>
<td>string</td>
<td>Agente de navegación (browser) utilizado por el pagador.</td>
</tr>
<tr>
<td>franchise</td>
<td>string</td>
<td>El código de la franquicia usada.</td>
</tr>
<tr>
<td>franchiseName</td>
<td>string</td>
<td>Nombre de la franquicia.</td>
</tr>
<tr>
<td>bankName</td>
<td>string</td>
<td>Nombre del banco del tarjeta o cuenta habiente.</td>
</tr>
<tr>
<td>bankCurrency</td>
<td>string</td>
<td>Moneda aceptada por el banco.</td>
</tr>
<tr>
<td>bankFactor</td>
<td>float</td>
<td>Factor de conversión de la moneda.</td>
</tr>
<tr>
<td>authorization</td>
<td>string</td>
<td>Número de autorización.</td>
</tr>
<tr>
<td>receipt</td>
<td>string</td>
<td>Número de recibo.</td>
</tr>
<tr>
<td>refunded</td>
<td>boolean</td>
<td>Indicador de si la transacción fue reversada.</td>
</tr>
<tr>
<td>transactionState</td>
<td>string</td>
<td>Información del estado de la transacción [<code>OK</code>, <code>NOT_AUTHORIZED</code>, <code>PENDING</code>, <code>FAILED</code>]</td>
</tr>
<tr>
<td>responseCode</td>
<td>int</td>
<td>Estado de la operación:</td>
</tr>
<tr>
<td></td>
<td></td>
<td>0 = Fallida</td>
</tr>
<tr>
<td></td>
<td></td>
<td>1 = Aprobada</td>
</tr>
<tr>
<td></td>
<td></td>
<td>2 = Rechazada</td>
</tr>
<tr>
<td></td>
<td></td>
<td>3 = Pendiente</td>
</tr>
<tr>
<td>responseReasonCode</td>
<td>string</td>
<td>Código interno de respuesta de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonText</td>
<td>string</td>
<td>Mensaje asociado con el código de respuesta de la operación en Placetopay.</td>
</tr>
<tr>
<td>serviceFeeTransactionState</td>
<td>string</td>
<td>Información del estado de la transacción de la tasa administrativa [<code>OK</code>, <code>NOT_AUTHORIZED</code>, <code>PENDING</code>, <code>FAILED</code>]</td>
</tr>
<tr>
<td>serviceFeeResponseCode</td>
<td>int</td>
<td>Estado de la operación de tasa administrativa:</td>
</tr>
<tr>
<td></td>
<td></td>
<td>0 = Fallida</td>
</tr>
<tr>
<td></td>
<td></td>
<td>1 = Aprobada</td>
</tr>
<tr>
<td></td>
<td></td>
<td>2 = Rechazada</td>
</tr>
<tr>
<td></td>
<td></td>
<td>3 = Pendiente</td>
</tr>
<tr>
<td>serviceFeeResponseReasonCode</td>
<td>string</td>
<td>Código interno de respuesta de la operación en Placetopay para la tasa administrativa.</td>
</tr>
<tr>
<td>serviceFeeResponseReasonText</td>
<td>string</td>
<td>Mensaje asociado con el código de respuesta de la operación en Placetopay para la tasa administrativa.</td>
</tr>
<tr>
<td>serviceFeeAuthorization</td>
<td>string</td>
<td>Número de autorización de la tasa administrativa.</td>
</tr>
<tr>
<td>serviceFeeReceipt</td>
<td>string</td>
<td>Número de recibo de la tasa administrativa.</td>
</tr>
<tr>
<td>additional</td>
<td>Attribute[]</td>
<td>Datos adicionales proporcionados con la transacción.</td>
</tr>
</tbody></table>
<h2 id='webservice-efectivo'>Webservice efectivo</h2>
<p>En esta sesión se describen cada una de los métodos y estructuras que se deben tener presentes para que una transacción por un sitio que integre el medio de pago efectivo se genere adecuadamente.</p>
<h3 id='flujo-de-integracion-efectivo'>Flujo de integración efectivo</h3>
<blockquote>
<p>Ejemplo para integrar un pago en efectivo:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>

  <span class="k">class</span> <span class="nc">Pagos</span> 
  <span class="p">{</span>

      <span class="k">public</span> <span class="k">function</span> <span class="nf">efectivo</span> <span class="p">(){</span>

         <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
         <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s2">"024h1IlD"</span><span class="p">;</span>
         <span class="nv">$trankey</span> <span class="o">=</span> <span class="nx">SHA1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>

         <span class="nv">$servicio</span><span class="o">=</span><span class="s2">"https://test.placetopay.com/soap/cashorder/?wsdl"</span><span class="p">;</span> <span class="c1">//url del servicio
</span>
    <span class="c1">// CREACION DE LA AUTENTICACION
</span>          <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
                <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
                <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
            <span class="p">);</span>

           <span class="nv">$payer</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">'documentType'</span><span class="o">=&gt;</span><span class="s2">"CC"</span><span class="p">,</span>
                        <span class="s1">'document'</span><span class="o">=&gt;</span><span class="s2">"1037390240"</span><span class="p">,</span>
                        <span class="s1">'firstName'</span><span class="o">=&gt;</span><span class="s2">"Juan"</span><span class="p">,</span>
                        <span class="s1">'lastName'</span><span class="o">=&gt;</span><span class="s2">"Chavarria"</span><span class="p">,</span>
                        <span class="s1">'emailAddress'</span><span class="o">=&gt;</span><span class="s2">"soporte9@placetopay.com"</span><span class="p">,</span>
                        <span class="s1">'city'</span><span class="o">=&gt;</span><span class="s2">"Bello"</span><span class="p">,</span>
                        <span class="s1">'province'</span><span class="o">=&gt;</span><span class="s2">"Colombia"</span><span class="p">,</span>
                        <span class="s1">'country'</span><span class="o">=&gt;</span><span class="s2">"Antioquia"</span><span class="p">,</span>
                        <span class="s1">'mobile'</span><span class="o">=&gt;</span><span class="s2">"3104317467"</span>
                    <span class="p">);</span>


           <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">'reference'</span><span class="o">=&gt;</span><span class="s2">"123"</span><span class="p">,</span>
                        <span class="s1">'description'</span><span class="o">=&gt;</span><span class="s2">"prueba efectivo"</span><span class="p">,</span>
                        <span class="s1">'language'</span><span class="o">=&gt;</span><span class="s2">"ES"</span><span class="p">,</span>
                        <span class="s1">'currency'</span><span class="o">=&gt;</span><span class="s2">"COP"</span><span class="p">,</span>
                        <span class="s1">'totalAmount'</span><span class="o">=&gt;</span><span class="mi">1000</span><span class="p">,</span>
                        <span class="s1">'taxAmount'</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span>
                        <span class="s1">'subtotalAmount'</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span>
                        <span class="s1">'expiration'</span><span class="o">=&gt;</span><span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">,</span> <span class="nb">strtotime</span><span class="p">(</span><span class="s1">'+1 hour'</span><span class="p">)),</span>
                        <span class="s1">'buyer'</span><span class="o">=&gt;</span><span class="nv">$payer</span><span class="p">,</span>
                        <span class="s1">'ipAddress'</span><span class="o">=&gt;</span><span class="s2">"192.168.1.12"</span><span class="p">,</span>
                        <span class="s1">'notificationURL'</span><span class="o">=&gt;</span><span class="s2">"http://localhost/API_AIM/Controlador/Respuesta.php"</span>
                    <span class="p">);</span>

            <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                                <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                                <span class="s1">'order'</span><span class="o">=&gt;</span><span class="nv">$transaction</span>
                            <span class="p">);</span>
            <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span>
     <span class="c1">// SE CREA LA ORDEN PARA EL PAGO EN EFECTIVO
</span>        <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'addOrder'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>
        <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$resp</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<ol>
<li>El establecimiento invoca el método <a href="#addorder">addOrder</a> para agregar una orden de pago en efectivo.</li>
<li>Si se desea eliminar una orden de pago se puede invocar al método <a href="#deleteorder">deleteOrder</a>, se debe tener en cuenta que la orden no podrá ser eliminada si ya ha sido pagada.</li>
<li>Eventualmente se puede invocar al método <a href="#flushorders">flushOrders</a> que permite purgar las órdenes de pago que ya están vencidas y que no han sido pagadas.</li>
<li>Para obtener el PDF con las instrucciones para pagar la orden de efectivo se debe invocar el método <a href="#getorderpdf">getOrderPDF</a> que retorna un PDF codificado en Base64.</li>
<li>Para consultar el estado de una transacción se puede invocar el método <a href="#getorder">getOrder</a> el cual brinda todos los datos de la orden incluyendo el estado y si está pagada la información de la transacción.</li>
</ol>
<h3 id='metodos-de-interfaz-efectivo'>Métodos de interfaz efectivo</h3>
<p>A continuación se describen cada una de los métodos de tipo entrada y salida expuestos por el Webservice efectivo, igualmente se muestran los parámetros de entrada a cada operación y vínculos a las estructuras de datos usadas.</p>
<h4 id='addorder'>addOrder</h4>
<blockquote>
<p>Ejemplo para agregar una orden para el pago en efectivo dentro de la integración del mismo:</p>
</blockquote>
<pre class="highlight php tab-php"><code>
<span class="cp">&lt;?php</span>
<span class="o">...</span>
    <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'reference'</span><span class="o">=&gt;</span><span class="s2">"123"</span><span class="p">,</span>
                    <span class="s1">'description'</span><span class="o">=&gt;</span><span class="s2">"prueba efectivo"</span><span class="p">,</span>
                    <span class="s1">'language'</span><span class="o">=&gt;</span><span class="s2">"ES"</span><span class="p">,</span>
                    <span class="s1">'currency'</span><span class="o">=&gt;</span><span class="s2">"COP"</span><span class="p">,</span>
                    <span class="s1">'totalAmount'</span><span class="o">=&gt;</span><span class="mi">1000</span><span class="p">,</span>
                    <span class="s1">'taxAmount'</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'subtotalAmount'</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'expiration'</span><span class="o">=&gt;</span><span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">,</span> <span class="nb">strtotime</span><span class="p">(</span><span class="s1">'+1 hour'</span><span class="p">)),</span>
                    <span class="s1">'buyer'</span><span class="o">=&gt;</span><span class="nv">$payer</span><span class="p">,</span>
                    <span class="s1">'ipAddress'</span><span class="o">=&gt;</span><span class="s2">"192.168.1.12"</span><span class="p">,</span>
                    <span class="s1">'notificationURL'</span><span class="o">=&gt;</span><span class="s2">"http://localhost/API_AIM/Controlador/Respuesta.php"</span>
    <span class="p">);</span>

    <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                        <span class="s1">'order'</span><span class="o">=&gt;</span><span class="nv">$transaction</span>
                    <span class="p">);</span>
    <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span>
    <span class="c1">// SE CREA LA ORDEN PARA EL PAGO EN EFECTIVO
</span>    <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'addOrder'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>

    <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$resp</span><span class="p">);</span>
<span class="o">...</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Agrega una orden de pago para efectivo.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>datos de autenticación</td>
</tr>
<tr>
<td>order</td>
<td><a href="#cashorder">CashOrder</a></td>
<td>datos de la orden de pago</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong>int</strong>. La referencia única de la orden de pago en Placetopay.</p>
<h4 id='getorder'>getOrder</h4>
<p>Obtiene la información de una orden de pago en efectivo para conocer su estado.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación.</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>Referencia única de la orden de pago a consultar.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="cashorderinfo">CashOrderInfo</a></strong>. Información de la orden, si la orden no existe el estado de la orden será NOT_FOUND, si hay un error al consultar el registro se retornará una excepción SoapFault.</p>
<h4 id='deleteorder'>deleteOrder</h4>
<p>Elimina una orden de pago en Placetopay que no haya sido pagada.</p>

<p>PARÁMETROS</p>

<p>Nombre | Tipo | Descripción
auth | <a href="#authentication">Authentication</a> | Datos de autenticación.
id | int | Referencia única de la orden de pago a eliminar.</p>

<p><strong>Retorno</strong> <br>
<strong>int</strong>. Número de registros eliminados, si es un cero indicará que el registro no fue hallado, si hay un error al eliminar el registro se retornará una excepción <code>SoapFault</code>.</p>
<h4 id='flushorders'>flushOrders</h4>
<p>Purga todas las órdenes de pago no pagadas que ya han cumplido la fecha de corte en Placetopay.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong>int</strong>. Número de órdenes de pago eliminadas.</p>
<h4 id='getorderpdf'>getOrderPDF</h4>
<p>Genera el PDF para el pago en efectivo en la red de corresponsales que actualmente se permita. Para la fecha de este documento esta red involucra a corresponsales del grupo AVAL/ATH, Baloto, Efecty, cajas de Almacenes Éxito, Carulla, Surtimax y Súper Inter.  Así como cajeros electrónicos del grupo AVAL. Próximamente la red de oficinas de Bancolombia.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación.</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>Referencia única de la orden de pago generada.</td>
</tr>
</tbody></table>

<p><strong>Retorno</strong> <br>
<strong>base64Binary</strong>. PDF generado codificado como base64, si hay un error al generar el PDF se retornará una excepción <code>SoapFault</code>.</p>
<h3 id='estructuras-de-informacion-efectivo'>Estructuras de información efectivo</h3>
<p>En este apartado se describen cada una de las estructuras de datos usadas por los métodos del Webservice efectivo.</p>
<h4 id='attribute'>Attribute</h4>
<p>Estructura para almacenar información extendida.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string[30]</td>
<td>Código para referenciar el atributo.</td>
</tr>
<tr>
<td>value</td>
<td>string[255]</td>
<td>Valor que asume el atributo.</td>
</tr>
</tbody></table>
<h4 id='persona'>Persona</h4>
<blockquote>
<p>Ejemplo de generación de una estructura Person dentro de la integración de pago en efectivo:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="o">...</span>
    <span class="nv">$payer</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">'documentType'</span><span class="o">=&gt;</span><span class="s2">"CC"</span><span class="p">,</span>
                        <span class="s1">'document'</span><span class="o">=&gt;</span><span class="s2">"1037390240"</span><span class="p">,</span>
                        <span class="s1">'firstName'</span><span class="o">=&gt;</span><span class="s2">"Juan"</span><span class="p">,</span>
                        <span class="s1">'lastName'</span><span class="o">=&gt;</span><span class="s2">"Chavarria"</span><span class="p">,</span>
                        <span class="s1">'emailAddress'</span><span class="o">=&gt;</span><span class="s2">"soporte9@placetopay.com"</span><span class="p">,</span>
                        <span class="s1">'city'</span><span class="o">=&gt;</span><span class="s2">"Bello"</span><span class="p">,</span>
                        <span class="s1">'province'</span><span class="o">=&gt;</span><span class="s2">"Colombia"</span><span class="p">,</span>
                        <span class="s1">'country'</span><span class="o">=&gt;</span><span class="s2">"Antioquia"</span><span class="p">,</span>
                        <span class="s1">'mobile'</span><span class="o">=&gt;</span><span class="s2">"3104317467"</span>
                    <span class="p">);</span>
<span class="o">...</span>  
<span class="cp">?&gt;</span>                  
</code></pre>
<p>Estructura para reflejar la información de una persona involucrada en una orden de pago.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>string[12]</td>
<td>Número de identificación de la persona.</td>
</tr>
<tr>
<td>documentType</td>
<td>string[3]</td>
<td>Tipo de documento de identificación de la persona.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>CC = Cédula de ciudadanía colombiana</td>
</tr>
<tr>
<td></td>
<td></td>
<td>CE = Cédula de extranjería</td>
</tr>
<tr>
<td></td>
<td></td>
<td>TI = Tarjeta de identidad</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PPN = Pasaporte</td>
</tr>
<tr>
<td></td>
<td></td>
<td>NIT = Número de identificación tributaria</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SSN = Social Security Number</td>
</tr>
<tr>
<td>firstName</td>
<td>string[60]</td>
<td>Nombres</td>
</tr>
<tr>
<td>lastName</td>
<td>string[60]</td>
<td>Apellidos</td>
</tr>
<tr>
<td>company</td>
<td>string[60]</td>
<td>Nombre de la compañía en la cual labora o representa.</td>
</tr>
<tr>
<td>emailAddress</td>
<td>string[80]</td>
<td>Correo electrónico.</td>
</tr>
<tr>
<td>address</td>
<td>string[100]</td>
<td>Dirección postal completa.</td>
</tr>
<tr>
<td>city</td>
<td>string[50]</td>
<td>Nombre de la ciudad coincidente con la dirección.</td>
</tr>
<tr>
<td>province</td>
<td>string[50]</td>
<td>Nombre de la provincia o departamento coincidente con la dirección.</td>
</tr>
<tr>
<td>country</td>
<td>string[2]</td>
<td>Código internacional del país que aplica a la dirección física acorde a <a href="https://es.wikipedia.org/wiki/ISO_3166-1">ISO 3166-1</a>, mayúscula sostenida.</td>
</tr>
<tr>
<td>phone</td>
<td>string[30]</td>
<td>Número de telefonía fija.</td>
</tr>
<tr>
<td>mobile</td>
<td>string[30]</td>
<td>Número de telefonía móvil o celular.</td>
</tr>
</tbody></table>
<h4 id='cashorder'>CashOrder</h4>
<blockquote>
<p>Ejemplo de generación de una estructura CashOrder dentro de la integración de pago en efectivo:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="o">...</span>
    <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'reference'</span><span class="o">=&gt;</span><span class="s2">"123"</span><span class="p">,</span>
                    <span class="s1">'description'</span><span class="o">=&gt;</span><span class="s2">"prueba efectivo"</span><span class="p">,</span>
                    <span class="s1">'language'</span><span class="o">=&gt;</span><span class="s2">"ES"</span><span class="p">,</span>
                    <span class="s1">'currency'</span><span class="o">=&gt;</span><span class="s2">"COP"</span><span class="p">,</span>
                    <span class="s1">'totalAmount'</span><span class="o">=&gt;</span><span class="mi">1000</span><span class="p">,</span>
                    <span class="s1">'taxAmount'</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'subtotalAmount'</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'expiration'</span><span class="o">=&gt;</span><span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">,</span> <span class="nb">strtotime</span><span class="p">(</span><span class="s1">'+1 hour'</span><span class="p">)),</span>
                    <span class="s1">'buyer'</span><span class="o">=&gt;</span><span class="nv">$payer</span><span class="p">,</span>
                    <span class="s1">'ipAddress'</span><span class="o">=&gt;</span><span class="s2">"192.168.1.12"</span><span class="p">,</span>
                    <span class="s1">'notificationURL'</span><span class="o">=&gt;</span><span class="s2">"http://localhost/API_AIM/Controlador/Respuesta.php"</span>
    <span class="p">);</span>
<span class="o">...</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Estructura con la información de una orden de pago en efectivo.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>reference</td>
<td>string[32]</td>
<td>Referencia única de pago.</td>
</tr>
<tr>
<td>description</td>
<td>string[255]</td>
<td>Descripción o detalle de la orden de pago.</td>
</tr>
<tr>
<td>language</td>
<td>string[2]</td>
<td>Idioma esperado para las transacciones acorde a <a href="https://es.wikipedia.org/wiki/ISO_639-1">ISO 631-1</a>, usar ES.</td>
</tr>
<tr>
<td>currency</td>
<td>string[3]</td>
<td>Código de la moneda acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a> en la cual está expresado el cobro, usar COP.</td>
</tr>
<tr>
<td>totalAmount</td>
<td>decimal</td>
<td>Valor total a recaudar.</td>
</tr>
<tr>
<td>taxAmount</td>
<td>decimal</td>
<td>Discriminación del impuesto aplicado.</td>
</tr>
<tr>
<td>subtotalAmount</td>
<td>decimal</td>
<td>Valor base antes de impuestos.</td>
</tr>
<tr>
<td>expiration</td>
<td>datetime</td>
<td>Fecha y hora máxima hasta la cual se recibe el pago [AAAA-MM-DDTHH:NN:SS]</td>
</tr>
<tr>
<td>buyer</td>
<td><a href="#persona">Person</a></td>
<td>Información del comprador.</td>
</tr>
<tr>
<td>ipAddress</td>
<td>string</td>
<td>Dirección IP desde la cual realiza la solicitud el pagador.</td>
</tr>
<tr>
<td>userAgent</td>
<td>string</td>
<td>Agente de navegación utilizado por el pagador al hacer la solicitud.</td>
</tr>
<tr>
<td>additionalData</td>
<td><a href="#attribute">Attribute[]</a></td>
<td>Datos adicionales para ser almacenados con la transacción.</td>
</tr>
<tr>
<td>notificationURL</td>
<td>string[255]</td>
<td>URL de notificación una vez la transacción es realizada.</td>
</tr>
</tbody></table>
<h4 id='transaction'>Transaction</h4>
<p>Estructura con la información de la transacción asociada a la orden de pago.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>paymentMethod</td>
<td>string[5]</td>
<td>Código del medio de pago.</td>
</tr>
<tr>
<td>paymentMethodName</td>
<td>string[128]</td>
<td>Nombre del medio de pago.</td>
</tr>
<tr>
<td>amount</td>
<td>decimal</td>
<td>Valor recaudado.</td>
</tr>
<tr>
<td>authorization</td>
<td>string[40]</td>
<td>Número de autorización.</td>
</tr>
<tr>
<td>receipt</td>
<td>string[40]</td>
<td>Número de recibo en la red.</td>
</tr>
</tbody></table>
<h4 id='cashorderinfo'>CashOrderInfo</h4>
<p>Estructura con la información de una orden de pago en efectivo y la información de la transacción si existe. Hereda todos los atributos de <a href="#cashorder">CashOrder</a> y agrega las propiedades que se enuncian a continuación.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>string</td>
<td>Estado actual de la orden: NOT_FOUND, PENDING, EXPIRED, PAYED, PAYED_PARTIAL, REFUNDED</td>
</tr>
<tr>
<td>status_date</td>
<td>dateTime</td>
<td>Fecha y hora desde la cual se encuentra en el estado.</td>
</tr>
<tr>
<td>transaction</td>
<td><a href="#transaction">Transaction</a></td>
<td>Información de la transacción cuando el estado es pagado.</td>
</tr>
</tbody></table>
<h2 id='webservice-pse'>Webservice PSE</h2>
<p>A continuación se describen cada uno de los elementos y posibles situaciones que se deben tener presentes para que una transacción por tu sitio con el medio de pago PSE sea exitosa.</p>
<h3 id='flujo-de-integracion-pse'>Flujo de integración PSE</h3>
<blockquote>
<p>Ejemplo para integrar un pago con PSE:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
     <span class="k">class</span> <span class="nc">Pagos</span>
       <span class="p">{</span>
       <span class="k">public</span> <span class="k">function</span> <span class="nf">bancos</span><span class="p">()</span>
       <span class="p">{</span>
              <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
              <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s1">'024h1IlD'</span><span class="p">;</span>
              <span class="nv">$trankey</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>

              <span class="nv">$servicio</span> <span class="o">=</span> <span class="s1">'https://test.placetopay.com/soap/pse/v11/?wsdl'</span><span class="p">;</span> <span class="c1">//url del servicio
</span>              <span class="c1">//AUTENTICACION
</span>              <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
              <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
              <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
              <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
              <span class="p">);</span>

              <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                     <span class="p">);</span>
              <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span> <span class="c1">// en lugar de SoapClient  se utiliza nusoap_client
</span>              <span class="c1">// LAMADA AL METODO GETBANKLIST DE PSE
</span>              <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'getBankList'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>

              <span class="nv">$resp1</span> <span class="o">=</span> <span class="nv">$resp</span><span class="p">[</span><span class="s1">'getBankListResult'</span><span class="p">][</span><span class="s1">'item'</span><span class="p">];</span>

              <span class="k">echo</span> <span class="s1">'&lt;h5&gt;Seleccione su banco &lt;/h5&gt;&lt;br&gt;
               &lt;select name="banco" id="bank" class="form-control" onchange ="r();"&gt;'</span><span class="p">;</span>
              <span class="c1">// SE RECORRE EL ARRAY PARA LISTAR BANCOS
</span>              <span class="k">foreach</span> <span class="p">(</span><span class="nv">$resp1</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">echo</span> <span class="s1">'&lt;option value="'</span><span class="o">.</span><span class="nv">$valor</span><span class="p">[</span><span class="s1">'bankCode'</span><span class="p">]</span><span class="o">.</span><span class="s1">'"&gt;'</span><span class="o">.</span><span class="nv">$valor</span><span class="p">[</span><span class="s1">'bankName'</span><span class="p">]</span><span class="o">.</span><span class="s1">'&lt;/option&gt;'</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">echo</span> <span class="s1">'&lt;/select&gt;'</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="k">public</span> <span class="k">function</span> <span class="nf">RealizarPago</span><span class="p">()</span>
       <span class="p">{</span>
              <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
              <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s1">'024h1IlD'</span><span class="p">;</span>
              <span class="nv">$trankey</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>
              <span class="c1">//PAGO POR PSE
</span>              <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'banco'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'banco'</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$banco</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'banco'</span><span class="p">];</span>
              <span class="nv">$servicio</span> <span class="o">=</span> <span class="s1">'https://test.placetopay.com/soap/pse/v11/?wsdl'</span><span class="p">;</span> <span class="c1">//url del servicio
</span>
              <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
              <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
              <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
              <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
              <span class="p">);</span>
              <span class="nv">$payer</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'documentType'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'tipdoc'</span><span class="p">],</span>
                     <span class="s1">'document'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'cedula'</span><span class="p">],</span>
                     <span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'nombre'</span><span class="p">],</span>
                     <span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'apellido'</span><span class="p">],</span>
                     <span class="s1">'emailAddress'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'correo'</span><span class="p">],</span>
                     <span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'ciudad'</span><span class="p">],</span>
                     <span class="s1">'province'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'pais'</span><span class="p">],</span>
                     <span class="s1">'country'</span> <span class="o">=&gt;</span> <span class="s1">'Antioquia'</span><span class="p">,</span>
                     <span class="s1">'mobile'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'telefono'</span><span class="p">],</span>
                     <span class="p">);</span>

              <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'bankCode'</span> <span class="o">=&gt;</span> <span class="nv">$banco</span><span class="p">,</span>
                     <span class="s1">'bankInterface'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'returnURL'</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/API_AIM/Controlador/RespuestaPSE.php'</span><span class="p">,</span>
                     <span class="s1">'reference'</span> <span class="o">=&gt;</span> <span class="nv">$reference</span> <span class="o">=</span> <span class="nb">time</span><span class="p">(),</span>
                     <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Pago'</span><span class="p">,</span>
                     <span class="s1">'language'</span> <span class="o">=&gt;</span> <span class="s1">'ES'</span><span class="p">,</span>
                     <span class="s1">'currency'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'moneda'</span><span class="p">],</span>
                     <span class="s1">'totalAmount'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'total'</span><span class="p">],</span>
                     <span class="s1">'taxAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'devolutionBase'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'tipAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'payer'</span> <span class="o">=&gt;</span> <span class="nv">$payer</span><span class="p">,</span>
                     <span class="s1">'ipAddress'</span> <span class="o">=&gt;</span> <span class="s1">'192.168.1.12'</span><span class="p">,</span>
                     <span class="p">);</span>
              <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                     <span class="s1">'transaction'</span> <span class="o">=&gt;</span> <span class="nv">$transaction</span><span class="p">,</span>
                     <span class="p">);</span>
              <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span>
              <span class="c1">// SE CREA LA TRANSACCION PARA PAGO POR PSE
</span>              <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'createTransaction'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>

              <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$resp</span><span class="p">);</span>

              <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'transactionId'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'transactionID'</span><span class="p">];</span>
              <span class="c1">//REDIRECCION AL PSE
</span>              <span class="k">echo</span> <span class="s1">'&lt;script&gt;
              window.location = "'</span><span class="o">.</span><span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'bankURL'</span><span class="p">]</span><span class="o">.</span><span class="s1">'";
       &lt;/script&gt;'</span><span class="p">;</span>
       <span class="p">}</span>
    <span class="p">}</span>
 <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre>
<p><em>¿Cómo funciona la implementación?</em></p>

<ol>
<li>Se muestra como opción de pago PSE (Débitos a cuentas de ahorro y corriente en Colombia).</li>
<li>Una vez el usuario la selecciona, se presenta la lista de bancos (debe estar cacheada localmente y su refrescamiento debe ser 1 vez por día) y el tipo de banca a desplegar (personas o empresas).</li>
<li>Al tiempo que el cliente confirma la operación, debe consumirse el servicio para realizar la petición de la transacción.</li>
<li>Si la petición es exitosa se retorna la URL a la cual debe enviarse al cliente para que realice la operación en el banco. En caso contrario se retorna el motivo del rechazo de la transacción.</li>
<li>Almacenar los datos de la transacción retornados por el servicio (identificador de la transacción, autorización/cus, identificador sesión de placetopay).</li>
<li>Redirigir el navegador a la URL retornada en caso de éxito.</li>
<li>Una vez la transacción retorna a la URL especificada en el consumo de crear transacción, se debe preguntar por el estado de la transacción mediante el consumo un servicio.</li>
<li>Dependiendo de la respuesta del servicio, la transacción puede haber sido aprobada, rechazada o seguir pendiente de procesamiento.</li>
<li>Informar al usuario el estado de la transacción.</li>
<li>Si la transacción está pendiente, o si el cliente al abandonar el portal no ha regresado, se debe tener una sonda que pregunte por el estado de la transacción.</li>
</ol>
<h4 id='despliegue-de-bancos-disponibles'>Despliegue de bancos disponibles</h4>
<p>Una vez el cliente ha determinado que desea pagar con débito a una cuenta corriente o de ahorros, deberá presentarle la lista de los bancos que en el momento están disponibles para la transacción.  Esta lista de bancos se obtiene mediante el consumo del método <a href="#getbanklist">getBankList</a> el cual debe ser consumido una vez por día, lo que exige que se disponga de un mecanismo de caché que permita recuperar la lista de este si ya ha sido consumido el servicio en el día.</p>

<p>Adicional a darle a escoger con qué banco realizar la transacción, el usuario también debe indicar qué tipo de interfaz del banco desea desplegar, es decir, si la de personas o la de empresas.</p>

<p>Si por algún motivo la lista de bancos no pudo ser obtenida, deberá mostrarse un mensaje “No se pudo obtener la lista de Entidades Financieras, por favor intente más tarde” y, consumir nuevamente el servicio de lista de bancos para intentar obtener dicha lista y poderla almacenar en el caché.</p>

<p>Tenga en cuenta que en operaciones de Multicrédito se debe utilizar el código de servicio para multicrédito y que siempre deberá pasar todas las cuentas dependientes (entidad, servicio) para los créditos así algunas de ellas vayan con valores en cero.  Es requerido que la lista de créditos corresponda con todos los subcódigos dependientes.</p>
<h4 id='confirmacion-y-redireccion-al-banco'>Confirmación y redirección al banco</h4>
<p>Una vez se poseen los datos del pagador y/o comprador, así como la información de qué banco y qué tipo de interfaz debe mostrar el banco deberá entonces consumir el servicio de <a href="#createTransaction">createTransaction</a> para obtener la URL a la cual deberá redirigir al cliente para finalizar la transacción.</p>

<p>Debe tener en cuenta que en los datos solicitados para crear la transacción se requiere la dirección IP desde la cual el cliente está realizando la transacción, así como la información del agente de navegación usado.  Si lo desea, también puede proveer datos adicionales con la transacción, los cuales le permitirán tener esta información disponible en la consola de consulta de transacciones de Placetopay.</p>

<p>Si la respuesta del servicio es SUCCESS, entonces deberá almacenar la información retornada en su base de datos, de vital importancia el <code>transactionId</code> pues es con este identificador que podrá consultar el estado final de la transacción.</p>

<p>Tenga en cuenta que una respuesta SUCCESS en este punto sólo implica que la transacción ha sido aprovisionada por el banco y está en espera que el cliente llegue a la interfaz del banco, se autentique y autorice la operación iniciada.</p>

<p>Al crear la transacción, esta puede fallar; algunos motivos incluyen montos por fuera del rango permitido, no disponibilidad del banco, problemas de configuración de la cuenta recaudadora, entre otros.  Utilice la propiedad <code>responseReasonText</code> para obtener el mensaje de por qué falló la creación de la transacción.
Algunos códigos no relacionados con el pagador pueden indicarle que genere una alerta sobre problemas con la disponibilidad del servicio, particularmente los relacionados con mala configuración.</p>

<p>Una vez ha almacenado la información en su base de datos y ha confirmado que es exitosa la petición, se redirigirá al cliente a la URL del banco.  Tenga en cuenta que la redirección a la interfaz del banco no debe realizarse en un frame o cualquier otro mecanismo que oculte la URL en la cual el cliente ingresará sus datos de autenticación.</p>
<h4 id='reingreso-del-cliente'>Reingreso del cliente</h4>
<p>Una vez el cliente ha finalizado la transacción en la interfaz del banco, el banco redirige al cliente a la URL especificada al crear la transacción, en este punto de entrada a su aplicativo, usted deberá consumir el servicio <a href="#gettransactioninformation">getTransactionInformation</a> que le permite determinar el estado de la transacción. Solo si la transacción tiene como estado OK es porque la transacción fue autorizada, si por el contrario obtiene un estado PENDING es porque aún no tiene respuesta final del banco acerca de la transacción.</p>

<p>Ya sea que el cliente retorne al punto de reingreso y que la transacción esté pendiente, o que haya abandonado la operación y haya roto el flujo normal, se deberá consumir el servicio <a href="#gettransactioninformation">getTransactionInformation</a> para todas las operaciones que desde que fue invocado el <a href="#createtransaction">createTransaction</a> llevan más de 7 minutos sin un estado final de operación.</p>
<h3 id='metodos-de-interfaz-pse'>Métodos de interfaz PSE</h3>
<p>A continuación se describen cada una de los métodos de tipo petición respuesta expuestas por el Webservice, se muestran los parámetros de entrada a cada operación y vínculos a las estructuras de datos usadas.</p>
<h4 id='getbanklist'>getBankList</h4>
<blockquote>
<p>Ejemplo para realizar una llamada al método getBankList:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
       <span class="k">public</span> <span class="k">function</span> <span class="nf">bancos</span><span class="p">()</span>
       <span class="p">{</span>
              <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
              <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s1">'024h1IlD'</span><span class="p">;</span>
              <span class="nv">$trankey</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>

              <span class="nv">$servicio</span> <span class="o">=</span> <span class="s1">'https://test.placetopay.com/soap/pse/v11/?wsdl'</span><span class="p">;</span> <span class="c1">//url del servicio
</span>              <span class="c1">//AUTENTICACION
</span>              <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
              <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
              <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
              <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
              <span class="p">);</span>

              <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                     <span class="p">);</span>
              <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span> <span class="c1">// en lugar de SoapClient  se utiliza nusoap_client
</span>              <span class="c1">// LAMADA AL METODO GETBANKLIST DE PSE
</span>              <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'getBankList'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>

              <span class="nv">$resp1</span> <span class="o">=</span> <span class="nv">$resp</span><span class="p">[</span><span class="s1">'getBankListResult'</span><span class="p">][</span><span class="s1">'item'</span><span class="p">];</span>

              <span class="k">echo</span> <span class="s1">'&lt;h5&gt;Seleccione su banco &lt;/h5&gt;&lt;br&gt;
               &lt;select name="banco" id="bank" class="form-control" onchange ="r();"&gt;'</span><span class="p">;</span>
              <span class="c1">// SE RECORRE EL ARRAY PARA LISTAR BANCOS
</span>              <span class="k">foreach</span> <span class="p">(</span><span class="nv">$resp1</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">echo</span> <span class="s1">'&lt;option value="'</span><span class="o">.</span><span class="nv">$valor</span><span class="p">[</span><span class="s1">'bankCode'</span><span class="p">]</span><span class="o">.</span><span class="s1">'"&gt;'</span><span class="o">.</span><span class="nv">$valor</span><span class="p">[</span><span class="s1">'bankName'</span><span class="p">]</span><span class="o">.</span><span class="s1">'&lt;/option&gt;'</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">echo</span> <span class="s1">'&lt;/select&gt;'</span><span class="p">;</span>
       <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Obtiene la lista de bancos disponibles para el establecimiento de comercio en el sistema PSE de ACH Colombia.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#bank">Bank[]</a>.</strong> Un arreglo con la lista de bancos habilitados.</p>

<aside class="notice">
La respuesta de este servicio debe ser cacheada.
</aside>

<aside class="notice">
El servicio debe ser consumido una vez por día.
</aside>
<h4 id='createtransaction'>createTransaction</h4>
<p>Solicita la creación de una transacción.  En los datos de la solicitud se especifica quién es el pagador, el comprador y el despacho.  Así mismo para cuál de los bancos habilitados se hace la petición y a que URL de retorno debe el banco redirigir al cuentahabiente.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación</td>
</tr>
<tr>
<td>transaction</td>
<td><a href="#psetransactionrequest">PSETransactionRequest</a></td>
<td>Datos de la solicitud</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#psetransactionresponse">PSETransactionResponse</a></strong>. Respuesta de la creación de la transacción, tenga en cuenta que la URL del banco se entrega solo si la propiedad returnCode es <code>SUCCESS</code>.</p>
<h4 id='createtransactionmulticredit'>createTransactionMultiCredit</h4>
<p>Solicita la creación de una transacción con dispersión de fondos.  En los datos de la solicitud se especifica quién es el pagador, el comprador y el despacho.  Así mismo para cuál de los bancos habilitados se hace la petición y a que URL de retorno debe el banco redirigir al cuentahabiente.  Así como cada uno de los créditos a aplicar para cada uno de los servicios asociados.  Tenga en cuenta que un servicio multicrédito tiene asociado unos servicios dependientes.  Siempre deberá cobrar a todos los servicios dependientes así el valor para una de los créditos sea cero.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación</td>
</tr>
<tr>
<td>transaction</td>
<td><a href="#psetransactionmulticreditrequest">PSETransactionMultiCreditRequest</a></td>
<td>Datos de la solicitud</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="psetransactionresponse">PSETransactionResponse</a></strong>. Respuesta de la creación de la transacción, tenga en cuenta que la URL del banco se entrega solo si la propiedad <code>returnCode</code> es <code>SUCCESS</code>.</p>
<h4 id='gettransactioninformation'>getTransactionInformation</h4>
<blockquote>
<p>Ejemplo para generar una respuesta de una transacción PSE utilizando el método getTransactionInformation:</p>
</blockquote>
<pre class="highlight php tab-php"><code>  <span class="cp">&lt;?php</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">))</span>
       <span class="p">{</span>
       <span class="nb">session_start</span><span class="p">();</span>
       <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"transactionId"</span><span class="p">]))</span> 
              <span class="p">{</span>
              <span class="k">require_once</span><span class="p">(</span><span class="s1">'../nusoap/lib/nusoap.php'</span><span class="p">);</span>

              <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"transactionId"</span><span class="p">];</span> <span class="c1">//'1476515432' $_SESSION["transactionId"]
</span>
              <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
              <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s2">"024h1IlD"</span><span class="p">;</span>
              <span class="nv">$trankey</span> <span class="o">=</span> <span class="nx">SHA1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>
              <span class="nv">$servicio</span><span class="o">=</span><span class="s2">"https://test.placetopay.com/soap/pse/v11/?wsdl"</span><span class="p">;</span> <span class="c1">//url del servicio
</span>
              <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
                     <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
                     <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
                     <span class="p">);</span>

              <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                            <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                            <span class="s1">'transactionID'</span><span class="o">=&gt;</span><span class="nv">$id</span>
                            <span class="p">);</span>
              <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span>

              <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'getTransactionInformation'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>
              <span class="c1">//var_dump($resp);
</span>              <span class="k">foreach</span> <span class="p">(</span><span class="nv">$resp</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> 
              <span class="p">{</span>
                     <span class="nv">$reason</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">[</span><span class="s2">"responseReasonText"</span><span class="p">];</span>
                     <span class="nv">$reference</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">[</span><span class="s2">"reference"</span><span class="p">];</span>
                     <span class="nv">$estado</span>  <span class="o">=</span>  <span class="nv">$valor</span><span class="p">[</span><span class="s2">"transactionState"</span><span class="p">];</span>
              <span class="p">}</span>
              <span class="k">echo</span> <span class="s1">'&lt;div class="card m-t-25 "&gt;
                                   &lt;div class="card-body"&gt;
                                          &lt;div class="row"&gt;
                                                 &lt;div class="col-md-6"&gt;
                                                 &lt;h4&gt;Referencia :'</span><span class="o">.</span><span class="nv">$reference</span><span class="o">.</span><span class="s1">' &lt;/h4&gt;

                                                 &lt;h4&gt;Estado :'</span><span class="o">.</span><span class="nv">$estado</span><span class="o">.</span><span class="s1">' &lt;/h4&gt;

                                                 &lt;h4&gt;Razon :'</span><span class="o">.</span><span class="nv">$reason</span><span class="o">.</span><span class="s1">' &lt;/h4&gt;
                                                 &lt;/div&gt;
                                          &lt;/div&gt;
                                   &lt;/div&gt;
                            &lt;/div&gt;'</span><span class="p">;</span>

              <span class="nb">session_destroy</span><span class="p">();</span>
              <span class="p">}</span>
<span class="o">&lt;?</span><span class="nx">php</span>
</code></pre>
<p>Obtiene la información de una transacción, debe ser consultado para cualquier operación previamente creada con el método <a href="#createtransaction">createTransaction</a> o <a href="#createtransactionmulticredit">createTransactionMultiCredit</a> ya sea cuando regresa del banco o cuando al menos han transcurrido 7 minutos desde que el cliente fue redirigido a la interfaz del banco. Deberá consumirse en intervalos de al menos cada 12 minutos hasta que tenga un estado de transacción <code>diferente</code> a <code>PENDING</code>.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación</td>
</tr>
<tr>
<td>transactionID</td>
<td>int</td>
<td>Identificador único de la transacción en Placetopay, equivale al retornado en la creación de la transacción.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#transactioninformation">TransactionInformation</a></strong>. Información del estado de la transacción.</p>
<h3 id='estructuras-de-datos-pse'>Estructuras de datos PSE</h3>
<p>Las estructuras de datos utilizadas por los métodos del servicio web se describen a continuación:</p>
<h4 id='attribute'>Attribute</h4>
<p>Estructura para almacenar información extendida.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string[30]</td>
<td>Código para referenciar el atributo</td>
</tr>
<tr>
<td>value</td>
<td>string[128]</td>
<td>Valor que asume el atributo</td>
</tr>
</tbody></table>
<h4 id='persona'>Persona</h4>
<blockquote>
<p>Ejemplo de generación de una estructura Person dentro de la integración de pago con PSE:</p>
</blockquote>
<pre class="highlight php tab-php"><code>  <span class="cp">&lt;?php</span>
       <span class="nv">$payer</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'documentType'</span> <span class="o">=&gt;</span> <span class="s1">'CC'</span><span class="p">,</span>
                    <span class="s1">'document'</span> <span class="o">=&gt;</span> <span class="s1">'1037390240'</span><span class="p">,</span>
                    <span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="s1">'Juan'</span><span class="p">,</span>
                    <span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="s1">'Chavarria'</span><span class="p">,</span>
                    <span class="s1">'emailAddress'</span> <span class="o">=&gt;</span> <span class="s1">'soporte9@placetopay.com'</span><span class="p">,</span>
                    <span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="s1">'Bello'</span><span class="p">,</span>
                    <span class="s1">'province'</span> <span class="o">=&gt;</span> <span class="s1">'Colombia'</span><span class="p">,</span>
                    <span class="s1">'country'</span> <span class="o">=&gt;</span> <span class="s1">'Antioquia'</span><span class="p">,</span>
                    <span class="s1">'mobile'</span> <span class="o">=&gt;</span> <span class="s1">'3104317467'</span><span class="p">,</span>
                <span class="p">);</span>
  <span class="cp">?&gt;</span>
</code></pre>
<p>Estructura para reflejar la información de una persona involucrada en una transacción.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>string[12]</td>
<td>Número de identificación de la persona.</td>
</tr>
<tr>
<td>documentType</td>
<td>string[3]</td>
<td>Tipo de documento de identificación de la persona.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>CC = Cédula de ciudadanía colombiana</td>
</tr>
<tr>
<td></td>
<td></td>
<td>CE = Cédula de extranjería</td>
</tr>
<tr>
<td></td>
<td></td>
<td>TI = Tarjeta de identidad</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PPN = Pasaporte</td>
</tr>
<tr>
<td></td>
<td></td>
<td>NIT = Número de identificación tributaria</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SSN = Social Security Number</td>
</tr>
<tr>
<td>firstName</td>
<td>string[60]</td>
<td>Nombres</td>
</tr>
<tr>
<td>lastName</td>
<td>string[60]</td>
<td>Apellidos</td>
</tr>
<tr>
<td>company</td>
<td>string[60]</td>
<td>Nombre de la compañía en la cual labora o representa.</td>
</tr>
<tr>
<td>emailAddress</td>
<td>string[80]</td>
<td>Correo electrónico.</td>
</tr>
<tr>
<td>address</td>
<td>string[100]</td>
<td>Dirección postal completa.</td>
</tr>
<tr>
<td>city</td>
<td>string[50]</td>
<td>Nombre de la ciudad coincidente con la dirección.</td>
</tr>
<tr>
<td>province</td>
<td>string[50]</td>
<td>Nombre de la provincia o departamento coincidente con la dirección.</td>
</tr>
<tr>
<td>country</td>
<td>string[2]</td>
<td>Código internacional del país que aplica a la dirección física acorde a <a href="https://es.wikipedia.org/wiki/ISO_3166-1">ISO 3166-1</a>, mayúscula sostenida.</td>
</tr>
<tr>
<td>phone</td>
<td>string[30]</td>
<td>Número de telefonía fija.</td>
</tr>
<tr>
<td>mobile</td>
<td>string[30]</td>
<td>Número de telefonía móvil o celular.</td>
</tr>
</tbody></table>
<h4 id='bank'>Bank</h4>
<p>Estructura para reflejar la información de una entidad bancaria.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>bankCode</td>
<td>string[4]</td>
<td>Código de la entidad financiera.</td>
</tr>
<tr>
<td>bankName</td>
<td>string[60]</td>
<td>Nombre de la entidad financiera.</td>
</tr>
</tbody></table>
<h4 id='creditconcept'>CreditConcept</h4>
<p>Estructura que representa el concepto del crédito a favor de un tercero. </p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>entityCode</td>
<td>string[12]</td>
<td>Código de la entidad del tercero para dispersión.</td>
</tr>
<tr>
<td>serviceCode</td>
<td>string[12]</td>
<td>Código del servicio del tercero.</td>
</tr>
<tr>
<td>amountValue</td>
<td>double</td>
<td>Valor total a recaudar a favor de la entidad.</td>
</tr>
<tr>
<td>taxValue</td>
<td>double</td>
<td>Discriminación del impuesto aplicado a favor de la entidad.</td>
</tr>
<tr>
<td>description</td>
<td>string[60]</td>
<td>Descripción el concepto cobrado.</td>
</tr>
</tbody></table>
<h4 id='psetransactionrequest'>PSETransactionRequest</h4>
<blockquote>
<p>Ejemplo de generación de una estructura PSETransactionRequest dentro de la integración de pago con PSE:</p>
</blockquote>
<pre class="highlight php tab-php"><code>  <span class="cp">&lt;?php</span>
              <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                     <span class="s1">'bankCode'</span> <span class="o">=&gt;</span> <span class="nv">$banco</span><span class="p">,</span>
                     <span class="s1">'bankInterface'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'returnURL'</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/API_AIM/Controlador/RespuestaPSE.php'</span><span class="p">,</span>
                     <span class="s1">'reference'</span> <span class="o">=&gt;</span> <span class="nv">$reference</span> <span class="o">=</span> <span class="nb">time</span><span class="p">(),</span>
                     <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Pago'</span><span class="p">,</span>
                     <span class="s1">'language'</span> <span class="o">=&gt;</span> <span class="s1">'ES'</span><span class="p">,</span>
                     <span class="s1">'currency'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'moneda'</span><span class="p">],</span>
                     <span class="s1">'totalAmount'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'total'</span><span class="p">],</span>
                     <span class="s1">'taxAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'devolutionBase'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'tipAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="s1">'payer'</span> <span class="o">=&gt;</span> <span class="nv">$payer</span><span class="p">,</span>
                     <span class="s1">'ipAddress'</span> <span class="o">=&gt;</span> <span class="s1">'192.168.1.12'</span><span class="p">,</span>
              <span class="p">);</span>
  <span class="cp">?&gt;</span>
</code></pre>
<p>Estructura que representa una solicitud de transacción con débitos a cuenta PSE.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>bankCode</td>
<td>string[4]</td>
<td>Código de la entidad financiera con la cual realizar la transacción.</td>
</tr>
<tr>
<td>bankInterface</td>
<td>string[1]</td>
<td>Tipo de interfaz del banco a desplegar <code>0 = PERSONAS, 1 = EMPRESAS]</code></td>
</tr>
<tr>
<td>returnURL</td>
<td>string[255]</td>
<td>URL de retorno especificada para la entidad financiera.</td>
</tr>
<tr>
<td>reference</td>
<td>string[32]</td>
<td>Referencia única de pago.</td>
</tr>
<tr>
<td>description</td>
<td>string[255]</td>
<td>Descripción del pago.</td>
</tr>
<tr>
<td>language</td>
<td>string[2]</td>
<td>Idioma esperado para las transacciones acorde a <a href="https://es.wikipedia.org/wiki/ISO_639-1">ISO 631-1</a>, mayúscula sostenida.</td>
</tr>
<tr>
<td>currency</td>
<td>string[3]</td>
<td>Moneda a usar para el recaudo acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a>.</td>
</tr>
<tr>
<td>totalAmount</td>
<td>double</td>
<td>Valor total a recaudar.</td>
</tr>
<tr>
<td>taxAmount</td>
<td>double</td>
<td>Discriminación del impuesto aplicado.</td>
</tr>
<tr>
<td>devolutionBase</td>
<td>double</td>
<td>Base de devolución para el impuesto.</td>
</tr>
<tr>
<td>tipAmount</td>
<td>double</td>
<td>Propina u otros valores exentos de impuesto (tasa aeroportuaria) y que deben agregarse al valor total a pagar.</td>
</tr>
<tr>
<td>payer</td>
<td><a href="#persona">Person</a></td>
<td>Información del pagador.</td>
</tr>
<tr>
<td>buyer</td>
<td><a href="#persona">Person</a></td>
<td>Información del comprador.</td>
</tr>
<tr>
<td>shipping</td>
<td><a href="#persona">Person</a></td>
<td>Información del receptor.</td>
</tr>
<tr>
<td>ipAddress</td>
<td>string[15]</td>
<td>Dirección IP desde la cual realiza la transacción el pagador.</td>
</tr>
<tr>
<td>userAgent</td>
<td>string[255]</td>
<td>Agente de navegación utilizado por el pagador.</td>
</tr>
<tr>
<td>additionalData</td>
<td><a href="#attribute">Attribute[]</a></td>
<td>Datos adicionales para ser almacenados con la transacción.</td>
</tr>
</tbody></table>
<h4 id='psetransactionmulticreditrequest'>PSETransactionMultiCreditRequest</h4>
<p>Estructura que representa una solicitud de transacción con débitos a cuenta PSE.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>bankCode</td>
<td>string[4]</td>
<td>Código de la entidad financiera con la cual realizar la transacción.</td>
</tr>
<tr>
<td>bankInterface</td>
<td>string[1]</td>
<td>Tipo de interfaz del banco a desplegar <code>[0 = PERSONAS, 1 = EMPRESAS]</code></td>
</tr>
<tr>
<td>returnURL</td>
<td>string[255]</td>
<td>URL de retorno especificada para la entidad financiera.</td>
</tr>
<tr>
<td>reference</td>
<td>string[32]</td>
<td>Referencia única de pago.</td>
</tr>
<tr>
<td>description</td>
<td>string[255]</td>
<td>Descripción del pago.</td>
</tr>
<tr>
<td>language</td>
<td>string[2]</td>
<td>Idioma esperado para las transacciones acorde a <a href="https://es.wikipedia.org/wiki/ISO_639-1">ISO 631-1</a>, mayúscula sostenida.</td>
</tr>
<tr>
<td>currency</td>
<td>string[3]</td>
<td>Moneda a usar para el recaudo acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a>.</td>
</tr>
<tr>
<td>totalAmount</td>
<td>double</td>
<td>Valor total a recaudar.</td>
</tr>
<tr>
<td>taxAmount</td>
<td>double</td>
<td>Discriminación del impuesto aplicado.</td>
</tr>
<tr>
<td>devolutionBase</td>
<td>double</td>
<td>Base de devolución para el impuesto.</td>
</tr>
<tr>
<td>tipAmount</td>
<td>double</td>
<td>Propina u otros valores exentos de impuesto (tasa aeroportuaria) y que deben agregarse al valor total a pagar.</td>
</tr>
<tr>
<td>payer</td>
<td><a href="#persona">Person</a></td>
<td>Información del pagador.</td>
</tr>
<tr>
<td>buyer</td>
<td><a href="#persona">Person</a></td>
<td>Información del comprador.</td>
</tr>
<tr>
<td>shipping</td>
<td><a href="#persona">Person</a></td>
<td>Información del receptor.</td>
</tr>
<tr>
<td>ipAddress</td>
<td>string[15]</td>
<td>Dirección IP desde la cual realiza la transacción el pagador.</td>
</tr>
<tr>
<td>userAgent</td>
<td>string[255]</td>
<td>Agente de navegación utilizado por el pagador.</td>
</tr>
<tr>
<td>additionalData</td>
<td><a href="#attribute">Attribute[]</a></td>
<td>Datos adicionales para ser almacenados con la transacción.</td>
</tr>
<tr>
<td>credits</td>
<td><a href="creditconcept">CreditConcept</a></td>
<td>Detalle de la dispersión a realizar.</td>
</tr>
</tbody></table>
<h4 id='psetransactionresponse'>PSETransactionResponse</h4>
<p>Estructura con la información de respuesta para la creación de una transacción.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>transactionID</td>
<td>int</td>
<td>Identificador único de la transacción en Placetopay.</td>
</tr>
<tr>
<td>sessionID</td>
<td>string[32]</td>
<td>Identificador único de la sesión en Placetopay.</td>
</tr>
<tr>
<td>returnCode</td>
<td>string[30]</td>
<td>Código de respuesta de la transacción, uno de los siguientes valores:</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SUCCESS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_ENTITYNOTEXISTSORDISABLED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_BANKNOTEXISTSORDISABLED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_SERVICENOTEXISTS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDAMOUNT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDSOLICITDATE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_BANKUNREACHEABLE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_NOTCONFIRMEDBYBANK</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_CANNOTGETCURRENTCYCLE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_ACCESSDENIED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TIMEOUT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_DESCRIPTIONNOTFOUND</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_EXCEEDEDLIMIT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TRANSACTIONNOTALLOWED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_RISK</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_NOHOST</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_NOTALLOWEDBYTIME</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_ERRORINCREDITS</td>
</tr>
<tr>
<td>trazabilityCode</td>
<td>string[40]</td>
<td>Código único de seguimiento para la operación dado por la red ACH</td>
</tr>
<tr>
<td>transactionCycle</td>
<td>int</td>
<td>Ciclo de compensación de la red</td>
</tr>
<tr>
<td>bankCurrency</td>
<td>string[3]</td>
<td>Moneda aceptada por el banco acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a>.</td>
</tr>
<tr>
<td>bankFactor</td>
<td>float</td>
<td>Factor de conversión de la moneda.</td>
</tr>
<tr>
<td>bankURL</td>
<td>string[255]</td>
<td>URL a la cual remitir la solicitud para iniciar la interfaz del banco, sólo disponible cuando <code>returnCode = SUCCESS</code>.</td>
</tr>
<tr>
<td>responseCode</td>
<td>int</td>
<td>Estado de la operación en Placetopay  <code>0 = FAILED, 1 = APPROVED,</code> <code>2 = DECLINED, 3 = PENDING</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>responseReasonCode</td>
<td>string[3]</td>
<td>Código interno de respuesta de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonText</td>
<td>string[255]</td>
<td>Mensaje asociado con el código de respuesta de la operación en Placetopay.</td>
</tr>
</tbody></table>
<h4 id='transactioninformation'>TransactionInformation</h4>
<p>Estructura con la respuesta a una solicitud de información de transacción.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>transactionID</td>
<td>int</td>
<td>Identificador único de la transacción en Placetopay.</td>
</tr>
<tr>
<td>sessionID</td>
<td>string[32]</td>
<td>Identificador único de la sesión en Placetopay.</td>
</tr>
<tr>
<td>reference</td>
<td>string[32]</td>
<td>Referencia única de pago.</td>
</tr>
<tr>
<td>requestDate</td>
<td>string</td>
<td>Fecha de solicitud o creación de la transacción acorde a ISO 8601(https://www.iso.org/iso-8601-date-and-time-format.html).</td>
</tr>
<tr>
<td>bankProcessDate</td>
<td>string</td>
<td>Fecha de procesamiento de la transacción acorde a ISO 8601(https://www.iso.org/iso-8601-date-and-time-format.html).</td>
</tr>
<tr>
<td>onTest</td>
<td>boolean</td>
<td>Indicador de si la transacción esta o no en modo de pruebas.</td>
</tr>
<tr>
<td>returnCode</td>
<td>string[30]</td>
<td>Código de respuesta de la transacción, uno de los siguientes:</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SUCCESS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDTRAZABILITYCODE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_ACCESSDENIED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDSTATE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDBANKPROCESSINGDATE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDAUTHORIZEDAMOUNT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INCONSISTENTDATA</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TIMEOUT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDVATVALUE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDTICKETID</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDSOLICITEDATE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDAUTHORIZATIONID</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TRANSACTIONNOTALLOWED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_ERRORINCREDITS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_EXCEEDEDLIMIT</td>
</tr>
<tr>
<td>trazabilityCode</td>
<td>string[40]</td>
<td>Código único de seguimiento para la operación dado por la red ACH.</td>
</tr>
<tr>
<td>transactionCycle</td>
<td>int</td>
<td>Ciclo de compensación de la red.</td>
</tr>
<tr>
<td>transactionState</td>
<td>string[20]</td>
<td>Información del estado de la transacción <code>OK, NOT_AUTHORIZED,</code> <code> PENDING, FAILED</code>.</td>
</tr>
<tr>
<td>responseCode</td>
<td>int</td>
<td>Estado de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonCode</td>
<td>string[3]</td>
<td>Código interno de respuesta de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonText</td>
<td>string[255]</td>
<td>Mensaje asociado con el código de respuesta de la operación en Placetopay.</td>
</tr>
</tbody></table>
<h2 id='webservice-tuya'>Webservice Tuya</h2>
<p>A continuación se describe el flujo, metodos e interfaces básicas con las cuales debe contar su desarrollo para poder lograr exitosamente la revisión del proceso.</p>
<h3 id='flujo-de-integracion-tuya'>Flujo de integración Tuya</h3>
<blockquote>
<p>Ejemplo para integrar un pago con tarjeta TUYA O EXITO:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
     <span class="k">class</span> <span class="nc">Pagos</span>
       <span class="p">{</span>
       <span class="k">public</span> <span class="k">function</span> <span class="nf">RealizarPago</span><span class="p">()</span>
       <span class="p">{</span>
              <span class="nv">$seed</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'c'</span><span class="p">);</span>
              <span class="nv">$secretKey</span> <span class="o">=</span> <span class="s1">'024h1IlD'</span><span class="p">;</span>
              <span class="nv">$trankey</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$seed</span><span class="o">.</span><span class="nv">$secretKey</span><span class="p">);</span>

              <span class="nv">$servicio</span> <span class="o">=</span> <span class="s1">'https://test.placetopay.com/soap/tuya/v11/?wsdl'</span><span class="p">;</span> <span class="c1">//url del servicio
</span>
              <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
              <span class="s1">'login'</span> <span class="o">=&gt;</span> <span class="s1">'6dd490faf9cb87a9862245da41170ff2'</span><span class="p">,</span>
              <span class="s1">'tranKey'</span> <span class="o">=&gt;</span> <span class="nv">$trankey</span><span class="p">,</span>
              <span class="s1">'seed'</span> <span class="o">=&gt;</span> <span class="nv">$seed</span><span class="p">,</span>
              <span class="p">);</span>
               <span class="nv">$payer</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'documentType'</span> <span class="o">=&gt;</span> <span class="s1">'CC'</span><span class="p">,</span>
                    <span class="s1">'document'</span> <span class="o">=&gt;</span> <span class="s1">'1037390240'</span><span class="p">,</span>
                    <span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="s1">'Juan'</span><span class="p">,</span>
                    <span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="s1">'Chavarria'</span><span class="p">,</span>
                    <span class="s1">'emailAddress'</span> <span class="o">=&gt;</span> <span class="s1">'soporte9@placetopay.com'</span><span class="p">,</span>
                    <span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="s1">'Bello'</span><span class="p">,</span>
                    <span class="s1">'province'</span> <span class="o">=&gt;</span> <span class="s1">'Colombia'</span><span class="p">,</span>
                    <span class="s1">'country'</span> <span class="o">=&gt;</span> <span class="s1">'Antioquia'</span><span class="p">,</span>
                    <span class="s1">'mobile'</span> <span class="o">=&gt;</span> <span class="s1">'3104317467'</span><span class="p">,</span>
                <span class="p">);</span>

                <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'franchise'</span> <span class="o">=&gt;</span> <span class="nv">$tarjetaTuya</span><span class="p">,</span> <span class="c1">//TY_AK,TY_EX
</span>                    <span class="s1">'returnURL'</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/API_AIM/Controlador/Respuesta.php'</span><span class="p">,</span>
                    <span class="s1">'reference'</span> <span class="o">=&gt;</span> <span class="s1">'123'</span><span class="p">,</span>
                    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'prueba venta'</span><span class="p">,</span>
                    <span class="s1">'language'</span> <span class="o">=&gt;</span> <span class="s1">'ES'</span><span class="p">,</span>
                    <span class="s1">'currency'</span> <span class="o">=&gt;</span> <span class="s1">'COP'</span><span class="p">,</span>
                    <span class="s1">'totalAmount'</span> <span class="o">=&gt;</span> <span class="mi">1000</span><span class="p">,</span>
                    <span class="s1">'taxAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'devolutionBase'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'tipAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s1">'payer'</span> <span class="o">=&gt;</span> <span class="nv">$payer</span><span class="p">,</span>
                    <span class="s1">'buyer'</span> <span class="o">=&gt;</span> <span class="nv">$payer</span><span class="p">,</span>
                    <span class="s1">'ipAddress'</span> <span class="o">=&gt;</span> <span class="s1">'192.168.1.12'</span><span class="p">,</span>
                  <span class="p">);</span>
                 <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
                    <span class="s1">'transaction'</span> <span class="o">=&gt;</span> <span class="nv">$transaction</span><span class="p">,</span>
                     <span class="p">);</span>
              <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span>
             <span class="c1">// SE CREA TRANSACCION PARA PAGO POR TARJETAS TUYA
</span>             <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'createTransaction'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>
             <span class="k">echo</span> <span class="s1">'&lt;div class="container"&gt;
              &lt;div class="card m-t-25 "&gt;
                  &lt;div class="card-body"&gt;
                    &lt;br&gt;
                        &lt;strong&gt;ESTADO: &lt;/strong&gt;'</span><span class="o">.</span><span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'returnCode'</span><span class="p">]</span><span class="o">.</span><span class="s1">'
                          &lt;br&gt;
                          &lt;strong&gt;RAZON: &lt;/strong&gt;'</span><span class="o">.</span><span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'responseReasonText'</span><span class="p">]</span><span class="o">.</span><span class="s1">'
                          &lt;br&gt;
                          &lt;strong&gt;BANCO: &lt;/strong&gt;'</span><span class="o">.</span><span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'bankName'</span><span class="p">]</span><span class="o">.</span><span class="s1">'
                          &lt;br&gt;
                          &lt;strong&gt;ID TRANSACCION: &lt;/strong&gt;'</span><span class="o">.</span><span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'transactionID'</span><span class="p">]</span><span class="o">.</span><span class="s1">'
                          &lt;br&gt;
                          &lt;strong&gt;URL DEL BANCO: &lt;/strong&gt;'</span><span class="o">.</span><span class="nv">$resp</span><span class="p">[</span><span class="s1">'createTransactionResult'</span><span class="p">][</span><span class="s1">'bankURL'</span><span class="p">]</span><span class="o">.</span><span class="s1">'
                  &lt;div/&gt;
              &lt;div/&gt;
          &lt;div/&gt;'</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<p><em>¿Cómo funciona la implementación?</em></p>

<ol>
<li>Se muestra como opción de pago Tarjeta Éxito y Tarjeta Alkosto (dependerá de si se tiene convenio para cada uno de los medios de pago).</li>
<li>Una vez el usuario la selecciona el medio de pago y confirma la operación, debe consumirse el servicio para realizar la petición de la transacción.</li>
<li>Si la petición es exitosa se retorna la URL a la cual debe enviarse al cliente para que realice la operación en en medio de pago. En caso contrario se retorna el motivo del rechazo de la transacción.</li>
<li>Almacenar los datos de la transacción retornados por el servicio (identificador de la transacción, autorización, identificador sesión de placetopay).</li>
<li>Redirigir el navegador a la URL retornada en caso de éxito.</li>
<li>Una vez la transacción retorna (retorna a la URL especificada en el consumo del crear transacción), se debe preguntar por el estado de la transacción mediante el consumo un servicio.</li>
<li>Dependiendo de la respuesta del servicio, la transacción puede haber sido aprobada, rechazada o seguir pendiente de procesamiento.</li>
<li>Informar al usuario el estado de la transacción.</li>
<li>Si la transacción está pendiente, o si el cliente al abandonar el portal no ha regresado, se debe tener una sonda que pregunte por el estado de la transacción.</li>
</ol>
<h4 id='confirmacion-y-redireccion-a-banco'>Confirmación y redirección a banco</h4>
<p>Una vez ya se tengan los datos del pagador y comprador, así como la información de qué medio de pago usará, deberá entonces consumir el servicio de <a href="#createtransaction">createTransaction</a> para obtener la URL a la cual deberá redirigir al cliente para finalizar la transacción.</p>

<p>Debe tener en cuenta que en los datos solicitados para crear la transacción se requiere la dirección IP desde la cual el cliente estará realizando la transacción, así como la información del agente de navegación usado. Si lo desea, también puede proveer datos adicionales con la transacción, los cuales le permitirán tener esta información disponible en la consola de consulta de transacciones de Placetopay. Tenga en cuenta que el documento del pagador es el documento del dueño de la tarjeta y que no podrá ser modificado posteriormente en la interfaz de <em>TUYA</em> para ese medio de pago.</p>

<p>Si la respuesta del servicio es <code>SUCCESS</code>, entonces deberá almacenar la información retornada en su base de datos, de vital importancia el <code>transactionID</code> pues es con este identificador que podrá consultar el estado final de la transacción.</p>

<p>Tenga en cuenta que una respuesta <code>SUCCESS</code> en este punto sólo implica que la transacción ha sido aprovisionada por <em>TUYA</em> y está en espera que el cliente llegue a la interfaz del medio de pago, se autentique y autorice la operación iniciada.</p>

<p>Al crear la transacción, esta puede fallar; algunos motivos incluyen montos por fuera del rango permitido, no disponibilidad del medio de pago, problemas de configuración de la cuenta recaudadora, entre otros. Utilice el parametro <code>responseReasonText</code> para obtener el mensaje de por qué falló la creación de la transacción. Algunos códigos no relacionados con el pagador pueden indicarle que genere una alerta sobre problemas con la disponibilidad del servicio, particularmente los relacionados con mala configuración.</p>

<p>Una vez ha almacenado la información en su base de datos y ha confirmado que es exitosa la petición, se redirigirá al cliente a la URL del medio de pago. Tenga en cuenta que la redirección a la interfaz del medio de pago no debe realizarse en un frame o cualquier otro mecanismo que oculte la URL en la cual el cliente ingresará sus datos de autenticación.</p>
<h4 id='reingreso-cliente'>Reingreso cliente</h4>
<p>Una vez el cliente ha finalizado la transacción en la interfaz del banco, el banco redirige al cliente a la URL especificada al crear la transacción, en este punto de entrada a su aplicativo, usted deberá consumir el servicio <a href="#gettransactioninformation">getTransactionInformation</a> que le permite determinar el estado de la transacción. Solo si la transacción tiene como estado <code>OK</code> es porque la transacción fue autorizada, si por el contrario obtiene un estado <code>PENDING</code> es porque aún no tiene respuesta final del banco acerca de la transacción.</p>

<p>Ya sea que el cliente retorne al punto de reingreso y que la transacción esté pendiente, o que haya abandonado la operación y haya roto el flujo normal, se deberá consumir el servicio <a href="#gettransactioninformation">getTransactionInformation</a> para todas las operaciones que desde que fue invocado el <a href="#createtransaction">createTransaction</a> llevan más de 7 minutos sin un estado final de operación.</p>
<h3 id='metodos-de-interfaz-tuya'>Métodos de interfaz Tuya</h3>
<p>Los métodos son las operaciones expuestas por el webservice de tipo petición respuesta, donde se muestran los parámetros de entrada y vinculos a las estructuras de datos usadas.</p>
<h4 id='createtransaction'>createTransaction</h4>
<blockquote>
<p>Ejemplo para utilizar el metodo createTransaction:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
      <span class="o">...</span>  
        <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
              <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="nv">$auth</span><span class="p">,</span>
              <span class="s1">'transaction'</span> <span class="o">=&gt;</span> <span class="nv">$transaction</span><span class="p">,</span>
          <span class="p">);</span>
        <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nusoap_client</span><span class="p">(</span><span class="nv">$servicio</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'trace'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">));</span>
       <span class="c1">// SE CREA TRANSACCION PARA PAGO POR TARJETAS TUYA
</span>        <span class="nv">$resp</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'createTransaction'</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">);</span>
       <span class="o">...</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Solicita la creación de una transacción.  En los datos de la solicitud se especifica quien es el pagador, el comprador y el despacho. Así mismo para cuál de los medios de pago habilitados se hace la petición y a que URL de retorno debe el medio de pago redirigir al tarjeta habiente.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación</td>
</tr>
<tr>
<td>transaction</td>
<td><a href="#tuyatransactionrequest">TuyaTransactionRequest</a></td>
<td>Datos de la solicitud</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#tuyatransactionresponse">TuyaTransactionResponse</a></strong>. Respuesta de la creación de la transacción, tenga en cuenta que la URL del medio de pago se entrega solo si la propiedad <code>returnCode</code> es <code>SUCCESS</code>.</p>
<h4 id='gettransactioninformation'>getTransactionInformation</h4>
<p>Obtiene la información de una transacción, debe ser consultado para cualquier operación previamente creada con el método createTransaction ya sea cuando regresa del medio de pago o cuando al menos han transcurrido 7 minutos desde que el cliente fue redirigido a la interfaz del medio de pago. Deberá consumirse en intervalos de al menos cada 12 minutos hasta que tenga un estado de transacción <code>transactionState</code> diferente a <code>PENDING</code>.</p>

<p>PARÁMETROS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>auth</td>
<td><a href="#authentication">Authentication</a></td>
<td>Datos de autenticación</td>
</tr>
<tr>
<td>transactionID</td>
<td>int</td>
<td>Identificador único de la transacción en Placetopay, equivale al retornado en la creación de la transacción.</td>
</tr>
</tbody></table>

<p><strong>Retorna</strong> <br>
<strong><a href="#transactioninformation">TransactionInformation</a></strong>. Información del estado de la transacción.</p>
<h3 id='estructuras-de-datos-tuya'>Estructuras de datos Tuya</h3>
<p>Cada una de las estructuras de datos usadas por los métodos del Webservice se describen a continuación.</p>
<h4 id='attribute'>Attribute</h4>
<p>Estructura para almacenar información extendida.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string[30]</td>
<td>Código para referenciar el atributo</td>
</tr>
<tr>
<td>value</td>
<td>string[128]</td>
<td>Valor que asume el atributo</td>
</tr>
</tbody></table>
<h4 id='persona'>Persona</h4>
<blockquote>
<p>Ejemplo de generación de una estructura Person dentro de la integración de pago con tarjeta TUYA:</p>
</blockquote>
<pre class="highlight php tab-php"><code>  <span class="cp">&lt;?php</span>
       <span class="nv">$payer</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">'documentType'</span> <span class="o">=&gt;</span> <span class="s1">'CC'</span><span class="p">,</span>
                    <span class="s1">'document'</span> <span class="o">=&gt;</span> <span class="s1">'1037390240'</span><span class="p">,</span>
                    <span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="s1">'Juan'</span><span class="p">,</span>
                    <span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="s1">'Chavarria'</span><span class="p">,</span>
                    <span class="s1">'emailAddress'</span> <span class="o">=&gt;</span> <span class="s1">'soporte9@placetopay.com'</span><span class="p">,</span>
                    <span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="s1">'Bello'</span><span class="p">,</span>
                    <span class="s1">'province'</span> <span class="o">=&gt;</span> <span class="s1">'Colombia'</span><span class="p">,</span>
                    <span class="s1">'country'</span> <span class="o">=&gt;</span> <span class="s1">'Antioquia'</span><span class="p">,</span>
                    <span class="s1">'mobile'</span> <span class="o">=&gt;</span> <span class="s1">'3104317467'</span><span class="p">,</span>
                <span class="p">);</span>
  <span class="cp">?&gt;</span>
</code></pre>
<p>Estructura para reflejar la información de una persona involucrada en una transacción.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>string[12]</td>
<td>Número de identificación de la persona.</td>
</tr>
<tr>
<td>documentType</td>
<td>string[3]</td>
<td>Tipo de documento de identificación de la persona.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>CC = Cédula de ciudadanía colombiana</td>
</tr>
<tr>
<td></td>
<td></td>
<td>CE = Cédula de extranjería</td>
</tr>
<tr>
<td></td>
<td></td>
<td>TI = Tarjeta de identidad</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PPN = Pasaporte</td>
</tr>
<tr>
<td></td>
<td></td>
<td>NIT = Número de identificación tributaria</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SSN = Social Security Number</td>
</tr>
<tr>
<td>firstName</td>
<td>string[60]</td>
<td>Nombres</td>
</tr>
<tr>
<td>lastName</td>
<td>string[60]</td>
<td>Apellidos</td>
</tr>
<tr>
<td>company</td>
<td>string[60]</td>
<td>Nombre de la compañía en la cual labora o representa.</td>
</tr>
<tr>
<td>emailAddress</td>
<td>string[80]</td>
<td>Correo electrónico.</td>
</tr>
<tr>
<td>address</td>
<td>string[100]</td>
<td>Dirección postal completa.</td>
</tr>
<tr>
<td>city</td>
<td>string[50]</td>
<td>Nombre de la ciudad coincidente con la dirección.</td>
</tr>
<tr>
<td>province</td>
<td>string[50]</td>
<td>Nombre de la provincia o departamento coincidente con la dirección.</td>
</tr>
<tr>
<td>country</td>
<td>string[2]</td>
<td>Código internacional del país que aplica a la dirección física acorde a <a href="https://es.wikipedia.org/wiki/ISO_3166-1">ISO 3166-1</a>, mayúscula sostenida.</td>
</tr>
<tr>
<td>phone</td>
<td>string[30]</td>
<td>Número de telefonía fija.</td>
</tr>
<tr>
<td>mobile</td>
<td>string[30]</td>
<td>Número de telefonía móvil o celular.</td>
</tr>
</tbody></table>
<h4 id='tuyatransactionrequest'>TuyaTransactionRequest</h4>
<blockquote>
<p>Ejemplo de  una estructura TuyaTransactionRequest:</p>
</blockquote>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
  <span class="o">...</span>
      <span class="nv">$transaction</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'franchise'</span> <span class="o">=&gt;</span> <span class="nv">$tarjetaTuya</span><span class="p">,</span> <span class="c1">//TY_AK,TY_EX
</span>        <span class="s1">'returnURL'</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/API_AIM/Controlador/Respuesta.php'</span><span class="p">,</span>
        <span class="s1">'reference'</span> <span class="o">=&gt;</span> <span class="s1">'123'</span><span class="p">,</span>
        <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'prueba venta'</span><span class="p">,</span>
        <span class="s1">'language'</span> <span class="o">=&gt;</span> <span class="s1">'ES'</span><span class="p">,</span>
        <span class="s1">'currency'</span> <span class="o">=&gt;</span> <span class="s1">'COP'</span><span class="p">,</span>
        <span class="s1">'totalAmount'</span> <span class="o">=&gt;</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">'taxAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">'devolutionBase'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">'tipAmount'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">'payer'</span> <span class="o">=&gt;</span> <span class="nv">$payer</span><span class="p">,</span>
        <span class="s1">'buyer'</span> <span class="o">=&gt;</span> <span class="nv">$payer</span><span class="p">,</span>
        <span class="s1">'ipAddress'</span> <span class="o">=&gt;</span> <span class="s1">'192.168.1.12'</span><span class="p">,</span>
      <span class="p">);</span>
  <span class="o">...</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Estructura que representa una solicitud de transacción con tarjetas expedidas por TUYA.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>franchise</td>
<td>string[4]</td>
<td>Código del medio de pago <Code>TY_EX = Tarjeta Éxito, TY_AK = Tarjeta Alkosto</code></td>
</tr>
<tr>
<td>returnURL</td>
<td>string[255]</td>
<td>URL de retorno especificada para la entidad financiera.</td>
</tr>
<tr>
<td>reference</td>
<td>string[32]</td>
<td>Referencia única de pago.</td>
</tr>
<tr>
<td>description</td>
<td>string[255]</td>
<td>Descripción del pago.</td>
</tr>
<tr>
<td>language</td>
<td>string[2]</td>
<td>Idioma esperado para las transacciones acorde a <a href="https://es.wikipedia.org/wiki/ISO_639-1">ISO 631-1</a>, mayúscula sostenida.</td>
</tr>
<tr>
<td>currency</td>
<td>string[3]</td>
<td>Moneda a usar para el recaudo acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a>.</td>
</tr>
<tr>
<td>totalAmount</td>
<td>double</td>
<td>Valor total a recaudar.</td>
</tr>
<tr>
<td>taxAmount</td>
<td>double</td>
<td>Discriminación del impuesto aplicado.</td>
</tr>
<tr>
<td>devolutionBase</td>
<td>double</td>
<td>Base de devolución para el impuesto.</td>
</tr>
<tr>
<td>tipAmount</td>
<td>double</td>
<td>Propina u otros valores exentos de impuesto (tasa aeroportuaria) y que deben agregarse al valor total a pagar.</td>
</tr>
<tr>
<td>payer</td>
<td><a href="#persona">Person</a></td>
<td>Información del pagador.</td>
</tr>
<tr>
<td>buyer</td>
<td><a href="#persona">Person</a></td>
<td>Información del comprador.</td>
</tr>
<tr>
<td>shipping</td>
<td><a href="#persona">Person</a></td>
<td>Información del receptor.</td>
</tr>
<tr>
<td>ipAddress</td>
<td>string[15]</td>
<td>Dirección IP desde la cual realiza la transacción el pagador.</td>
</tr>
<tr>
<td>userAgent</td>
<td>string[255]</td>
<td>Agente de navegación utilizado por el pagador.</td>
</tr>
<tr>
<td>additionalData</td>
<td><a href="#attribute">Attribute[]</a></td>
<td>Datos adicionales para ser almacenados con la transacción.</td>
</tr>
</tbody></table>
<h4 id='tuyatransactionresponse'>TuyaTransactionResponse</h4>
<p>Estructura con la información de respuesta para la creación de una transacción.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>transactionID</td>
<td>int</td>
<td>Identificador único de la transacción en Placetopay.</td>
</tr>
<tr>
<td>sessionID</td>
<td>string[32]</td>
<td>Identificador único de la sesión en Placetopay.</td>
</tr>
<tr>
<td>returnCode</td>
<td>string[30]</td>
<td>Código de respuesta de la transacción, uno de los siguientes valores:</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SUCCESS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDGATEWAYID</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDFRANCHISE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDRETAILCODE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDCURRENCY</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDAMOUNT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TIMEOUT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TRANSACTIONNOTALLOWED</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_RISK</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_NOHOST</td>
</tr>
<tr>
<td>trazabilityCode</td>
<td>string[64]</td>
<td>Código único de seguimiento para la operación dado por la red TUYA</td>
</tr>
<tr>
<td>bankCurrency</td>
<td>string[3]</td>
<td>Moneda aceptada por el banco acorde a <a href="https://es.wikipedia.org/wiki/ISO_4217">ISO 4217</a>.</td>
</tr>
<tr>
<td>bankFactor</td>
<td>float</td>
<td>Factor de conversión de la moneda.</td>
</tr>
<tr>
<td>bankURL</td>
<td>string[255]</td>
<td>URL a la cual remitir la solicitud para iniciar la interfaz del banco, sólo disponible cuando <code>returnCode = SUCCESS</code>.</td>
</tr>
<tr>
<td>responseCode</td>
<td>int</td>
<td>Estado de la operación en Placetopay  <code>0 = FAILED, 1 = APPROVED,</code> <code>2 = DECLINED, 3 = PENDING</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>responseReasonCode</td>
<td>string[3]</td>
<td>Código interno de respuesta de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonText</td>
<td>string[255]</td>
<td>Mensaje asociado con el código de respuesta de la operación en Placetopay.</td>
</tr>
</tbody></table>
<h4 id='transactioninformation'>TransactionInformation</h4>
<p>Estructura con la respuesta a una solicitud de información de transacción.</p>

<p>ATRIBUTOS</p>

<table><thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead><tbody>
<tr>
<td>transactionID</td>
<td>int</td>
<td>Identificador único de la transacción en Placetopay.</td>
</tr>
<tr>
<td>sessionID</td>
<td>string[32]</td>
<td>Identificador único de la sesión en Placetopay.</td>
</tr>
<tr>
<td>reference</td>
<td>string[32]</td>
<td>Referencia única de pago.</td>
</tr>
<tr>
<td>requestDate</td>
<td>string</td>
<td>Fecha de solicitud o creación de la transacción acorde a ISO 8601(https://www.iso.org/iso-8601-date-and-time-format.html).</td>
</tr>
<tr>
<td>franchise</td>
<td>string[5]</td>
<td>Franquicia con la cual se procesó la transacción.</td>
</tr>
<tr>
<td>bankName</td>
<td>string[80]</td>
<td>Nombre del banco o entidad financiera.</td>
</tr>
<tr>
<td>bankProcessDate</td>
<td>string</td>
<td>Fecha de procesamiento de la transacción acorde a ISO 8601(https://www.iso.org/iso-8601-date-and-time-format.html).</td>
</tr>
<tr>
<td>onTest</td>
<td>boolean</td>
<td>Indicador de si la transacción esta o no en modo de pruebas.</td>
</tr>
<tr>
<td>returnCode</td>
<td>string[30]</td>
<td>Código de respuesta de la transacción, uno de los siguientes:</td>
</tr>
<tr>
<td></td>
<td></td>
<td>SUCCESS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDGATEWAYID</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDFRANCHISE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDRETAILCODE</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDCURRENCY</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_INVALIDAMOUNT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TIMEOUT</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FAIL_TRANSACTIONNOTALLOWED</td>
</tr>
<tr>
<td>authCode</td>
<td>string[40]</td>
<td>Código de autorización asignado a la transacción.</td>
</tr>
<tr>
<td>trazabilityCode</td>
<td>string[64]</td>
<td>Código único de seguimiento para la operación dado por la red TUYA.</td>
</tr>
<tr>
<td>lastDigits</td>
<td>string[6]</td>
<td>Últimos dígitos de la tarjeta de crédito usada</td>
</tr>
<tr>
<td>transactionState</td>
<td>string[20]</td>
<td>Información del estado de la transacción <code>OK, NOT_AUTHORIZED,</code> <code> PENDING, FAILED</code>.</td>
</tr>
<tr>
<td>responseCode</td>
<td>int</td>
<td>Estado de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonCode</td>
<td>string[3]</td>
<td>Código interno de respuesta de la operación en Placetopay.</td>
</tr>
<tr>
<td>responseReasonText</td>
<td>string[255]</td>
<td>Mensaje asociado con el código de respuesta de la operación en Placetopay.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="csharp">csharp</a>
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
